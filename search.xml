<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>å·¥ä½œæµæ¥å£æœåŠ¡</title>
      <link href="/platform.github.io/2022/09/19/%E7%AC%AC%E4%B8%89%E6%96%B9%E6%8E%A5%E5%85%A5%E5%B7%A5%E4%BD%9C%E6%B5%81/"/>
      <url>/platform.github.io/2022/09/19/%E7%AC%AC%E4%B8%89%E6%96%B9%E6%8E%A5%E5%85%A5%E5%B7%A5%E4%BD%9C%E6%B5%81/</url>
      
        <content type="html"><![CDATA[<h2 id="1-å¯åŠ¨"><a href="#1-å¯åŠ¨" class="headerlink" title="1. å¯åŠ¨"></a>1. å¯åŠ¨</h2><p>POST: &#x2F;runtime&#x2F;instance&#x2F;v1&#x2F;easywebWorkflowStart</p><p>è¯·æ±‚å¤´å‚æ•°ï¼š</p><table><thead><tr><th align="left">å‚æ•°å</th><th align="left">è¯´æ˜</th><th align="left">å€¼</th></tr></thead><tbody><tr><td align="left">Authorization</td><td align="left">ç”¨æˆ·è®¤è¯ä¿¡æ¯</td><td align="left">Bearer ç”¨æˆ·è®¤è¯ä¿¡æ¯</td></tr><tr><td align="left">Content-Type</td><td align="left">ç±»å‹</td><td align="left">application&#x2F;json</td></tr></tbody></table><p>æœ€è¯·æ±‚å‚æ•°ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>         <span class="token property">"formType"</span><span class="token operator">:</span><span class="token string">"frame"</span><span class="token punctuation">,</span> <span class="token comment">//è¡¨å•ç±»å‹</span>         <span class="token property">"businessKey"</span><span class="token operator">:</span><span class="token string">"17231238972"</span><span class="token punctuation">,</span> <span class="token comment">//ä¸šåŠ¡ä¸»é”®</span>         <span class="token property">"flowKey"</span><span class="token operator">:</span><span class="token string">"cs1"</span><span class="token punctuation">,</span> <span class="token comment">//æµç¨‹key</span>         <span class="token property">"account"</span><span class="token operator">:</span><span class="token string">"admin"</span><span class="token punctuation">,</span> <span class="token comment">//è´¦å·ç™»é™†å</span>         <span class="token property">"sysCode"</span><span class="token operator">:</span><span class="token string">"123456"</span> <span class="token comment">//é¢å¤–å‚æ•°ï¼Œç”¨äºåŒºåˆ†ä¸åŒçš„æµç¨‹æˆ–è€…ç³»ç»Ÿ</span>         <span class="token property">"vars"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>     <span class="token comment">//è®¾ç½®æµç¨‹å˜é‡</span>          <span class="token property">"additionalProp1"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>          <span class="token property">"additionalProp2"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>          <span class="token property">"additionalProp3"</span><span class="token operator">:</span> <span class="token string">"string"</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2-åŠç†"><a href="#2-åŠç†" class="headerlink" title="2. åŠç†"></a>2. åŠç†</h2><p>POST: &#x2F;runtime&#x2F;task&#x2F;v1&#x2F;easywebWorkflowComplete</p><p>è¯·æ±‚å¤´å‚æ•°ï¼š</p><table><thead><tr><th align="left">å‚æ•°å</th><th align="left">è¯´æ˜</th><th align="left">å€¼</th></tr></thead><tbody><tr><td align="left">Authorization</td><td align="left">ç”¨æˆ·è®¤è¯ä¿¡æ¯</td><td align="left">Bearer ç”¨æˆ·è®¤è¯ä¿¡æ¯</td></tr><tr><td align="left">Content-Type</td><td align="left">ç±»å‹</td><td align="left">application&#x2F;json</td></tr></tbody></table><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>  <span class="token property">"account"</span><span class="token operator">:</span> <span class="token string">"admin"</span><span class="token punctuation">,</span>  <span class="token property">"actionName"</span><span class="token operator">:</span> <span class="token string">"agree"</span><span class="token punctuation">,</span><span class="token comment">//æµç¨‹æ“ä½œagreeï¼ˆå®¡æ‰¹ï¼‰abandonï¼ˆå¼ƒæƒï¼‰opposeï¼ˆåå¯¹ï¼‰agreeTransï¼ˆåŒæ„æµè½¬ï¼‰opposeTransï¼ˆåå¯¹æµè½¬ï¼‰commuï¼ˆæ²Ÿé€šåé¦ˆï¼‰rejectï¼ˆé©³å›ï¼‰backToStartï¼ˆé©³å›æŒ‡å®šèŠ‚ç‚¹ï¼‰</span>  <span class="token property">"agreeType"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>  <span class="token property">"backHandMode"</span><span class="token operator">:</span> <span class="token string">"direct"</span><span class="token punctuation">,</span>  <span class="token property">"data"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>  <span class="token property">"destination"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>  <span class="token property">"directHandlerSign"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token property">"files"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>  <span class="token property">"formType"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span> <span class="token comment">//è¡¨å•ç±»å‹</span>  <span class="token property">"instId"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span><span class="token comment">//æµç¨‹å®ä¾‹id</span>  <span class="token property">"interPoseOpinion"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>  <span class="token property">"jumpType"</span><span class="token operator">:</span> <span class="token string">"free"</span><span class="token punctuation">,</span>  <span class="token property">"nodeUsers"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>  <span class="token property">"notifyType"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>  <span class="token property">"opinion"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span> <span class="token comment">//æµç¨‹æ„è§</span>  <span class="token property">"rejectType"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>  <span class="token property">"statusName"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>  <span class="token property">"taskId"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span> <span class="token comment">//ä»»åŠ¡id</span>  <span class="token property">"usersMap"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"array"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token property">"bigDecimal"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token property">"bigInteger"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token property">"binary"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token property">"boolean"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token property">"containerNode"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token property">"double"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token property">"float"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token property">"floatingPointNumber"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token property">"int"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token property">"integralNumber"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token property">"long"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token property">"missingNode"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token property">"nodeType"</span><span class="token operator">:</span> <span class="token string">"ARRAY"</span><span class="token punctuation">,</span>    <span class="token property">"null"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token property">"number"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token property">"object"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token property">"pojo"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token property">"short"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token property">"textual"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token property">"valueNode"</span><span class="token operator">:</span> <span class="token boolean">true</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token property">"vars"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token comment">//è®¾ç½®æµç¨‹å˜é‡</span>    <span class="token property">"additionalProp1"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>    <span class="token property">"additionalProp2"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>    <span class="token property">"additionalProp3"</span><span class="token operator">:</span> <span class="token string">"string"</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-å¾…åŠ"><a href="#3-å¾…åŠ" class="headerlink" title="3. å¾…åŠ"></a>3. å¾…åŠ</h2><p>POST: &#x2F;runtime&#x2F;task&#x2F;v1&#x2F;easywebWorkflowGetTodoList</p><p>è¯·æ±‚å¤´å‚æ•°ï¼š</p><table><thead><tr><th align="left">å‚æ•°å</th><th align="left">è¯´æ˜</th><th align="left">å€¼</th></tr></thead><tbody><tr><td align="left">Authorization</td><td align="left">ç”¨æˆ·è®¤è¯ä¿¡æ¯</td><td align="left">Bearer ç”¨æˆ·è®¤è¯ä¿¡æ¯</td></tr><tr><td align="left">Content-Type</td><td align="left">ç±»å‹</td><td align="left">application&#x2F;json</td></tr></tbody></table><p>å¾…åŠå®é™…åŠç†urlç»´æŠ¤</p><pre class="line-numbers language-json" data-language="json"><code class="language-json">  <span class="token punctuation">&#123;</span>  <span class="token property">"pageBean"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"page"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>    <span class="token property">"pageSize"</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>    <span class="token property">"showTotal"</span><span class="token operator">:</span> <span class="token boolean">true</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token property">"querys"</span><span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">&#123;</span>      <span class="token property">"group"</span><span class="token operator">:</span> <span class="token string">"main"</span><span class="token punctuation">,</span>      <span class="token property">"hasInitValue"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>      <span class="token property">"operation"</span><span class="token operator">:</span> <span class="token string">"EQUAL"</span><span class="token punctuation">,</span>      <span class="token property">"property"</span><span class="token operator">:</span> <span class="token string">"var_aa"</span><span class="token punctuation">,</span>      <span class="token property">"relation"</span><span class="token operator">:</span> <span class="token string">"AND"</span><span class="token punctuation">,</span>      <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2"</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token property">"sorter"</span><span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">&#123;</span>      <span class="token property">"direction"</span><span class="token operator">:</span> <span class="token string">"ASC"</span><span class="token punctuation">,</span>      <span class="token property">"property"</span><span class="token operator">:</span> <span class="token string">"complete_time_"</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="4-å·²åŠ"><a href="#4-å·²åŠ" class="headerlink" title="4. å·²åŠ"></a>4. å·²åŠ</h2><p>POST: &#x2F;runtime&#x2F;instance&#x2F;v1&#x2F;getDoneList</p><pre class="line-numbers language-json" data-language="json"><code class="language-json">  <span class="token punctuation">&#123;</span>  <span class="token property">"pageBean"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"page"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>    <span class="token property">"pageSize"</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>    <span class="token property">"showTotal"</span><span class="token operator">:</span> <span class="token boolean">true</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token property">"querys"</span><span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">&#123;</span>      <span class="token property">"group"</span><span class="token operator">:</span> <span class="token string">"main"</span><span class="token punctuation">,</span>      <span class="token property">"hasInitValue"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>      <span class="token property">"operation"</span><span class="token operator">:</span> <span class="token string">"EQUAL"</span><span class="token punctuation">,</span>      <span class="token property">"property"</span><span class="token operator">:</span> <span class="token string">"var_aa"</span><span class="token punctuation">,</span>      <span class="token property">"relation"</span><span class="token operator">:</span> <span class="token string">"AND"</span><span class="token punctuation">,</span>      <span class="token property">"value"</span><span class="token operator">:</span> <span class="token string">"2"</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token property">"sorter"</span><span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">&#123;</span>      <span class="token property">"direction"</span><span class="token operator">:</span> <span class="token string">"ASC"</span><span class="token punctuation">,</span>      <span class="token property">"property"</span><span class="token operator">:</span> <span class="token string">"complete_time_"</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œæµ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥ä½œæµ </tag>
            
            <tag> å¼•æ“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥ä½œæµæœåŠ¡èƒ½åŠ›å±•ç¤º</title>
      <link href="/platform.github.io/2022/09/19/%E5%B7%A5%E4%BD%9C%E6%B5%81%E9%9B%86%E6%88%90%E5%8A%9F%E8%83%BD/"/>
      <url>/platform.github.io/2022/09/19/%E5%B7%A5%E4%BD%9C%E6%B5%81%E9%9B%86%E6%88%90%E5%8A%9F%E8%83%BD/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸºäºactivityå¼€æºå·¥ä½œæµå¼•æ“åšäºŒæ¬¡å¼€å‘é›†æˆï¼Œå¢å¼ºæµç¨‹å¼•æ“èƒ½åŠ›ï¼Œé›†æˆçš„åŠŸèƒ½æœ‰ï¼š"><a href="#åŸºäºactivityå¼€æºå·¥ä½œæµå¼•æ“åšäºŒæ¬¡å¼€å‘é›†æˆï¼Œå¢å¼ºæµç¨‹å¼•æ“èƒ½åŠ›ï¼Œé›†æˆçš„åŠŸèƒ½æœ‰ï¼š" class="headerlink" title="åŸºäºactivityå¼€æºå·¥ä½œæµå¼•æ“åšäºŒæ¬¡å¼€å‘é›†æˆï¼Œå¢å¼ºæµç¨‹å¼•æ“èƒ½åŠ›ï¼Œé›†æˆçš„åŠŸèƒ½æœ‰ï¼š"></a>åŸºäºactivityå¼€æºå·¥ä½œæµå¼•æ“åšäºŒæ¬¡å¼€å‘é›†æˆï¼Œå¢å¼ºæµç¨‹å¼•æ“èƒ½åŠ›ï¼Œé›†æˆçš„åŠŸèƒ½æœ‰ï¼š</h2><h3 id="1-å¯åŠ¨ï¼ˆè·³è¿‡ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æˆ–ä¸è·³è¿‡ç¬¬ä¸€ä¸ªèŠ‚ç‚¹é…ç½®ï¼‰"><a href="#1-å¯åŠ¨ï¼ˆè·³è¿‡ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æˆ–ä¸è·³è¿‡ç¬¬ä¸€ä¸ªèŠ‚ç‚¹é…ç½®ï¼‰" class="headerlink" title="1.å¯åŠ¨ï¼ˆè·³è¿‡ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æˆ–ä¸è·³è¿‡ç¬¬ä¸€ä¸ªèŠ‚ç‚¹é…ç½®ï¼‰"></a>1.å¯åŠ¨ï¼ˆè·³è¿‡ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æˆ–ä¸è·³è¿‡ç¬¬ä¸€ä¸ªèŠ‚ç‚¹é…ç½®ï¼‰</h3><h3 id="2-åŠç†ï¼ˆé©³å›ã€é©³å›åç›´æ¥åˆ°é©³å›èŠ‚ç‚¹ã€é‡æ–°èµ°ã€‘ã€è‡ªç”±è·³è½¬ã€é€‰æ‹©è·¯å¾„è·³è½¬ã€è‡ªåŠ¨è·³è¿‡ã€æ¡ä»¶åˆ†æ”¯ã€è§„åˆ™è·³è½¬ï¼‰"><a href="#2-åŠç†ï¼ˆé©³å›ã€é©³å›åç›´æ¥åˆ°é©³å›èŠ‚ç‚¹ã€é‡æ–°èµ°ã€‘ã€è‡ªç”±è·³è½¬ã€é€‰æ‹©è·¯å¾„è·³è½¬ã€è‡ªåŠ¨è·³è¿‡ã€æ¡ä»¶åˆ†æ”¯ã€è§„åˆ™è·³è½¬ï¼‰" class="headerlink" title="2.åŠç†ï¼ˆé©³å›ã€é©³å›åç›´æ¥åˆ°é©³å›èŠ‚ç‚¹ã€é‡æ–°èµ°ã€‘ã€è‡ªç”±è·³è½¬ã€é€‰æ‹©è·¯å¾„è·³è½¬ã€è‡ªåŠ¨è·³è¿‡ã€æ¡ä»¶åˆ†æ”¯ã€è§„åˆ™è·³è½¬ï¼‰"></a>2.åŠç†ï¼ˆé©³å›ã€é©³å›åç›´æ¥åˆ°é©³å›èŠ‚ç‚¹ã€é‡æ–°èµ°ã€‘ã€è‡ªç”±è·³è½¬ã€é€‰æ‹©è·¯å¾„è·³è½¬ã€è‡ªåŠ¨è·³è¿‡ã€æ¡ä»¶åˆ†æ”¯ã€è§„åˆ™è·³è½¬ï¼‰</h3><h3 id="3-ååŠï¼ˆè®©ååŠäººæåŠç†æ„è§ï¼‰"><a href="#3-ååŠï¼ˆè®©ååŠäººæåŠç†æ„è§ï¼‰" class="headerlink" title="3.ååŠï¼ˆè®©ååŠäººæåŠç†æ„è§ï¼‰"></a>3.ååŠï¼ˆè®©ååŠäººæåŠç†æ„è§ï¼‰</h3><h3 id="4-è½¬åŠï¼ˆåŠç†æƒè½¬ç»™ä»–äººï¼‰"><a href="#4-è½¬åŠï¼ˆåŠç†æƒè½¬ç»™ä»–äººï¼‰" class="headerlink" title="4.è½¬åŠï¼ˆåŠç†æƒè½¬ç»™ä»–äººï¼‰"></a>4.è½¬åŠï¼ˆåŠç†æƒè½¬ç»™ä»–äººï¼‰</h3><h3 id="5-æœŸé™é¢„è­¦ï¼ˆåˆ°æœŸé¢„è­¦ï¼‰"><a href="#5-æœŸé™é¢„è­¦ï¼ˆåˆ°æœŸé¢„è­¦ï¼‰" class="headerlink" title="5.æœŸé™é¢„è­¦ï¼ˆåˆ°æœŸé¢„è­¦ï¼‰"></a>5.æœŸé™é¢„è­¦ï¼ˆåˆ°æœŸé¢„è­¦ï¼‰</h3><h3 id="6-ä¼šç­¾åŠ ç­¾"><a href="#6-ä¼šç­¾åŠ ç­¾" class="headerlink" title="6.ä¼šç­¾åŠ ç­¾"></a>6.ä¼šç­¾åŠ ç­¾</h3><h3 id="7-ä¿¡æ¯é€šçŸ¥ï¼ˆé€šè¿‡å¾®ä¿¡ã€çŸ­ä¿¡ã€é’‰é’‰ã€é‚®ä»¶ç­‰é€šçŸ¥ï¼‰"><a href="#7-ä¿¡æ¯é€šçŸ¥ï¼ˆé€šè¿‡å¾®ä¿¡ã€çŸ­ä¿¡ã€é’‰é’‰ã€é‚®ä»¶ç­‰é€šçŸ¥ï¼‰" class="headerlink" title="7.ä¿¡æ¯é€šçŸ¥ï¼ˆé€šè¿‡å¾®ä¿¡ã€çŸ­ä¿¡ã€é’‰é’‰ã€é‚®ä»¶ç­‰é€šçŸ¥ï¼‰"></a>7.ä¿¡æ¯é€šçŸ¥ï¼ˆé€šè¿‡å¾®ä¿¡ã€çŸ­ä¿¡ã€é’‰é’‰ã€é‚®ä»¶ç­‰é€šçŸ¥ï¼‰</h3><h3 id="8-ä»£ç†ï¼ˆå±€éƒ¨æµç¨‹æˆ–å…¨æµç¨‹åŠç†æƒç»™ä»£ç†äººï¼‰"><a href="#8-ä»£ç†ï¼ˆå±€éƒ¨æµç¨‹æˆ–å…¨æµç¨‹åŠç†æƒç»™ä»£ç†äººï¼‰" class="headerlink" title="8.ä»£ç†ï¼ˆå±€éƒ¨æµç¨‹æˆ–å…¨æµç¨‹åŠç†æƒç»™ä»£ç†äººï¼‰"></a>8.ä»£ç†ï¼ˆå±€éƒ¨æµç¨‹æˆ–å…¨æµç¨‹åŠç†æƒç»™ä»£ç†äººï¼‰</h3><h3 id="9-äº‹ä»¶ï¼ˆæµç¨‹å¯åŠ¨ã€æµç¨‹ç»“æŸã€ä»»åŠ¡å¯åŠ¨ã€ä»»åŠ¡åŠç†ã€å‰ç½®ã€åç½®ï¼‰"><a href="#9-äº‹ä»¶ï¼ˆæµç¨‹å¯åŠ¨ã€æµç¨‹ç»“æŸã€ä»»åŠ¡å¯åŠ¨ã€ä»»åŠ¡åŠç†ã€å‰ç½®ã€åç½®ï¼‰" class="headerlink" title="9.äº‹ä»¶ï¼ˆæµç¨‹å¯åŠ¨ã€æµç¨‹ç»“æŸã€ä»»åŠ¡å¯åŠ¨ã€ä»»åŠ¡åŠç†ã€å‰ç½®ã€åç½®ï¼‰"></a>9.äº‹ä»¶ï¼ˆæµç¨‹å¯åŠ¨ã€æµç¨‹ç»“æŸã€ä»»åŠ¡å¯åŠ¨ã€ä»»åŠ¡åŠç†ã€å‰ç½®ã€åç½®ï¼‰</h3><h3 id="10-ä¸€ä»¶äº‹ï¼ˆå°†å¤šä¸ªæµç¨‹ä¸²èµ·æ¥ï¼Œä¾‹å¦‚ï¼šä¹°è½¦ä¸€ä»¶äº‹ã€åŒ…å«è´­è½¦è´­ç½®ç¨ã€ä¸Šç‰Œç­‰äº‹é¡¹åŠç†ã€‘ï¼‰"><a href="#10-ä¸€ä»¶äº‹ï¼ˆå°†å¤šä¸ªæµç¨‹ä¸²èµ·æ¥ï¼Œä¾‹å¦‚ï¼šä¹°è½¦ä¸€ä»¶äº‹ã€åŒ…å«è´­è½¦è´­ç½®ç¨ã€ä¸Šç‰Œç­‰äº‹é¡¹åŠç†ã€‘ï¼‰" class="headerlink" title="10.ä¸€ä»¶äº‹ï¼ˆå°†å¤šä¸ªæµç¨‹ä¸²èµ·æ¥ï¼Œä¾‹å¦‚ï¼šä¹°è½¦ä¸€ä»¶äº‹ã€åŒ…å«è´­è½¦è´­ç½®ç¨ã€ä¸Šç‰Œç­‰äº‹é¡¹åŠç†ã€‘ï¼‰"></a>10.ä¸€ä»¶äº‹ï¼ˆå°†å¤šä¸ªæµç¨‹ä¸²èµ·æ¥ï¼Œä¾‹å¦‚ï¼šä¹°è½¦ä¸€ä»¶äº‹ã€åŒ…å«è´­è½¦è´­ç½®ç¨ã€ä¸Šç‰Œç­‰äº‹é¡¹åŠç†ã€‘ï¼‰</h3>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œæµ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥ä½œæµ </tag>
            
            <tag> å¼•æ“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•åœ¨ Java8 ä¸­é£éªšèµ°ä½é¿å¼€ç©ºæŒ‡é’ˆå¼‚å¸¸</title>
      <link href="/platform.github.io/2022/09/19/%E5%A6%82%E4%BD%95%E5%9C%A8%20Java8%20%E4%B8%AD%E9%A3%8E%E9%AA%9A%E8%B5%B0%E4%BD%8D%E9%81%BF%E5%BC%80%E7%A9%BA%E6%8C%87%E9%92%88%E5%BC%82%E5%B8%B8/"/>
      <url>/platform.github.io/2022/09/19/%E5%A6%82%E4%BD%95%E5%9C%A8%20Java8%20%E4%B8%AD%E9%A3%8E%E9%AA%9A%E8%B5%B0%E4%BD%8D%E9%81%BF%E5%BC%80%E7%A9%BA%E6%8C%87%E9%92%88%E5%BC%82%E5%B8%B8/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æ–‡ç« æ•´ç†ç¿»è¯‘è‡ª <a href="https://winterbe.com/posts/2015/03/15/avoid-null-checks-in-java/">https://winterbe.com/posts/2015/03/15/avoid-null-checks-in-java/</a></p></blockquote><p><img src="https://exception-image-bucket.oss-cn-hangzhou.aliyuncs.com/154773518012868"></p><p>è¦è¯´ Java ç¼–ç¨‹ä¸­å“ªä¸ªå¼‚å¸¸æ˜¯ä½ å°è±¡æœ€æ·±åˆ»çš„ï¼Œé‚£ <code>NullPointerException</code> ç©ºæŒ‡é’ˆå¯ä»¥è¯´æ˜¯è‡­åæ˜­è‘—çš„ã€‚ä¸è¦è¯´åˆçº§ç¨‹åºå‘˜ä¼šç¢°åˆ°ï¼Œ<br>å³ä½¿æ˜¯ä¸­çº§ï¼Œä¸“å®¶çº§ç¨‹åºå‘˜ç¨ä¸ç•™ç¥ï¼Œå°±ä¼šæ‰å…¥è¿™ä¸ªå‘é‡Œã€‚</p><p><code>Null</code> å¼•ç”¨çš„å‘æ˜è€… <a href="http://en.wikipedia.org/wiki/Tony_Hoare">Tony Hoare</a> æ›¾åœ¨ 2009 å¹´ä½œå‡ºé“æ­‰å£°æ˜ï¼Œå£°æ˜ä¸­è¡¨ç¤ºï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œç©ºæŒ‡é’ˆå¼‚å¸¸å¤§çº¦ç»™ä¼ä¸šå·²é€ æˆæ•°åäº¿ç¾å…ƒçš„æŸå¤±ã€‚</p><p>ä¸‹é¢æ˜¯ Tony Hoare çš„åŸè¯ï¼š</p><blockquote><p>æˆ‘å°† Null å¼•ç”¨çš„è®¾è®¡ç§°ä¸ºæ˜¯ä¸€ä¸ªæ•°åäº¿ç¾å…ƒçš„é”™è¯¯ã€‚1965 é‚£å¹´ï¼Œæˆ‘æ­£åœ¨ç”¨é¢å‘å¯¹è±¡è¯­è¨€(ALGOL W) è®¾è®¡é¦–ä¸ªåŠŸèƒ½å…¨é¢çš„ç³»ç»Ÿã€‚å½“æ—¶æˆ‘çš„è€ƒé‡æ˜¯ï¼Œç¡®ä¿æ‰€æœ‰è¢«ä½¿ç”¨çš„å¼•ç”¨éƒ½æ˜¯å®‰å…¨çš„ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è¿›è¡Œæ£€æŸ¥ã€‚ä½†æ˜¯ï¼Œæˆ‘æ²¡æœ‰æŠµä½è¯±æƒ‘ï¼ŒåŠ å…¥äº† Null å¼•ç”¨ï¼Œä»…ä»…æ˜¯ä¸ºäº†å®ç°èµ·æ¥çœäº‹ã€‚è¿™ä¹‹åï¼Œå®ƒå¯¼è‡´äº†æ•°ä¸æ¸…çš„ bugã€é”™è¯¯å’Œç³»ç»Ÿå´©æºƒï¼Œä¹Ÿä¸ºä¼ä¸šå¯¼è‡´äº†ä¸å¯ä¼°é‡çš„æŸå¤±ã€‚</p></blockquote><p>äº‹å·²è‡³æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»å­¦ä¼šé¢å¯¹å®ƒã€‚So, æˆ‘ä»¬è¦å¦‚ä½•é˜²æ­¢ç©ºæŒ‡é’ˆå¼‚å¸¸å‘¢ï¼Ÿ</p><p>å”¯ä¸€çš„åŠæ³•å°±æ˜¯å¯¹å¯èƒ½ä¸º Null çš„å¯¹è±¡æ·»åŠ æ£€æŸ¥ã€‚ä½†æ˜¯ Null æ£€æŸ¥æ˜¯ç¹çä¸”ç—›è‹¦çš„ã€‚æ‰€ä»¥ä¸€äº›æ¯”è¾ƒæ–°çš„è¯­è¨€ä¸ºäº†å¤„ç† Null æ£€æŸ¥ï¼Œç‰¹æ„æ·»åŠ äº†ç‰¹æ®Šçš„è¯­æ³•ï¼Œå¦‚<a href="http://en.wikipedia.org/wiki/Null_coalescing_operator">ç©ºåˆå¹¶è¿ç®—ç¬¦</a>ã€‚</p><blockquote><p>åœ¨ <a href="http://groovy-lang.org/operators.html#_elvis_operator">Groovy</a> æˆ– <a href="http://kotlinlang.org/docs/reference/null-safety.html">Kotlin</a> è¿™æ ·çš„è¯­è¨€ä¸­ä¹Ÿè¢«ç§°ä¸º <code>Elvis</code> è¿ç®—ç¬¦ã€‚</p></blockquote><p>ä¸å¹¸çš„æ˜¯ï¼Œåœ¨è€ç‰ˆæœ¬çš„ Java ä¸­å¹¶æ²¡æœ‰æä¾›è¿™æ ·çš„è¯­æ³•ç³–ã€‚Java8 ä¸­åœ¨è¿™æ–¹é¢åšäº†æ”¹è¿›ã€‚æ‰€ä»¥ï¼Œè¿™ç¯‡æ–‡ç« å°±ç‰¹æ„æ¥ä»‹ç»ä¸€ä¸‹å¦‚ä½•åœ¨ Java8 ä¸­åˆ©ç”¨æ–°ç‰¹æ€§æ¥ç¼–å†™é˜²æ­¢ <code>NullPointerException</code>çš„å‘ç”Ÿã€‚</p><h2 id="Java8-ä¸­å¦‚ä½•åŠ å¼ºå¯¹-Null-å¯¹è±¡çš„æ£€æŸ¥ï¼Ÿ"><a href="#Java8-ä¸­å¦‚ä½•åŠ å¼ºå¯¹-Null-å¯¹è±¡çš„æ£€æŸ¥ï¼Ÿ" class="headerlink" title="Java8 ä¸­å¦‚ä½•åŠ å¼ºå¯¹ Null å¯¹è±¡çš„æ£€æŸ¥ï¼Ÿ"></a>Java8 ä¸­å¦‚ä½•åŠ å¼ºå¯¹ Null å¯¹è±¡çš„æ£€æŸ¥ï¼Ÿ</h2><p>åœ¨ä¸Šç¯‡æ–‡ç«  <a href="">Java8 æ–°ç‰¹æ€§æŒ‡å¯¼æ‰‹å†Œ</a> ä¸­ç®€å•çš„æäº†ä¸€ä¸‹å¦‚ä½•é€šè¿‡ <code>Optional</code> ç±»æ¥å¯¹å¯¹è±¡åšç©ºæ ¡éªŒã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†ç»†è¯´ä¸€ä¸‹ï¼š</p><p><img src="https://exception-image-bucket.oss-cn-hangzhou.aliyuncs.com/154773333584293"></p><p>åœ¨ä¸šåŠ¡ç³»ç»Ÿä¸­ï¼Œå¯¹è±¡ä¸­åµŒå¥—å¯¹è±¡æ˜¯ç»å¸¸å‘ç”Ÿçš„åœºæ™¯ï¼Œå¦‚ä¸‹ç¤ºä¾‹ä»£ç ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// æœ€å¤–å±‚å¯¹è±¡</span><span class="token keyword">class</span> <span class="token class-name">Outer</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Nested</span> nested<span class="token punctuation">;</span>    <span class="token class-name">Nested</span> <span class="token function">getNested</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> nested<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// ç¬¬äºŒå±‚å¯¹è±¡</span><span class="token keyword">class</span> <span class="token class-name">Nested</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Inner</span> inner<span class="token punctuation">;</span>    <span class="token class-name">Inner</span> <span class="token function">getInner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> inner<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">// æœ€åº•å±‚å¯¹è±¡</span><span class="token keyword">class</span> <span class="token class-name">Inner</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> foo<span class="token punctuation">;</span>    <span class="token class-name">String</span> <span class="token function">getFoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> foo<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸šåŠ¡ä¸­ï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦è·å– <code>Outer</code> å¯¹è±¡å¯¹åº•å±‚çš„ <code>Inner</code> ä¸­çš„ <code>foo</code> å±æ€§ï¼Œæˆ‘ä»¬å¿…é¡»å†™ä¸€å †çš„éç©ºæ ¡éªŒï¼Œæ¥é˜²æ­¢å‘ç”Ÿ <code>NullPointerException</code>ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// ç¹ççš„ä»£ç </span><span class="token class-name">Outer</span> outer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Outer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>outer <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> outer<span class="token punctuation">.</span>nested <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> outer<span class="token punctuation">.</span>nested<span class="token punctuation">.</span>inner <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>outer<span class="token punctuation">.</span>nested<span class="token punctuation">.</span>inner<span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é€šè¿‡-Optional"><a href="#é€šè¿‡-Optional" class="headerlink" title="é€šè¿‡ Optional"></a>é€šè¿‡ Optional</h2><p>åœ¨ Java8 ä¸­ï¼Œæˆ‘ä»¬æœ‰æ›´ä¼˜é›…çš„è§£å†³æ–¹å¼ï¼Œé‚£å°±æ˜¯ä½¿ç”¨ <code>Optional</code>æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€è¡Œä»£ç ä¸­ï¼Œè¿›è¡Œæµæ°´å¼çš„ <code>map</code> æ“ä½œã€‚è€Œ <strong>map æ–¹æ³•å†…éƒ¨ä¼šè‡ªåŠ¨è¿›è¡Œç©ºæ ¡éªŒ</strong>ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Outer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Outer</span><span class="token operator">::</span><span class="token function">getNested</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Nested</span><span class="token operator">::</span><span class="token function">getInner</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Inner</span><span class="token operator">::</span><span class="token function">getFoo</span>    <span class="token punctuation">.</span><span class="token function">ifPresent</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¦‚æœä¸ä¸ºç©ºï¼Œæœ€ç»ˆè¾“å‡º foo çš„å€¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é€šè¿‡-suppiler-å‡½æ•°è‡ªå®šä¹‰å¢å¼º-API"><a href="#é€šè¿‡-suppiler-å‡½æ•°è‡ªå®šä¹‰å¢å¼º-API" class="headerlink" title="é€šè¿‡ suppiler å‡½æ•°è‡ªå®šä¹‰å¢å¼º API"></a>é€šè¿‡ suppiler å‡½æ•°è‡ªå®šä¹‰å¢å¼º API</h2><p>ä¸Šé¢è¿™ç§æ–¹å¼ä¸ªäººæ„Ÿè§‰è¿˜æ˜¯æœ‰ç‚¹å•°å—¦ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ <code>suppiler</code> å‡½æ•°æ¥å‡ºä¸€ä¸ªç»ˆæè§£å†³æ–¹æ¡ˆï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> resolver<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">T</span> result <span class="token operator">=</span> resolver<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">ofNullable</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NullPointerException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// å¯èƒ½ä¼šæŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œç›´æ¥è¿”å›ä¸€ä¸ªç©ºçš„ Optional å¯¹è±¡</span>        <span class="token keyword">return</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ©ç”¨ä¸Šé¢çš„ <code>resolve</code> æ–¹æ³•æ¥é‡æ„ä¸Šè¿°çš„éç©ºæ ¡éªŒä»£ç æ®µï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Outer</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Outer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ç›´æ¥è°ƒç”¨ resolve æ–¹æ³•ï¼Œå†…éƒ¨åšç©ºæŒ‡é’ˆçš„å¤„ç†</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> obj<span class="token punctuation">.</span><span class="token function">getNested</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">.</span><span class="token function">ifPresent</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¦‚æœä¸ä¸ºç©ºï¼Œæœ€ç»ˆè¾“å‡º foo çš„å€¼</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>ä½ éœ€è¦çŸ¥é“çš„æ˜¯ï¼Œä¸Šé¢è¿™ä¸¤ä¸ªè§£å†³æ–¹æ¡ˆå¹¶æ²¡ä¼ ç»Ÿçš„ <code>null</code> æ£€æŸ¥æ€§èƒ½é‚£ä¹ˆé«˜æ•ˆã€‚ä½†åœ¨ç»å¤§éƒ¨åˆ†ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œèˆå¼ƒé‚£ä¹ˆä¸€ä¸¢ä¸¢çš„æ€§èƒ½æ¥æ–¹ä¾¿ç¼–ç ï¼Œæ˜¯å®Œå…¨å¯å–ï¼Œ<br>é™¤éæ˜¯é‚£ç§å¯¹æ€§èƒ½æœ‰ä¸¥æ ¼è¦æ±‚çš„åœºæ™¯ï¼Œæˆ‘ä»¬æ‰ä¸å»ºè®®ä½¿ç”¨ã€‚</p><blockquote><p>ä¸ªäººè§‰å¾—ï¼ŒçœŸè¦æ‹¿è¿™ç‚¹æ€§èƒ½è¯´äº‹ï¼Œè¿˜ä¸å¦‚å»ä¼˜åŒ–ä¼˜åŒ– sql è¯­å¥ï¼Œä¸šåŠ¡é€»è¾‘ç­‰ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> jdk8 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> jdk8 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Tabby</title>
      <link href="/platform.github.io/2022/09/19/Tabby/"/>
      <url>/platform.github.io/2022/09/19/Tabby/</url>
      
        <content type="html"><![CDATA[<h2 id="Tabbyæ˜¯ä¸€æ¬¾å¼€æºç»ˆç«¯å·¥å…·ï¼Œæ ‡æ˜Ÿè¿‡ä¸‡"><a href="#Tabbyæ˜¯ä¸€æ¬¾å¼€æºç»ˆç«¯å·¥å…·ï¼Œæ ‡æ˜Ÿè¿‡ä¸‡" class="headerlink" title="Tabbyæ˜¯ä¸€æ¬¾å¼€æºç»ˆç«¯å·¥å…·ï¼Œæ ‡æ˜Ÿè¿‡ä¸‡"></a>Tabbyæ˜¯ä¸€æ¬¾å¼€æºç»ˆç«¯å·¥å…·ï¼Œæ ‡æ˜Ÿè¿‡ä¸‡</h2><h3 id="ä¸€ã€ä»‹ç»"><a href="#ä¸€ã€ä»‹ç»" class="headerlink" title="ä¸€ã€ä»‹ç»"></a>ä¸€ã€ä»‹ç»</h3><p> ğŸ€ Tabbyæ˜¯ä¸€ä¸ªæ— é™å¯å®šåˆ¶çš„è·¨å¹³å°ç»ˆç«¯åº”ç”¨ç¨‹åºï¼Œé€‚ç”¨äºlocal shellsã€serialã€SSHå’ŒTelnetçš„è¿æ¥ã€‚</p><p> ğŸ Tabbyæ˜¯åŸºäºTypeScriptå¼€å‘çš„ç»ˆç«¯æ¨¡æ‹Ÿå™¨ï¼Œå¯ç”¨äºLinuxã€Windowså’ŒMac OSç³»ç»Ÿã€‚</p><h3 id="äºŒã€ä¸‹è½½å®‰è£…"><a href="#äºŒã€ä¸‹è½½å®‰è£…" class="headerlink" title="äºŒã€ä¸‹è½½å®‰è£…"></a>äºŒã€ä¸‹è½½å®‰è£…</h3><p>ğŸ’ å¯å»å®˜ç½‘ï¼š<a href="https://tabby.sh/">https://tabby.sh</a> ä¸‹è½½å¹¶å®‰è£…Tabbyå¯¹åº”çš„ç‰ˆæœ¬ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç»ˆç«¯å·¥å…· </category>
          
          <category> tabby </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç»ˆç«¯å·¥å…· </tag>
            
            <tag> Linux </tag>
            
            <tag> tabby </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼€å‘è¯´æ˜|è§„èŒƒ</title>
      <link href="/platform.github.io/2022/09/19/standard/"/>
      <url>/platform.github.io/2022/09/19/standard/</url>
      
        <content type="html"><![CDATA[<h2 id="å¼€å‘è¯´æ˜"><a href="#å¼€å‘è¯´æ˜" class="headerlink" title="å¼€å‘è¯´æ˜"></a>å¼€å‘è¯´æ˜</h2><h3 id="EnableCustomConfig"><a href="#EnableCustomConfig" class="headerlink" title="@EnableCustomConfig"></a>@EnableCustomConfig</h3><p>æœåŠ¡å¯åŠ¨ç±»å¯ä»¥é€šè¿‡<code>@EnableCustomConfig </code>è¿›è¡ŒæœåŠ¡çš„åˆå§‹åŒ–é…ç½®ã€‚è¯¥æ³¨è§£ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªä½œç”¨ï¼š</p><ol><li>MappScanæ‰«ææ”¯æŒ</li><li>ComponentScanæ‰«ææ”¯æŒ</li></ol><h3 id="EnableCustomSwagger2"><a href="#EnableCustomSwagger2" class="headerlink" title="@EnableCustomSwagger2"></a>@EnableCustomSwagger2</h3><p><code>@EnableCustomSwagger2</code> å¯¹åœ¨çº¿apiæ–‡æ¡£æ”¯æŒï¼Œ&#x2F;doc.htmlè®¿é—®swaggeråŠ å¼º</p><h3 id="LoginUser"><a href="#LoginUser" class="headerlink" title="@LoginUser"></a>@LoginUser</h3><p>åœ¨controllerå‚æ•°ä¸­é€šè¿‡<code>@LoginUser SysUser loginUser</code> è·å–å½“å‰ç™»å½•ç”¨æˆ·<br><strong>ç¤ºä¾‹</strong><br> <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/functions/manage"</span><span class="token punctuation">,</span> produces <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"application/json; charset=utf-8"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span> <span class="token function">queryManageFunctions</span><span class="token punctuation">(</span><span class="token annotation punctuation">@LoginUser</span> <span class="token class-name">SysUser</span> loginUser<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token comment">// ... </span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></p><h3 id="Log-title-x3D-â€œè®¾è®¡â€-businessType-x3D-BusinessType-INSERT"><a href="#Log-title-x3D-â€œè®¾è®¡â€-businessType-x3D-BusinessType-INSERT" class="headerlink" title="@Log(title &#x3D; â€œè®¾è®¡â€, businessType &#x3D; BusinessType.INSERT)"></a>@Log(title &#x3D; â€œè®¾è®¡â€, businessType &#x3D; BusinessType.INSERT)</h3><p>åœ¨controlleræ–¹æ³•ä¸Šé€šè¿‡æ³¨è§£<code>@Log </code>å®ç°æ“ä½œæ—¥å¿—æ”¶é›†(ä¸»è¦é’ˆå¯¹æ›¾ã€åˆ ã€æ”¹æ“ä½œ)<br><strong>ç¤ºä¾‹</strong><br> <pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"ä¿å­˜"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Log</span><span class="token punctuation">(</span>title <span class="token operator">=</span> <span class="token string">"XXXä¿å­˜"</span><span class="token punctuation">,</span> businessType <span class="token operator">=</span> <span class="token class-name">BusinessType</span><span class="token punctuation">.</span>INSERT<span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token class-name">ResObject</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Validated</span><span class="token punctuation">(</span><span class="token class-name">ValidType<span class="token punctuation">.</span>Default</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">BpmDefinitionDesignVO</span> vo<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><h3 id="Valid"><a href="#Valid" class="headerlink" title="@Valid"></a>@Valid</h3><p><code>@Valid</code>ä¼šå¯¹è¢«æ ‡æ³¨çš„controllerå…¥å‚ç±»è¿›è¡Œå‚æ•°æ ¡éªŒ</p><p>è¢«æ ‡æ³¨çš„ç±»ä¸­æœ‰<code>@Length</code>æ³¨è§£æ ‡æ³¨çš„å­—æ®µï¼Œåˆ™è¯¥å­—æ®µä¸èƒ½è¶…è¿‡æŒ‡å®šé•¿åº¦</p><p>è¢«æ ‡æ³¨çš„ç±»æœ‰<code>@NotBlank</code>æ³¨è§£æ ‡æ³¨çš„å­—æ®µï¼Œåˆ™è¯¥å­—æ®µä¸èƒ½ä¸ºç©º</p><p>æ›´å¤šå‚æ•°æ ¡éªŒæ³¨è§£è¯·å‚è€ƒhibernate validator</p><p>å½“æ ¡éªŒæ¡ä»¶ä¸æ»¡è¶³çš„æ—¶å€™ï¼Œä¼šè¿›å…¥ç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼Œç»Ÿä¸€å¼‚å¸¸å¤„ç†ä¼šç»™å‰ç«¯è¿”å›codeä¸º0ï¼Œmessageä¸ºæŒ‡å®šmessageçš„æ¶ˆæ¯</p><p><strong>ç¤ºä¾‹</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Valid</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">DeptBasic</span> dept<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DeptBasic</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">"éƒ¨é—¨åç§°ä¸å¯ä¸ºç©º"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> jgMc<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Length</span><span class="token punctuation">(</span>max <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">"é€‰ç”¨æ ‡å¿—é•¿åº¦æœ€å¤§ä¸º1"</span><span class="token punctuation">)</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> xybs<span class="token punctuation">;</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å¼€å‘è§„èŒƒ"><a href="#å¼€å‘è§„èŒƒ" class="headerlink" title="å¼€å‘è§„èŒƒ"></a>å¼€å‘è§„èŒƒ</h2><h3 id="æ•°æ®æ ¼å¼"><a href="#æ•°æ®æ ¼å¼" class="headerlink" title="æ•°æ®æ ¼å¼"></a>æ•°æ®æ ¼å¼</h3><h4 id="1-å†™å¥½ä»£ç æ³¨é‡Šï¼Œç»Ÿä¸€æ ¼å¼"><a href="#1-å†™å¥½ä»£ç æ³¨é‡Šï¼Œç»Ÿä¸€æ ¼å¼" class="headerlink" title="1.å†™å¥½ä»£ç æ³¨é‡Šï¼Œç»Ÿä¸€æ ¼å¼"></a>1.å†™å¥½ä»£ç æ³¨é‡Šï¼Œç»Ÿä¸€æ ¼å¼</h4><p>ç±»æ³¨é‡Šï¼š<br>&#x2F;**</p><ul><li>@author ä½œè€…</li><li>@Description æè¿°</li><li>@Date æ—¥æœŸï¼ˆå¹´æœˆæ—¥æ—¶åˆ†ç§’ï¼‰<br>*&#x2F;</li></ul><p>æ–¹æ³•æ³¨é‡Šï¼š</p><p>&#x2F;**</p><ul><li>@param formId  å‚æ•°1æè¿°</li><li>@param instId  å‚æ•°2æè¿°</li><li>@param taskKey å‚æ•°3æè¿°</li><li>@return  ResObject è¿”å›æè¿°<br>*&#x2F;</li></ul><h4 id="2-è¿”å›æ ¼å¼ç»Ÿä¸€-â€œcodeâ€-â€â€-â€messageâ€-â€â€-â€dataâ€-â€â€"><a href="#2-è¿”å›æ ¼å¼ç»Ÿä¸€-â€œcodeâ€-â€â€-â€messageâ€-â€â€-â€dataâ€-â€â€" class="headerlink" title="2.è¿”å›æ ¼å¼ç»Ÿä¸€{â€œcodeâ€:â€â€,â€messageâ€:â€â€,â€dataâ€:â€â€}"></a>2.è¿”å›æ ¼å¼ç»Ÿä¸€{â€œcodeâ€:â€â€,â€messageâ€:â€â€,â€dataâ€:â€â€}</h4><table><thead><tr><th>å±æ€§</th><th>æè¿°</th></tr></thead><tbody><tr><td>code</td><td>200è¡¨ç¤ºæ“ä½œæˆåŠŸ</td></tr><tr><td>message</td><td>æç¤ºä¿¡æ¯</td></tr><tr><td>data</td><td>è¿”å›æ•°æ®</td></tr></tbody></table><h4 id="3-åšå¥½å¼‚å¸¸å¤„ç†"><a href="#3-åšå¥½å¼‚å¸¸å¤„ç†" class="headerlink" title="3.åšå¥½å¼‚å¸¸å¤„ç†"></a>3.åšå¥½å¼‚å¸¸å¤„ç†</h4><p>æ‰€æœ‰æ¥å£éƒ½å¿…é¡»æœ‰å¼‚å¸¸æŠ›å‡ºï¼Œåœ¨controlleré‡Œæ•è·æ‰€æœ‰å¼‚å¸¸å¹¶åšå¤„ç†<br><strong>ç¤ºä¾‹</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/getData"</span><span class="token punctuation">,</span> method <span class="token operator">=</span> <span class="token class-name">RequestMethod</span><span class="token punctuation">.</span>GET<span class="token punctuation">,</span> produces <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"application/json; charset=utf-8"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>   <span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"è·å–è¡¨å•æ•°æ®"</span><span class="token punctuation">,</span> httpMethod <span class="token operator">=</span> <span class="token string">"GET"</span><span class="token punctuation">,</span> notes <span class="token operator">=</span> <span class="token string">"è·å–è¡¨å•æ•°æ®"</span><span class="token punctuation">)</span>   <span class="token keyword">public</span> <span class="token class-name">ResObject</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token class-name">String</span> formId<span class="token punctuation">,</span> <span class="token class-name">String</span> instId<span class="token punctuation">,</span> <span class="token class-name">String</span> taskKey<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>       <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>           <span class="token class-name">List</span> result <span class="token operator">=</span> formDataService<span class="token punctuation">.</span><span class="token function">getDatas</span><span class="token punctuation">(</span>formId<span class="token punctuation">,</span> instId<span class="token punctuation">,</span> taskKey<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResObject</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">"è·å–è¡¨å•æ•°æ®æˆåŠŸ"</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">BusinessException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//ä¸šåŠ¡å¼‚å¸¸æ•è·</span>           log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResObject</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//ç¨‹åºå¼‚å¸¸æ•è·</span>           log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"è·å–è¡¨å•æ•°æ®å¤±è´¥"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResObject</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">"è·å–è¡¨å•æ•°æ®å¤±è´¥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4-è¯·æ±‚è·¯åŠ²è§„èŒƒ"><a href="#4-è¯·æ±‚è·¯åŠ²è§„èŒƒ" class="headerlink" title="4.è¯·æ±‚è·¯åŠ²è§„èŒƒ"></a>4.è¯·æ±‚è·¯åŠ²è§„èŒƒ</h4><p>å¸¸è§„è¯·æ±‚ç»Ÿä¸€è·¯å¾„ï¼š<br>1.åˆ†é¡µåˆ—è¡¨è¯·æ±‚ GET &#x2F;modelName&#x2F;list<br>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">@GetMapping(&quot;list&quot;)@ApiOperation(value &#x3D; &quot;æµç¨‹å®šä¹‰åˆ—è¡¨&quot;)@Log(title &#x3D; &quot;æµç¨‹è®¾è®¡&quot;, businessType &#x3D; BusinessType.INSERT)public ResObject list(@LoginUser SysUser sysUser, BpmDefinitionDesignVO vo) &#123;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¯¦æƒ…è¯·æ±‚ GET &#x2F;modelName&#x2F;{modelId}</p><pre class="line-numbers language-none"><code class="language-none">@GetMapping(value &#x3D; &#123;&quot;&#x2F;&quot;, &quot;&#x2F;&#123;modelId&#125;&quot;&#125;)@ApiOperation(value &#x3D; &quot;è·å–ç”¨æˆ·ä¿¡æ¯&quot;)public ResObject getUser(@PathVariable(value &#x3D; &quot;modelId&quot;, required &#x3D; true) String modelId)) &#123;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2.ä¿å­˜è¯·æ±‚ POST &#x2F;modelName&#x2F;<br>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">@PostMapping(&quot;&quot;)@ApiOperation(value &#x3D; &quot;å®šä¹‰ä¿å­˜&quot;)@Log(title &#x3D; &quot;è®¾è®¡&quot;, businessType &#x3D; BusinessType.INSERT)public ResObject saveDefinition(@LoginUser SysUser sysUser, @Validated(ValidType.Default.class) @RequestBody DefinitionDesignVO vo) &#123;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>3.æ›´æ–°è¯·æ±‚ PUT &#x2F;modelName&#x2F;<br>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-none"><code class="language-none">@PutMapping(&quot;&quot;)@ApiOperation(value &#x3D; &quot;å®šä¹‰æ›´æ–°&quot;)@Log(title &#x3D; &quot;è®¾è®¡&quot;, businessType &#x3D; BusinessType.UPDATE)public ResObject updateDefinition(@LoginUser SysUser sysUser, @Validated(ValidType.Default.class) @RequestBody DefinitionDesignVO vo) &#123;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>4.åˆ é™¤è¯·æ±‚ DELETE &#x2F;modelName&#x2F;</p><pre class="line-numbers language-none"><code class="language-none">@DeleteMapping(&quot;&quot;)@ApiOperation(value &#x3D; &quot;å®šä¹‰åˆ é™¤&quot;)@Log(title &#x3D; &quot;è®¾è®¡&quot;, businessType &#x3D; BusinessType.DELETE)public ResObject deleteDefinition(@LoginUser SysUser sysUser,DefinitionDesignVO vo) &#123;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="5-feign"><a href="#5-feign" class="headerlink" title="5.feign"></a>5.feign</h4><p>ä»¥feignå½¢å¼æä¾›æ¥å£æœåŠ¡ï¼Œæ¥å£åœ°å€ç»Ÿä¸€â€œ&#x2F;apiâ€å¼€å¤´</p><h4 id="6-mybatis-plus"><a href="#6-mybatis-plus" class="headerlink" title="6.mybatis-plus"></a>6.mybatis-plus</h4><p>mapperã€dao ç»§æ‰¿ç±»BaseMapper<T>ï¼Œå¹¶åœ¨Tå®ä½“ç±»ä¸Šæ·»åŠ @TableNameã€@TableIdæ³¨è§£<br><strong>ç¤ºä¾‹</strong></p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span><span class="token string">"sys_unit"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SysUnit</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">&#123;</span>  <span class="token comment">// ...å®ä½“ç±»</span>    <span class="token comment">/**     * æœºæ„ä¸»é”®     */</span>    <span class="token annotation punctuation">@TableId</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> unitId<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">SysUnitMapper</span> <span class="token keyword">extends</span> <span class="token class-name">BaseMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SysUnit</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span> <span class="token comment">// ...mapper || daoæ¥å£ç±» è‚ è¿‡æ“ä½œå¯ä»¥çœç•¥ä»£ç å—åŠè‡ªåŠ¨æ˜ å°„</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="7-ç‰ˆæœ¬ç®¡ç†æäº¤æ ¼å¼"><a href="#7-ç‰ˆæœ¬ç®¡ç†æäº¤æ ¼å¼" class="headerlink" title="7.ç‰ˆæœ¬ç®¡ç†æäº¤æ ¼å¼"></a>7.ç‰ˆæœ¬ç®¡ç†æäº¤æ ¼å¼</h4><p>1.gitç‰ˆæœ¬ç®¡ç†æäº¤ï¼š<br>addï¼šæ–°å¢XXXåŠŸèƒ½<br>fixï¼šä¿®å¤XXXbug  ||  å®Œå–„XXXåŠŸèƒ½</p><p>2.svnç‰ˆæœ¬ç®¡ç†æäº¤ï¼š<br>ã€æäº¤äººã€‘XXX<br>ã€å¤„ç†æ¨¡å—ã€‘å·¥ä½œæµè¡¨å•æœåŠ¡<br>ã€è§£å†³é—®é¢˜ã€‘æ–°å¢æ·»åŠ è¡¨å•ä¿å­˜æ¥å£</p><h4 id="8-ä»£ç ç”Ÿæˆ"><a href="#8-ä»£ç ç”Ÿæˆ" class="headerlink" title="8.ä»£ç ç”Ÿæˆ"></a>8.ä»£ç ç”Ÿæˆ</h4><p>åœ°å€ï¼š<br><a href="http://192.168.6.116:8080/">http://192.168.6.116:8080</a><br>éœ€è¦å…ˆè®¾è®¡æ•°æ®åº“è¡¨ï¼Œæ ¹æ®è¡¨ç»“æ„ç”Ÿæˆcontroller\service\dao\entity\mapper.xmlç­‰ç›¸å…³ä»£ç æ–‡ä»¶</p><h4 id="9-licenseå­˜æ”¾ä½ç½®"><a href="#9-licenseå­˜æ”¾ä½ç½®" class="headerlink" title="9.licenseå­˜æ”¾ä½ç½®"></a>9.licenseå­˜æ”¾ä½ç½®</h4><p>winï¼šå°†licenseæ–‡ä»¶å­˜æ”¾åˆ°åº”ç”¨æ‰€åœ¨çš„ç£ç›˜æ ¹è·¯å¾„&#x2F;opt&#x2F;license&#x2F;æ–‡ä»¶å¤¹ä¸‹<br>linuxï¼šå°†licenseæ–‡ä»¶å­˜æ”¾åˆ°&#x2F;opt&#x2F;license&#x2F;æ–‡ä»¶å¤¹ä¸‹</p>]]></content>
      
      
      <categories>
          
          <category> å¼€å‘è§„èŒƒ </category>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> å¼€å‘è§„èŒƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SM4å›½å¯†ç®—æ³•</title>
      <link href="/platform.github.io/2022/09/19/sm4/"/>
      <url>/platform.github.io/2022/09/19/sm4/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * å›½å¯†SM4 * * @author Luke-lee */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SM4Util</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> iv <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> CODE_UTF8 <span class="token operator">=</span> <span class="token string">"UTF-8"</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> PASSWORD_CRYPT_KEY <span class="token operator">=</span> <span class="token string">"CSSssDes"</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> KEY_ <span class="token operator">=</span> <span class="token string">"LUKE018YfzXjGB81"</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> ROUND <span class="token operator">=</span> <span class="token number">32</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> ENCRYPT <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> DECRYPT <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> BLOCK <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token class-name">Sbox</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xd6</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xe9</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xfe</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xe1</span><span class="token punctuation">,</span> <span class="token number">0x3d</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xb7</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xb6</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xfb</span><span class="token punctuation">,</span> <span class="token number">0x2c</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0x2b</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x9a</span><span class="token punctuation">,</span>            <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0x2a</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xc3</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xaa</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0x49</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x9c</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xf4</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xef</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x98</span><span class="token punctuation">,</span> <span class="token number">0x7a</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span>            <span class="token number">0x0b</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xed</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xcf</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xac</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xb3</span><span class="token punctuation">,</span> <span class="token number">0x1c</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xa9</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xc9</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xdf</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x8f</span><span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xa6</span><span class="token punctuation">,</span> <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xa7</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xfc</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xf3</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xba</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0x3c</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xe6</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0x4f</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xa8</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x6b</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x81</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xb2</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xda</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x8b</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xf8</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xeb</span><span class="token punctuation">,</span> <span class="token number">0x0f</span><span class="token punctuation">,</span> <span class="token number">0x4b</span><span class="token punctuation">,</span> <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x9d</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x1e</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xd1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xa2</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0x7c</span><span class="token punctuation">,</span> <span class="token number">0x3b</span><span class="token punctuation">,</span>            <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x87</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x4c</span><span class="token punctuation">,</span>            <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xe7</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xa0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xc4</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xc8</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x9e</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xea</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xbf</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x8a</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xd2</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xc7</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xb5</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xf7</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xf2</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xce</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xf9</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xa1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xe0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xae</span><span class="token punctuation">,</span> <span class="token number">0x5d</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xa4</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x9b</span><span class="token punctuation">,</span>            <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0x1a</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xad</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xf5</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x8c</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xb1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xe3</span><span class="token punctuation">,</span>            <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xf6</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xe2</span><span class="token punctuation">,</span> <span class="token number">0x2e</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xca</span><span class="token punctuation">,</span> <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xc0</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0x4e</span><span class="token punctuation">,</span> <span class="token number">0x6f</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xd5</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xdb</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xde</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xfd</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x8e</span><span class="token punctuation">,</span> <span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xff</span><span class="token punctuation">,</span> <span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0x6d</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0x5b</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xaf</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x92</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xbb</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xdd</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0x7f</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xd9</span><span class="token punctuation">,</span> <span class="token number">0x5c</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x1f</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xd8</span><span class="token punctuation">,</span> <span class="token number">0x0a</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xc1</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xa5</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xcd</span><span class="token punctuation">,</span> <span class="token number">0x7b</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xbd</span><span class="token punctuation">,</span> <span class="token number">0x2d</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xd0</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xb8</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xe5</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xb4</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xb0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x89</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span>            <span class="token number">0x0c</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x96</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0x7e</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xb9</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xf1</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x6e</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xc6</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x84</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xf0</span><span class="token punctuation">,</span> <span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xec</span><span class="token punctuation">,</span> <span class="token number">0x3a</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xee</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span>            <span class="token number">0x3e</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xd7</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xcb</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> CK <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0x00070e15</span><span class="token punctuation">,</span> <span class="token number">0x1c232a31</span><span class="token punctuation">,</span> <span class="token number">0x383f464d</span><span class="token punctuation">,</span> <span class="token number">0x545b6269</span><span class="token punctuation">,</span> <span class="token number">0x70777e85</span><span class="token punctuation">,</span> <span class="token number">0x8c939aa1</span><span class="token punctuation">,</span> <span class="token number">0xa8afb6bd</span><span class="token punctuation">,</span> <span class="token number">0xc4cbd2d9</span><span class="token punctuation">,</span>            <span class="token number">0xe0e7eef5</span><span class="token punctuation">,</span> <span class="token number">0xfc030a11</span><span class="token punctuation">,</span> <span class="token number">0x181f262d</span><span class="token punctuation">,</span> <span class="token number">0x343b4249</span><span class="token punctuation">,</span> <span class="token number">0x50575e65</span><span class="token punctuation">,</span> <span class="token number">0x6c737a81</span><span class="token punctuation">,</span> <span class="token number">0x888f969d</span><span class="token punctuation">,</span> <span class="token number">0xa4abb2b9</span><span class="token punctuation">,</span> <span class="token number">0xc0c7ced5</span><span class="token punctuation">,</span>            <span class="token number">0xdce3eaf1</span><span class="token punctuation">,</span> <span class="token number">0xf8ff060d</span><span class="token punctuation">,</span> <span class="token number">0x141b2229</span><span class="token punctuation">,</span> <span class="token number">0x30373e45</span><span class="token punctuation">,</span> <span class="token number">0x4c535a61</span><span class="token punctuation">,</span> <span class="token number">0x686f767d</span><span class="token punctuation">,</span> <span class="token number">0x848b9299</span><span class="token punctuation">,</span> <span class="token number">0xa0a7aeb5</span><span class="token punctuation">,</span> <span class="token number">0xbcc3cad1</span><span class="token punctuation">,</span>            <span class="token number">0xd8dfe6ed</span><span class="token punctuation">,</span> <span class="token number">0xf4fb0209</span><span class="token punctuation">,</span> <span class="token number">0x10171e25</span><span class="token punctuation">,</span> <span class="token number">0x2c333a41</span><span class="token punctuation">,</span> <span class="token number">0x484f565d</span><span class="token punctuation">,</span> <span class="token number">0x646b7279</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">encodeSMS4</span><span class="token punctuation">(</span><span class="token class-name">String</span> plaintext<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">SM4Util</span><span class="token punctuation">.</span><span class="token function">encodeSMS4</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">encodeSMS4</span><span class="token punctuation">(</span><span class="token class-name">String</span> plaintext<span class="token punctuation">,</span> <span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b <span class="token operator">=</span> <span class="token function">encryptDES</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span>CODE_UTF8<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> rstr <span class="token operator">=</span> <span class="token class-name">SM4Util</span><span class="token punctuation">.</span><span class="token function">encodeSMS4</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token class-name">ConvertUtil</span><span class="token punctuation">.</span><span class="token function">byteToHex</span><span class="token punctuation">(</span>rstr<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * ä¸é™æ˜æ–‡é•¿åº¦çš„SMS4åŠ å¯†     *     * @param plaintext     * @param key     * @return     */</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">encodeSMS4</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> plaintext<span class="token punctuation">,</span> <span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ciphertext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>plaintext<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> plainLen <span class="token operator">=</span> plaintext<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">&lt;=</span> plainLen<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cellPlain <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> k<span class="token punctuation">,</span> cellPlain<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cellCipher <span class="token operator">=</span> <span class="token function">encode16</span><span class="token punctuation">(</span>cellPlain<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>cellCipher<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> ciphertext<span class="token punctuation">,</span> k<span class="token punctuation">,</span> cellCipher<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>            k <span class="token operator">+=</span> <span class="token number">16</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> ciphertext<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * ä¸é™æ˜æ–‡é•¿åº¦çš„SMS4è§£å¯†     *     * @param ciphertext     * @param key     * @return     */</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">decodeSMS4</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ciphertext<span class="token punctuation">,</span> <span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> plaintext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>ciphertext<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> cipherLen <span class="token operator">=</span> ciphertext<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">&lt;=</span> cipherLen<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cellCipher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">,</span> k<span class="token punctuation">,</span> cellCipher<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cellPlain <span class="token operator">=</span> <span class="token function">decode16</span><span class="token punctuation">(</span>cellCipher<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>cellPlain<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> plaintext<span class="token punctuation">,</span> k<span class="token punctuation">,</span> cellPlain<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>            k <span class="token operator">+=</span> <span class="token number">16</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> plaintext<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * è§£å¯†ï¼Œè·å¾—æ˜æ–‡å­—ç¬¦ä¸²     *     * @param ciphertext å†…å®¹     * @param code       ç¼–ç      * @return     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">decodeSMS4toString</span><span class="token punctuation">(</span><span class="token class-name">String</span> ciphertext<span class="token punctuation">,</span> <span class="token class-name">String</span> code<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> <span class="token class-name">ConvertUtil</span><span class="token punctuation">.</span><span class="token function">hexStringToBytes</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> plaintext <span class="token operator">=</span> <span class="token function">decodeSMS4</span><span class="token punctuation">(</span>bytes<span class="token punctuation">,</span> KEY_<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">decryptDES</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> code<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * è§£å¯†ï¼Œè·å¾—æ˜æ–‡å­—ç¬¦ä¸²     *     * @param ciphertext å†…å®¹     * @param key        ç§˜é’¥     * @param code       ç¼–ç      * @return     */</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">decodeSMS4toString</span><span class="token punctuation">(</span><span class="token class-name">String</span> ciphertext<span class="token punctuation">,</span> <span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> code<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> <span class="token class-name">ConvertUtil</span><span class="token punctuation">.</span><span class="token function">hexStringToBytes</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> plaintext <span class="token operator">=</span> <span class="token function">decodeSMS4</span><span class="token punctuation">(</span>bytes<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">decryptDES</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> code<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">encode16</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> plaintext<span class="token punctuation">,</span> <span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key_ <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            key_ <span class="token operator">=</span> KEY_<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            key_ <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cipher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token class-name">SM4Util</span> sm4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SM4Util</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        sm4<span class="token punctuation">.</span><span class="token function">sms4</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> key_<span class="token punctuation">,</span> cipher<span class="token punctuation">,</span> ENCRYPT<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> cipher<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * åªåŠ å¯†16ä½æ˜æ–‡     *     * @param plaintext     * @param key     * @return     */</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> plaintext<span class="token punctuation">,</span> <span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key_ <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            key_ <span class="token operator">=</span> KEY_<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            key_ <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cipher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token class-name">SM4Util</span> sm4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SM4Util</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        sm4<span class="token punctuation">.</span><span class="token function">sms4</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> key_<span class="token punctuation">,</span> cipher<span class="token punctuation">,</span> ENCRYPT<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> cipher<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * åªè§£å¯†16ä½å¯†æ–‡     *     * @param ciphertext     * @param key     * @return     */</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">decode16</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ciphertext<span class="token punctuation">,</span> <span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> plain <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token class-name">SM4Util</span> sm4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SM4Util</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        sm4<span class="token punctuation">.</span><span class="token function">sms4</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> key<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> plain<span class="token punctuation">,</span> DECRYPT<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> plain<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">sms4</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> in<span class="token punctuation">,</span> <span class="token keyword">int</span> inLen<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> key<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> out<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token class-name">CryptFlag</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> point <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> round_key <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span>ROUND<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token class-name">SMS4KeyExt</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> round_key<span class="token punctuation">,</span> <span class="token class-name">CryptFlag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> input<span class="token punctuation">;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> output <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>inLen <span class="token operator">>=</span> BLOCK<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            input <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOfRange</span><span class="token punctuation">(</span>in<span class="token punctuation">,</span> point<span class="token punctuation">,</span> point <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">SMS4Crypt</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> output<span class="token punctuation">,</span> round_key<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> out<span class="token punctuation">,</span> point<span class="token punctuation">,</span> BLOCK<span class="token punctuation">)</span><span class="token punctuation">;</span>            inLen <span class="token operator">-=</span> BLOCK<span class="token punctuation">;</span>            point <span class="token operator">+=</span> BLOCK<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token class-name">Rotl</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> x <span class="token operator">&lt;&lt;</span> y <span class="token operator">|</span> x <span class="token operator">>>></span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token class-name">ByteSub</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token class-name">A</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">Sbox</span><span class="token punctuation">[</span><span class="token class-name">A</span> <span class="token operator">>>></span> <span class="token number">24</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token class-name">Sbox</span><span class="token punctuation">[</span><span class="token class-name">A</span> <span class="token operator">>>></span> <span class="token number">16</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span>                <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token class-name">Sbox</span><span class="token punctuation">[</span><span class="token class-name">A</span> <span class="token operator">>>></span> <span class="token number">8</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token class-name">Sbox</span><span class="token punctuation">[</span><span class="token class-name">A</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">L1</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token class-name">B</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">B</span> <span class="token operator">^</span> <span class="token class-name">Rotl</span><span class="token punctuation">(</span><span class="token class-name">B</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token class-name">Rotl</span><span class="token punctuation">(</span><span class="token class-name">B</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token class-name">Rotl</span><span class="token punctuation">(</span><span class="token class-name">B</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token class-name">Rotl</span><span class="token punctuation">(</span><span class="token class-name">B</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">L2</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token class-name">B</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">B</span> <span class="token operator">^</span> <span class="token class-name">Rotl</span><span class="token punctuation">(</span><span class="token class-name">B</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token class-name">Rotl</span><span class="token punctuation">(</span><span class="token class-name">B</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token class-name">SMS4Crypt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token class-name">Input</span><span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token class-name">Output</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> rk<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> r<span class="token punctuation">,</span> mid<span class="token punctuation">,</span> x0<span class="token punctuation">,</span> x1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> x3<span class="token punctuation">;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Input</span><span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>            tmp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Input</span><span class="token punctuation">[</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>            tmp<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Input</span><span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>            tmp<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Input</span><span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>            x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span> <span class="token operator">|</span> tmp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span> <span class="token operator">|</span> tmp<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span> <span class="token operator">|</span> tmp<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> r <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span> r <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            mid <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> rk<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">;</span>            mid <span class="token operator">=</span> <span class="token class-name">ByteSub</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span>            x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token function">L1</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// x4</span>            mid <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> rk<span class="token punctuation">[</span>r <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            mid <span class="token operator">=</span> <span class="token class-name">ByteSub</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span>            x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token function">L1</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// x5</span>            mid <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> rk<span class="token punctuation">[</span>r <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            mid <span class="token operator">=</span> <span class="token class-name">ByteSub</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span>            x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token function">L1</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// x6</span>            mid <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> rk<span class="token punctuation">[</span>r <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            mid <span class="token operator">=</span> <span class="token class-name">ByteSub</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span>            x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token function">L1</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// x7</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// Reverse</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> j <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Output</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">-</span> j <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">>>></span> <span class="token number">24</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Output</span><span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">-</span> j <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">>>></span> <span class="token number">16</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Output</span><span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">-</span> j <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">>>></span> <span class="token number">8</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Output</span><span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">-</span> j <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token class-name">SMS4KeyExt</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token class-name">Key</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> rk<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token class-name">CryptFlag</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> r<span class="token punctuation">,</span> mid<span class="token punctuation">;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> tmp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Key</span><span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">*</span> i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">;</span>            tmp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Key</span><span class="token punctuation">[</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>            tmp<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Key</span><span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>            tmp<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token class-name">Key</span><span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">;</span>            x<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span> <span class="token operator">|</span> tmp<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span> <span class="token operator">|</span> tmp<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span> <span class="token operator">|</span> tmp<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token number">0xa3b1bac6</span><span class="token punctuation">;</span>        x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token number">0x56aa3350</span><span class="token punctuation">;</span>        x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token number">0x677d9197</span><span class="token punctuation">;</span>        x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token number">0xb27022dc</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> r <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">;</span> r <span class="token operator">+=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            mid <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> CK<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">;</span>            mid <span class="token operator">=</span> <span class="token class-name">ByteSub</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span>            rk<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token function">L2</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// rk0=K4</span>            mid <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> CK<span class="token punctuation">[</span>r <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            mid <span class="token operator">=</span> <span class="token class-name">ByteSub</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span>            rk<span class="token punctuation">[</span>r <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token function">L2</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// rk1=K5</span>            mid <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> CK<span class="token punctuation">[</span>r <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            mid <span class="token operator">=</span> <span class="token class-name">ByteSub</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span>            rk<span class="token punctuation">[</span>r <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token function">L2</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// rk2=K6</span>            mid <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">^</span> x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">^</span> CK<span class="token punctuation">[</span>r <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            mid <span class="token operator">=</span> <span class="token class-name">ByteSub</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span>            rk<span class="token punctuation">[</span>r <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token function">L2</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// rk3=K7</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// è§£å¯†æ—¶è½®å¯†é’¥ä½¿ç”¨é¡ºåºï¼šrk31,rk30,...,rk0</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CryptFlag</span> <span class="token operator">==</span> DECRYPT<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span>r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> r <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> r<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                mid <span class="token operator">=</span> rk<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">;</span>                rk<span class="token punctuation">[</span>r<span class="token punctuation">]</span> <span class="token operator">=</span> rk<span class="token punctuation">[</span><span class="token number">31</span> <span class="token operator">-</span> r<span class="token punctuation">]</span><span class="token punctuation">;</span>                rk<span class="token punctuation">[</span><span class="token number">31</span> <span class="token operator">-</span> r<span class="token punctuation">]</span> <span class="token operator">=</span> mid<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * Strè½¬16ä½     *     * @param encryptString     * @return     */</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">encryptDES</span><span class="token punctuation">(</span><span class="token class-name">String</span> encryptString<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">IvParameterSpec</span> zeroIv <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IvParameterSpec</span><span class="token punctuation">(</span>iv<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">SecretKeySpec</span> key <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecretKeySpec</span><span class="token punctuation">(</span>PASSWORD_CRYPT_KEY<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"DES"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"DES/CBC/PKCS5Padding"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span>ENCRYPT_MODE<span class="token punctuation">,</span> key<span class="token punctuation">,</span> zeroIv<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encryptedData <span class="token operator">=</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>encryptString<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> hexString <span class="token operator">=</span> <span class="token function">parseByte2HexStr</span><span class="token punctuation">(</span>encryptedData<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> hexString<span class="token punctuation">;</span>        <span class="token comment">// return Base64.encode(encryptedData);</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * 16ä½è½¬str     *     * @param decrypt     * @param code     * @return     */</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">decryptDES</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> decrypt<span class="token punctuation">,</span> <span class="token class-name">String</span> code<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> byteMi <span class="token operator">=</span> <span class="token function">hex2byte</span><span class="token punctuation">(</span>decrypt<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">IvParameterSpec</span> zeroIv <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IvParameterSpec</span><span class="token punctuation">(</span>iv<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">SecretKeySpec</span> key <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecretKeySpec</span><span class="token punctuation">(</span>PASSWORD_CRYPT_KEY<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"DES"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Cipher</span> cipher <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token string">"DES/CBC/PKCS5Padding"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        cipher<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span>DECRYPT_MODE<span class="token punctuation">,</span> key<span class="token punctuation">,</span> zeroIv<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">byte</span> decryptedData<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> cipher<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>byteMi<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            code <span class="token operator">=</span> CODE_UTF8<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>decryptedData<span class="token punctuation">,</span> code<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">parseByte2HexStr</span><span class="token punctuation">(</span><span class="token keyword">byte</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">StringBuffer</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> buf<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> hex <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">toHexString</span><span class="token punctuation">(</span>buf<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>hex<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                hex <span class="token operator">=</span> <span class="token char">'0'</span> <span class="token operator">+</span> hex<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>hex<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">hex2byte</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>length <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"é•¿åº¦ä¸æ˜¯å¶æ•°"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>b<span class="token punctuation">.</span>length <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> n <span class="token operator">&lt;</span> b<span class="token punctuation">.</span>length<span class="token punctuation">;</span> n <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> item <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> n<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            b2<span class="token punctuation">[</span>n <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> b2<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token class-name">SM4Util</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> å¯¹ç§° </category>
          
          <category> å›½å¯† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å›½å¯† </tag>
            
            <tag> å¯¹ç§° </tag>
            
            <tag> sm4 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SM3å›½å¯†ç®—æ³•</title>
      <link href="/platform.github.io/2022/09/19/sm3/"/>
      <url>/platform.github.io/2022/09/19/sm3/</url>
      
        <content type="html"><![CDATA[<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">/** * å›½å¯†SM3ï¼Œæ¶ˆæ¯æ‘˜è¦ * * @author Luke */</span><span class="token annotation punctuation">@Slf4j</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SM3Util</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> chars <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token char">'0'</span><span class="token punctuation">,</span> <span class="token char">'1'</span><span class="token punctuation">,</span> <span class="token char">'2'</span><span class="token punctuation">,</span> <span class="token char">'3'</span><span class="token punctuation">,</span> <span class="token char">'4'</span><span class="token punctuation">,</span> <span class="token char">'5'</span><span class="token punctuation">,</span> <span class="token char">'6'</span><span class="token punctuation">,</span> <span class="token char">'7'</span><span class="token punctuation">,</span> <span class="token char">'8'</span><span class="token punctuation">,</span> <span class="token char">'9'</span><span class="token punctuation">,</span> <span class="token char">'A'</span><span class="token punctuation">,</span> <span class="token char">'B'</span><span class="token punctuation">,</span> <span class="token char">'C'</span><span class="token punctuation">,</span> <span class="token char">'D'</span><span class="token punctuation">,</span> <span class="token char">'E'</span><span class="token punctuation">,</span> <span class="token char">'F'</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> IV <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0x73</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token number">0x6f</span><span class="token punctuation">,</span> <span class="token number">0x49</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xb2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xb9</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span>            <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xd7</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xda</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x8a</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xa9</span><span class="token punctuation">,</span> <span class="token number">0x6f</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span>            <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xaa</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xe3</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xee</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xb0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0xfb</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0x4e</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Integer</span> TJ_15 <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token string">"79cc4519"</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Integer</span> TJ_63 <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token string">"7a879d8a"</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token class-name">FirstPadding</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x80</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token class-name">ZeroPadding</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token number">0x00</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token class-name">T</span><span class="token punctuation">(</span><span class="token keyword">int</span> j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;=</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> TJ_15<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">>=</span> <span class="token number">16</span> <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;=</span> <span class="token number">63</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> TJ_63<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"data invalid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Integer</span> <span class="token function">FF</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> x<span class="token punctuation">,</span> <span class="token class-name">Integer</span> y<span class="token punctuation">,</span> <span class="token class-name">Integer</span> z<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;=</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">^</span> y<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">^</span> z<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">>=</span> <span class="token number">16</span> <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;=</span> <span class="token number">63</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>                    <span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> y<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> z<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>y<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> z<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"data invalid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Integer</span> <span class="token function">GG</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> x<span class="token punctuation">,</span> <span class="token class-name">Integer</span> y<span class="token punctuation">,</span> <span class="token class-name">Integer</span> z<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;=</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">^</span> y<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">^</span> z<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">>=</span> <span class="token number">16</span> <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;=</span> <span class="token number">63</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> y<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token operator">~</span>x<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> z<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"data invalid"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Integer</span> <span class="token function">P0</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">Integer</span>                <span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">rotateLeft</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">rotateLeft</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Integer</span> <span class="token function">P1</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> x<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">rotateLeft</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">rotateLeft</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">padding</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> source<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>source<span class="token punctuation">.</span>length <span class="token operator">>=</span> <span class="token number">0</span>x2000000000000000L<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"src data invalid."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">long</span> l <span class="token operator">=</span> source<span class="token punctuation">.</span>length <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">;</span>        <span class="token keyword">long</span> k <span class="token operator">=</span> <span class="token number">448</span> <span class="token operator">-</span> <span class="token punctuation">(</span>l <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">512</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>k <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            k <span class="token operator">=</span> k <span class="token operator">+</span> <span class="token number">512</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>log<span class="token punctuation">.</span><span class="token function">isDebugEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"k = "</span> <span class="token operator">+</span> k<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">ByteArrayOutputStream</span> baos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            baos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>            baos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">FirstPadding</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">long</span> i <span class="token operator">=</span> k <span class="token operator">-</span> <span class="token number">7</span><span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                baos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">ZeroPadding</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                i <span class="token operator">-=</span> <span class="token number">8</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            baos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token function">long2bytes</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>log<span class="token punctuation">.</span><span class="token function">isDebugEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"paded size = "</span> <span class="token operator">+</span> baos<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">return</span> baos<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">long2bytes</span><span class="token punctuation">(</span><span class="token keyword">long</span> l<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">8</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            bytes<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>l <span class="token operator">>>></span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">7</span> <span class="token operator">-</span> i<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> bytes<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">encodeSM3</span><span class="token punctuation">(</span><span class="token class-name">String</span> source<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b <span class="token operator">=</span> <span class="token function">encodeSM3</span><span class="token punctuation">(</span>source<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token class-name">ConvertUtil</span><span class="token punctuation">.</span><span class="token function">byteToHex</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">encodeSM3</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> source<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> m1 <span class="token operator">=</span> <span class="token function">padding</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> m1<span class="token punctuation">.</span>length <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">512</span> <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>log<span class="token punctuation">.</span><span class="token function">isDebugEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"n = "</span> <span class="token operator">+</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b<span class="token punctuation">;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> vi <span class="token operator">=</span> IV<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> vi1 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            b <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOfRange</span><span class="token punctuation">(</span>m1<span class="token punctuation">,</span> i <span class="token operator">*</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            vi1 <span class="token operator">=</span> <span class="token function">CF</span><span class="token punctuation">(</span>vi<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>            vi <span class="token operator">=</span> vi1<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> vi1<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">CF</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> vi<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bi<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">int</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> e<span class="token punctuation">,</span> f<span class="token punctuation">,</span> g<span class="token punctuation">,</span> h<span class="token punctuation">;</span>        a <span class="token operator">=</span> <span class="token function">toInteger</span><span class="token punctuation">(</span>vi<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        b <span class="token operator">=</span> <span class="token function">toInteger</span><span class="token punctuation">(</span>vi<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        c <span class="token operator">=</span> <span class="token function">toInteger</span><span class="token punctuation">(</span>vi<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        d <span class="token operator">=</span> <span class="token function">toInteger</span><span class="token punctuation">(</span>vi<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        e <span class="token operator">=</span> <span class="token function">toInteger</span><span class="token punctuation">(</span>vi<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        f <span class="token operator">=</span> <span class="token function">toInteger</span><span class="token punctuation">(</span>vi<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        g <span class="token operator">=</span> <span class="token function">toInteger</span><span class="token punctuation">(</span>vi<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        h <span class="token operator">=</span> <span class="token function">toInteger</span><span class="token punctuation">(</span>vi<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> w <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">68</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> w1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            w<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">toInteger</span><span class="token punctuation">(</span>bi<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">68</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            w<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">P1</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">^</span> w<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">rotateLeft</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">rotateLeft</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>                    <span class="token operator">^</span> w<span class="token punctuation">[</span>j <span class="token operator">-</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">64</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            w1<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> w<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">^</span> w<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">int</span> ss1<span class="token punctuation">,</span> ss2<span class="token punctuation">,</span> tt1<span class="token punctuation">,</span> tt2<span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">64</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            ss1 <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">rotateLeft</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">rotateLeft</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">+</span> e <span class="token operator">+</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">rotateLeft</span><span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            ss2 <span class="token operator">=</span> ss1 <span class="token operator">^</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">rotateLeft</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            tt1 <span class="token operator">=</span> <span class="token function">FF</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> j<span class="token punctuation">)</span> <span class="token operator">+</span> d <span class="token operator">+</span> ss2 <span class="token operator">+</span> w1<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>            tt2 <span class="token operator">=</span> <span class="token function">GG</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> f<span class="token punctuation">,</span> g<span class="token punctuation">,</span> j<span class="token punctuation">)</span> <span class="token operator">+</span> h <span class="token operator">+</span> ss1 <span class="token operator">+</span> w<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>            d <span class="token operator">=</span> c<span class="token punctuation">;</span>            c <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">rotateLeft</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            b <span class="token operator">=</span> a<span class="token punctuation">;</span>            a <span class="token operator">=</span> tt1<span class="token punctuation">;</span>            h <span class="token operator">=</span> g<span class="token punctuation">;</span>            g <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">rotateLeft</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            f <span class="token operator">=</span> e<span class="token punctuation">;</span>            e <span class="token operator">=</span> <span class="token function">P0</span><span class="token punctuation">(</span>tt2<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> v <span class="token operator">=</span> <span class="token function">toByteArray</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> e<span class="token punctuation">,</span> f<span class="token punctuation">,</span> g<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> v<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            v<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> vi<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> v<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">toInteger</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> source<span class="token punctuation">,</span> <span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">StringBuilder</span> valueStr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            valueStr<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>chars<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>source<span class="token punctuation">[</span>index <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xF0</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            valueStr<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>chars<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>source<span class="token punctuation">[</span>index <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0x0F</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>valueStr<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">intValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> c<span class="token punctuation">,</span> <span class="token keyword">int</span> d<span class="token punctuation">,</span> <span class="token keyword">int</span> e<span class="token punctuation">,</span> <span class="token keyword">int</span> f<span class="token punctuation">,</span> <span class="token keyword">int</span> g<span class="token punctuation">,</span> <span class="token keyword">int</span> h<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">ByteArrayOutputStream</span> baos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            baos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token function">toByteArray</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            baos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token function">toByteArray</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            baos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token function">toByteArray</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            baos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token function">toByteArray</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            baos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token function">toByteArray</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            baos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token function">toByteArray</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            baos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token function">toByteArray</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            baos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token function">toByteArray</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> baos<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> byteArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        byteArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>i <span class="token operator">>>></span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        byteArray<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">&amp;</span> <span class="token number">0xFFFFFF</span><span class="token punctuation">)</span> <span class="token operator">>>></span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        byteArray<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">&amp;</span> <span class="token number">0xFFFF</span><span class="token punctuation">)</span> <span class="token operator">>>></span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        byteArray<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>i <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> byteArray<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token class-name">SM3Util</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> éå¯¹ç§° </category>
          
          <category> å›½å¯† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éå¯¹ç§° </tag>
            
            <tag> å›½å¯† </tag>
            
            <tag> sm3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java8 æ–°ç‰¹æ€§æ•™ç¨‹</title>
      <link href="/platform.github.io/2022/09/19/jdk8/"/>
      <url>/platform.github.io/2022/09/19/jdk8/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æœ¬æ•™ç¨‹ç¿»è¯‘æ•´ç†è‡ª <a href="https://github.com/winterbe/java8-tutorial">https://github.com/winterbe/java8-tutorial</a></p></blockquote><hr><p align="center"> â˜…â˜…â˜… å¦‚æœæ­¤æ•™ç¨‹æœ‰å¸®åŠ©åˆ°æ‚¨, <b>Star</b> ä¸€ä¸‹å§, æ‚¨è¿˜å¯ä»¥è®¿é—® :fire: <a href="https://www.exception.site/java8">ã€ŠJava8 æ–°ç‰¹æ€§æŒ‡å¯¼æ‰‹å†Œã€‹</a> :fire: æ¥é˜…è¯»å®ƒ. è°¢è°¢å•¦! â˜…â˜…â˜…</p><hr><p>æ¬¢è¿å…³æ³¨åšä¸»çš„å¾®ä¿¡å…¬ä¼—å·:ã€Œ<b>å°å“ˆå­¦Java</b>ã€, å…³æ³¨å³å¯<b>å…è´¹æ— å¥—è·¯é¢†å– 100G å°å“ˆæ•´ç†çš„å„ç§ Java å­¦ä¹ èµ„æ–™</b>å“Ÿï¼Œç¥æ‚¨å­¦ä¹ æ„‰å¿«ï¼</p><h2 id="Java8-å…¶ä»–ç›¸å…³å­¦ä¹ åšæ–‡"><a href="#Java8-å…¶ä»–ç›¸å…³å­¦ä¹ åšæ–‡" class="headerlink" title="Java8 å…¶ä»–ç›¸å…³å­¦ä¹ åšæ–‡"></a>Java8 å…¶ä»–ç›¸å…³å­¦ä¹ åšæ–‡</h2><ul><li><a href="https://www.exception.site/java8/java8-stream-tutorial">Java8 Stream æµæ•™æ•™ç¨‹</a></li><li><a href="http://localhost:8090/java8/java8-avoid-null-check">å¦‚ä½•åœ¨ Java8 ä¸­é£éªšèµ°ä½é¿å¼€ç©ºæŒ‡é’ˆå¼‚å¸¸</a></li><li><a href="https://www.exception.site/java8/java8-concurrency-tutorial-thread-exector">Java8 å¹¶å‘ç¯‡(ä¸€) | çº¿ç¨‹ä¸æ‰§è¡Œå™¨</a></li></ul><h2 id="ç›®å½•ï¼š"><a href="#ç›®å½•ï¼š" class="headerlink" title="ç›®å½•ï¼š"></a>ç›®å½•ï¼š</h2><ul><li><a href="#%E6%8E%A5%E5%8F%A3%E5%86%85%E5%85%81%E8%AE%B8%E6%B7%BB%E5%8A%A0%E9%BB%98%E8%AE%A4%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%96%B9%E6%B3%95">ä¸€ã€æ¥å£å†…å…è®¸æ·»åŠ é»˜è®¤å®ç°çš„æ–¹æ³•</a></li><li><a href="#Lambda-%E8%A1%A8%E8%BE%BE%E5%BC%8F">äºŒã€Lambda è¡¨è¾¾å¼</a></li><li><a href="#%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3-Functional-Interface">ä¸‰ã€å‡½æ•°å¼æ¥å£ Functional Interface</a></li><li><a href="#%E4%BE%BF%E6%8D%B7%E7%9A%84%E5%BC%95%E7%94%A8%E7%B1%BB%E7%9A%84%E6%9E%84%E9%80%A0%E5%99%A8%E5%8F%8A%E6%96%B9%E6%B3%95">å››ã€ä¾¿æ·çš„å¼•ç”¨ç±»çš„æ„é€ å™¨åŠæ–¹æ³•</a></li><li><a href="#Lambda-%E8%AE%BF%E9%97%AE%E5%A4%96%E9%83%A8%E5%8F%98%E9%87%8F%E5%8F%8A%E6%8E%A5%E5%8F%A3%E9%BB%98%E8%AE%A4%E6%96%B9%E6%B3%95">äº”ã€Lambda è®¿é—®å¤–éƒ¨å˜é‡åŠæ¥å£é»˜è®¤æ–¹æ³•</a><ul><li><a href="#%E8%AE%BF%E9%97%AE%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F">5.1 è®¿é—®å±€éƒ¨å˜é‡</a></li><li><a href="#%E8%AE%BF%E9%97%AE%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F%E5%92%8C%E9%9D%99%E6%80%81%E5%8F%98%E9%87%8F">5.2 è®¿é—®æˆå‘˜å˜é‡å’Œé™æ€å˜é‡</a></li><li><a href="#%E8%AE%BF%E9%97%AE%E6%8E%A5%E5%8F%A3%E7%9A%84%E9%BB%98%E8%AE%A4%E6%96%B9%E6%B3%95">5.3 è®¿é—®æ¥å£çš„é»˜è®¤æ–¹æ³•</a></li></ul></li><li><a href="#%E5%86%85%E7%BD%AE%E7%9A%84%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3">å…­ã€å†…ç½®çš„å‡½æ•°å¼æ¥å£</a><ul><li><a href="#Predicate-%E6%96%AD%E8%A8%80">6.1 Predicate æ–­è¨€</a></li><li><a href="#Function">6.2 Function</a></li><li><a href="#Supplier-%E7%94%9F%E4%BA%A7%E8%80%85">6.3 Supplier ç”Ÿäº§è€…</a></li><li><a href="#Consumer-%E6%B6%88%E8%B4%B9%E8%80%85">6.4 Consumer æ¶ˆè´¹è€…</a></li><li><a href="#Comparator">6.5 Comparator</a></li></ul></li><li><a href="#Optional">ä¸ƒã€Optional</a></li><li><a href="#Stream-%E6%B5%81">å…«ã€Streams æµ</a><ul><li><a href="#Filter-%E8%BF%87%E6%BB%A4">8.1 Filter è¿‡æ»¤</a></li><li><a href="#Sorted-%E6%8E%92%E5%BA%8F">8.2 Sorted æ’åº</a></li><li><a href="#Map-%E8%BD%AC%E6%8D%A2">8.3 Map è½¬æ¢</a></li><li><a href="#Match-%E5%8C%B9%E9%85%8D">8.4 Match åŒ¹é…</a></li><li><a href="#Count-%E8%AE%A1%E6%95%B0">8.5 Count è®¡æ•°</a></li><li><a href="#Reduce">8.6 Reduce</a></li></ul></li><li><a href="#Parallel-Streams-%E5%B9%B6%E8%A1%8C%E6%B5%81">ä¹ã€Parallel Streams å¹¶è¡Œæµ</a><ul><li><a href="#%E9%A1%BA%E5%BA%8F%E6%B5%81%E6%8E%92%E5%BA%8F">9.1 é¡ºåºæµæ’åº</a></li><li><a href="#%E5%B9%B6%E8%A1%8C%E6%B5%81%E6%8E%92%E5%BA%8F">9.2 å¹¶è¡Œæµæ’åº</a></li></ul></li><li><a href="#Map-%E9%9B%86%E5%90%88">åã€Map é›†åˆ</a></li><li><a href="#%E6%96%B0%E7%9A%84%E6%97%A5%E6%9C%9F-API">åä¸€ã€æ–°çš„æ—¥æœŸ API</a><ul><li><a href="#Clock">11.1 Clock</a></li><li><a href="#Timezones-%E6%97%B6%E5%8C%BA">11.2 Timezones æ—¶åŒº</a></li><li><a href="#LocalTime">11.3 LocalTime</a></li><li><a href="#LocalDate">11.4 LocalDate</a></li><li><a href="#LocalDateTime">11.4 LocalDateTime</a></li></ul></li><li><a href="#Annotations-%E6%B3%A8%E8%A7%A3">åäºŒã€Annotations æ³¨è§£</a></li></ul><p>ä¹Ÿå¸Œæœ›å­¦å®Œæœ¬ç³»åˆ—æ•™ç¨‹çš„å°ä¼™ä¼´èƒ½å¤Ÿç†Ÿç»ƒæŒæ¡å’Œåº”ç”¨ Java8 çš„å„ç§ç‰¹æ€§ï¼Œä½¿å…¶æˆä¸ºåœ¨å·¥ä½œä¸­çš„ä¸€é—¨åˆ©å™¨ã€‚åºŸè¯ä¸å¤šè¯´ï¼Œè®©æˆ‘ä»¬ä¸€èµ·å¼€å¯ Java8 æ–°ç‰¹æ€§ä¹‹æ—…å§ï¼</p><h2 id="æ¥å£å†…å…è®¸æ·»åŠ é»˜è®¤å®ç°çš„æ–¹æ³•"><a href="#æ¥å£å†…å…è®¸æ·»åŠ é»˜è®¤å®ç°çš„æ–¹æ³•" class="headerlink" title="æ¥å£å†…å…è®¸æ·»åŠ é»˜è®¤å®ç°çš„æ–¹æ³•"></a>æ¥å£å†…å…è®¸æ·»åŠ é»˜è®¤å®ç°çš„æ–¹æ³•</h2><p>Java 8 å…è®¸æˆ‘ä»¬é€šè¿‡ <code>default</code> å…³é”®å­—å¯¹æ¥å£ä¸­å®šä¹‰çš„æŠ½è±¡æ–¹æ³•æä¾›ä¸€ä¸ªé»˜è®¤çš„å®ç°ã€‚</p><p>è¯·çœ‹ä¸‹é¢ç¤ºä¾‹ä»£ç ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// å®šä¹‰ä¸€ä¸ªå…¬å¼æ¥å£</span><span class="token keyword">interface</span> <span class="token class-name">Formula</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// è®¡ç®—</span>    <span class="token keyword">double</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// æ±‚å¹³æ–¹æ ¹</span>    <span class="token keyword">default</span> <span class="token keyword">double</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ä¸Šé¢è¿™ä¸ªæ¥å£ä¸­ï¼Œæˆ‘ä»¬é™¤äº†å®šä¹‰äº†ä¸€ä¸ªæŠ½è±¡æ–¹æ³• <code>calculate</code>ï¼Œè¿˜å®šä¹‰äº†ä¸€ä¸ªå¸¦æœ‰é»˜è®¤å®ç°çš„æ–¹æ³• <code>sqrt</code>ã€‚<br>æˆ‘ä»¬åœ¨å®ç°è¿™ä¸ªæ¥å£æ—¶ï¼Œå¯ä»¥åªéœ€è¦å®ç° <code>calculate</code> æ–¹æ³•ï¼Œé»˜è®¤æ–¹æ³• <code>sqrt</code> å¯ä»¥ç›´æ¥è°ƒç”¨å³å¯ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥ä¸å¿…å¼ºåˆ¶å®ç° <code>sqrt</code> æ–¹æ³•ã€‚</p><blockquote><p>è¡¥å……ï¼šé€šè¿‡ <code>default</code> å…³é”®å­—è¿™ä¸ªæ–°ç‰¹æ€§ï¼Œå¯ä»¥éå¸¸æ–¹ä¾¿åœ°å¯¹ä¹‹å‰çš„æ¥å£åšæ‹“å±•ï¼Œè€Œæ­¤æ¥å£çš„å®ç°ç±»ä¸å¿…åšä»»ä½•æ”¹åŠ¨ã€‚</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Formula</span> formula <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Formula</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>a <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>formula<span class="token punctuation">.</span><span class="token function">calculate</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 100.0</span>formula<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// 4.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šé¢é€šè¿‡åŒ¿åå¯¹è±¡å®ç°äº† <code>Formula</code> æ¥å£ã€‚ä½†æ˜¯å³ä½¿æ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬ä¸ºäº†å®Œæˆä¸€ä¸ª <code>sqrt(a * 100)</code> ç®€å•è®¡ç®—ï¼Œå°±å†™äº† 6 è¡Œä»£ç ï¼Œå¾ˆæ˜¯å†—ä½™ã€‚</p><h2 id="Lambda-è¡¨è¾¾å¼"><a href="#Lambda-è¡¨è¾¾å¼" class="headerlink" title="Lambda è¡¨è¾¾å¼"></a>Lambda è¡¨è¾¾å¼</h2><p>åœ¨å­¦ä¹  <code>Lambda</code> è¡¨è¾¾å¼ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€æ®µè€ç‰ˆæœ¬çš„ç¤ºä¾‹ä»£ç ï¼Œå…¶å¯¹ä¸€ä¸ªå«æœ‰å­—ç¬¦ä¸²çš„é›†åˆè¿›è¡Œæ’åºï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> names <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">"peter"</span><span class="token punctuation">,</span> <span class="token string">"anna"</span><span class="token punctuation">,</span> <span class="token string">"mike"</span><span class="token punctuation">,</span> <span class="token string">"xenia"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compare</span><span class="token punctuation">(</span><span class="token class-name">String</span> a<span class="token punctuation">,</span> <span class="token class-name">String</span> b<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> b<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>Collections</code> å·¥å…·ç±»æä¾›äº†é™æ€æ–¹æ³• <code>sort</code> æ–¹æ³•ï¼Œå…¥å‚æ˜¯ä¸€ä¸ª <code>List</code> é›†åˆï¼Œå’Œä¸€ä¸ª <code>Comparator</code> æ¯”è¾ƒå™¨ï¼Œä»¥ä¾¿å¯¹ç»™å®šçš„ <code>List</code> é›†åˆè¿›è¡Œ<br>æ’åºã€‚ä¸Šé¢çš„ç¤ºä¾‹ä»£ç åˆ›å»ºäº†ä¸€ä¸ªåŒ¿åå†…éƒ¨ç±»ä½œä¸ºå…¥å‚ï¼Œè¿™ç§ç±»ä¼¼çš„æ“ä½œåœ¨æˆ‘ä»¬æ—¥å¸¸çš„å·¥ä½œä¸­éšå¤„å¯è§ã€‚</p><p>Java 8 ä¸­ä¸å†æ¨èè¿™ç§å†™æ³•ï¼Œè€Œæ˜¯æ¨èä½¿ç”¨ Lambda è¡¨è¾¾ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">String</span> a<span class="token punctuation">,</span> <span class="token class-name">String</span> b<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> b<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ­£å¦‚ä½ çœ‹åˆ°çš„ï¼Œä¸Šé¢è¿™æ®µä»£ç å˜å¾—ç®€çŸ­å¾ˆå¤šè€Œä¸”æ˜“äºé˜…è¯»ã€‚ä½†æ˜¯æˆ‘ä»¬è¿˜å¯ä»¥å†ç²¾ç‚¼ä¸€ç‚¹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>names<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">String</span> a<span class="token punctuation">,</span> <span class="token class-name">String</span> b<span class="token punctuation">)</span> <span class="token operator">-></span> b<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯¹äºåªåŒ…å«ä¸€è¡Œæ–¹æ³•çš„ä»£ç å—ï¼Œæˆ‘ä»¬å¯ä»¥çœç•¥å¤§æ‹¬å·ï¼Œç›´æ¥ <code>return</code> å…³é”®ä»£ç å³å¯ã€‚è¿½æ±‚æè‡´ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è®©å®ƒå†çŸ­ç‚¹ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">names<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-></span> b<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>List</code> é›†åˆç°åœ¨å·²ç»æ·»åŠ äº† <code>sort</code> æ–¹æ³•ã€‚è€Œä¸” Java ç¼–è¯‘å™¨èƒ½å¤Ÿæ ¹æ®<strong>ç±»å‹æ¨æ–­æœºåˆ¶</strong>åˆ¤æ–­å‡ºå‚æ•°ç±»å‹ï¼Œè¿™æ ·ï¼Œä½ è¿å…¥å‚çš„ç±»å‹éƒ½å¯ä»¥çœç•¥å•¦ï¼Œæ€ä¹ˆæ ·ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰å¾ˆå¼ºå¤§å‘¢ï¼</p><h2 id="å‡½æ•°å¼æ¥å£-Functional-Interface"><a href="#å‡½æ•°å¼æ¥å£-Functional-Interface" class="headerlink" title="å‡½æ•°å¼æ¥å£ Functional Interface"></a>å‡½æ•°å¼æ¥å£ Functional Interface</h2><p>æŠ›å‡ºä¸€ä¸ªç–‘é—®ï¼šåœ¨æˆ‘ä»¬ä¹¦å†™ä¸€æ®µ Lambda è¡¨è¾¾å¼åï¼ˆæ¯”å¦‚ä¸Šä¸€ç« èŠ‚ä¸­åŒ¿åå†…éƒ¨ç±»çš„ Lambda è¡¨è¾¾å¼ç¼©å†™å½¢å¼ï¼‰ï¼ŒJava ç¼–è¯‘å™¨æ˜¯å¦‚ä½•è¿›è¡Œç±»å‹æ¨æ–­çš„ï¼Œå®ƒåˆæ˜¯æ€ä¹ˆçŸ¥é“é‡å†™çš„å“ªä¸ªæ–¹æ³•çš„ï¼Ÿ</p><p>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œä¸æ˜¯æ¯ä¸ªæ¥å£éƒ½å¯ä»¥ç¼©å†™æˆ Lambda è¡¨è¾¾å¼ã€‚åªæœ‰é‚£äº›å‡½æ•°å¼æ¥å£ï¼ˆFunctional Interfaceï¼‰æ‰èƒ½ç¼©å†™æˆ Lambda è¡¨ç¤ºå¼ã€‚</p><p>é‚£ä¹ˆä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£ï¼ˆFunctional Interfaceï¼‰å‘¢ï¼Ÿ</p><p>æ‰€è°“å‡½æ•°å¼æ¥å£ï¼ˆFunctional Interfaceï¼‰å°±æ˜¯åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„å£°æ˜ã€‚é’ˆå¯¹è¯¥æ¥å£ç±»å‹çš„æ‰€æœ‰ Lambda è¡¨è¾¾å¼éƒ½ä¼šä¸è¿™ä¸ªæŠ½è±¡æ–¹æ³•åŒ¹é…ã€‚</p><blockquote><p>æ³¨æ„ï¼šä½ å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼ŒJava 8 ä¸­ä¸æ˜¯å…è®¸é€šè¿‡ defualt å…³é”®å­—æ¥ä¸ºæ¥å£æ·»åŠ é»˜è®¤æ–¹æ³•å—ï¼Ÿé‚£å®ƒç®—ä¸ç®—æŠ½è±¡æ–¹æ³•å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼šä¸ç®—ã€‚å› æ­¤ï¼Œä½ å¯ä»¥æ¯«æ— é¡¾å¿Œçš„æ·»åŠ é»˜è®¤æ–¹æ³•ï¼Œå®ƒå¹¶ä¸è¿åå‡½æ•°å¼æ¥å£ï¼ˆFunctional Interfaceï¼‰çš„å®šä¹‰ã€‚</p></blockquote><p>æ€»ç»“ä¸€ä¸‹ï¼šåªè¦æ¥å£ä¸­ä»…ä»…åŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å…¶æ”¹å†™ä¸º Lambda è¡¨è¾¾å¼ã€‚ä¸ºäº†ä¿è¯ä¸€ä¸ªæ¥å£æ˜ç¡®çš„è¢«å®šä¹‰ä¸ºä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼ˆFunctional Interfaceï¼‰ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºè¯¥æ¥å£æ·»åŠ æ³¨è§£ï¼š<code>@FunctionalInterface</code>ã€‚è¿™æ ·ï¼Œä¸€æ—¦ä½ æ·»åŠ äº†ç¬¬äºŒä¸ªæŠ½è±¡æ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šç«‹åˆ»æŠ›å‡ºé”™è¯¯æç¤ºã€‚</p><p>ç¤ºä¾‹ä»£ç ï¼š</p><pre><code>@FunctionalInterfaceinterface Converter&lt;F, T&gt; &#123;    T convert(F from);&#125;</code></pre><p>ç¤ºä¾‹ä»£ç 2ï¼š</p><pre><code>Converter&lt;String, Integer&gt; converter = (from) -&gt; Integer.valueOf(from);Integer converted = converter.convert(&quot;123&quot;);System.out.println(converted);    // 123</code></pre><blockquote><p>æ³¨æ„ï¼šä¸Šé¢çš„ç¤ºä¾‹ä»£ç ï¼Œå³ä½¿å»æ‰ <code>@FunctionalInterface</code> ä¹Ÿæ˜¯å¥½ä½¿çš„ï¼Œå®ƒä»…ä»…æ˜¯ä¸€ç§çº¦æŸè€Œå·²ã€‚</p></blockquote><h2 id="ä¾¿æ·çš„å¼•ç”¨ç±»çš„æ„é€ å™¨åŠæ–¹æ³•"><a href="#ä¾¿æ·çš„å¼•ç”¨ç±»çš„æ„é€ å™¨åŠæ–¹æ³•" class="headerlink" title="ä¾¿æ·çš„å¼•ç”¨ç±»çš„æ„é€ å™¨åŠæ–¹æ³•"></a>ä¾¿æ·çš„å¼•ç”¨ç±»çš„æ„é€ å™¨åŠæ–¹æ³•</h2><p>å°ä¼™ä¼´ä»¬ï¼Œè¿˜è®°å¾—ä¸Šä¸€ä¸ªç« èŠ‚è¿™æ®µç¤ºä¾‹ä»£ç ä¹ˆï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@FunctionalInterface</span><span class="token keyword">interface</span> <span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">F</span><span class="token punctuation">,</span> <span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>    <span class="token class-name">T</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token class-name">F</span> from<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> converter <span class="token operator">=</span> <span class="token punctuation">(</span>from<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Integer</span> converted <span class="token operator">=</span> converter<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>converted<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 123</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä¸Šé¢è¿™æ®µä»£ç ï¼Œé€šè¿‡ Java 8 çš„æ–°ç‰¹æ€§ï¼Œè¿›ä¸€æ­¥ç®€åŒ–ä¸Šé¢çš„ä»£ç ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> converter <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token operator">::</span><span class="token function">valueOf</span><span class="token punctuation">;</span><span class="token class-name">Integer</span> converted <span class="token operator">=</span> converter<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>converted<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 123</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>Java 8 ä¸­å…è®¸ä½ é€šè¿‡ <code>::</code> å…³é”®å­—æ¥å¼•ç”¨ç±»çš„æ–¹æ³•æˆ–æ„é€ å™¨ã€‚ä¸Šé¢çš„ä»£ç ç®€å•çš„ç¤ºä¾‹äº†å¦‚ä½•å¼•ç”¨é™æ€æ–¹æ³•ï¼Œå½“ç„¶ï¼Œé™¤äº†é™æ€æ–¹æ³•ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å¼•ç”¨æ™®é€šæ–¹æ³•ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Something</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> <span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Something</span> something <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Something</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> converter <span class="token operator">=</span> something<span class="token operator">::</span><span class="token function">startsWith</span><span class="token punctuation">;</span><span class="token class-name">String</span> converted <span class="token operator">=</span> converter<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span><span class="token string">"Java"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>converted<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// "J"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹å¦‚ä½•é€šè¿‡ <code>::</code> å…³é”®å­—æ¥å¼•ç”¨ç±»çš„æ„é€ å™¨ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥å®šä¹‰ä¸€ä¸ªç¤ºä¾‹ç±»ï¼Œåœ¨ç±»ä¸­å£°æ˜ä¸¤ä¸ªæ„é€ å™¨ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> firstName<span class="token punctuation">;</span>    <span class="token class-name">String</span> lastName<span class="token punctuation">;</span>    <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> firstName<span class="token punctuation">,</span> <span class="token class-name">String</span> lastName<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">=</span> firstName<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>lastName <span class="token operator">=</span> lastName<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åï¼Œæˆ‘ä»¬å†å®šä¹‰ä¸€ä¸ªå·¥å‚æ¥å£ï¼Œç”¨æ¥ç”Ÿæˆ <code>Person</code> ç±»ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// Person å·¥å‚</span><span class="token keyword">interface</span> <span class="token class-name">PersonFactory</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">P</span> <span class="token keyword">extends</span> <span class="token class-name">Person</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>    <span class="token class-name">P</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">String</span> firstName<span class="token punctuation">,</span> <span class="token class-name">String</span> lastName<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>::</code> å…³é”®å­—æ¥å¼•ç”¨ <code>Person</code> ç±»çš„æ„é€ å™¨ï¼Œæ¥ä»£æ›¿æ‰‹åŠ¨å»å®ç°è¿™ä¸ªå·¥å‚æ¥å£ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// ç›´æ¥å¼•ç”¨ Person æ„é€ å™¨</span><span class="token class-name">PersonFactory</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">></span></span> personFactory <span class="token operator">=</span> <span class="token class-name">Person</span><span class="token operator">::</span><span class="token keyword">new</span><span class="token punctuation">;</span><span class="token class-name">Person</span> person <span class="token operator">=</span> personFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">"Peter"</span><span class="token punctuation">,</span> <span class="token string">"Parker"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><code>Person::new</code> è¿™æ®µä»£ç ï¼Œèƒ½å¤Ÿç›´æ¥å¼•ç”¨ <code>Person</code> ç±»çš„æ„é€ å™¨ã€‚ç„¶å Java ç¼–è¯‘å™¨èƒ½å¤Ÿæ ¹æ®ä¸Šä¸‹æ–‡é€‰ä¸­æ­£ç¡®çš„æ„é€ å™¨å»å®ç° <code>PersonFactory.create</code> æ–¹æ³•ã€‚</p><h2 id="Lambda-è®¿é—®å¤–éƒ¨å˜é‡åŠæ¥å£é»˜è®¤æ–¹æ³•"><a href="#Lambda-è®¿é—®å¤–éƒ¨å˜é‡åŠæ¥å£é»˜è®¤æ–¹æ³•" class="headerlink" title="Lambda è®¿é—®å¤–éƒ¨å˜é‡åŠæ¥å£é»˜è®¤æ–¹æ³•"></a>Lambda è®¿é—®å¤–éƒ¨å˜é‡åŠæ¥å£é»˜è®¤æ–¹æ³•</h2><p>åœ¨æœ¬ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šè®¨è®ºå¦‚ä½•åœ¨ lambda è¡¨è¾¾å¼ä¸­è®¿é—®å¤–éƒ¨å˜é‡ï¼ˆåŒ…æ‹¬ï¼šå±€éƒ¨å˜é‡ï¼Œæˆå‘˜å˜é‡ï¼Œé™æ€å˜é‡ï¼Œæ¥å£çš„é»˜è®¤æ–¹æ³•.ï¼‰ï¼Œå®ƒä¸åŒ¿åå†…éƒ¨ç±»è®¿é—®å¤–éƒ¨å˜é‡å¾ˆç›¸ä¼¼ã€‚</p><h3 id="è®¿é—®å±€éƒ¨å˜é‡"><a href="#è®¿é—®å±€éƒ¨å˜é‡" class="headerlink" title="è®¿é—®å±€éƒ¨å˜é‡"></a>è®¿é—®å±€éƒ¨å˜é‡</h3><p>åœ¨ Lambda è¡¨è¾¾å¼ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®å¤–éƒ¨çš„ <code>final</code> ç±»å‹å˜é‡ï¼Œå¦‚ä¸‹é¢çš„ç¤ºä¾‹ä»£ç ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// è½¬æ¢å™¨</span><span class="token annotation punctuation">@FunctionalInterface</span><span class="token keyword">interface</span> <span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">F</span><span class="token punctuation">,</span> <span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>    <span class="token class-name">T</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token class-name">F</span> from<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">final</span> <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> stringConverter <span class="token operator">=</span>        <span class="token punctuation">(</span>from<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>from <span class="token operator">+</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>stringConverter<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸åŒ¿åå†…éƒ¨ç±»ä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬ä¸å¿…æ˜¾å¼å£°æ˜ <code>num</code> å˜é‡ä¸º <code>final</code> ç±»å‹ï¼Œä¸‹é¢è¿™æ®µä»£ç åŒæ ·æœ‰æ•ˆï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> stringConverter <span class="token operator">=</span>        <span class="token punctuation">(</span>from<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>from <span class="token operator">+</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>stringConverter<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯ <code>num</code> å˜é‡å¿…é¡»ä¸ºéšå¼çš„ <code>final</code> ç±»å‹ï¼Œä½•ä¸ºéšå¼çš„ <code>final</code> å‘¢ï¼Ÿå°±æ˜¯è¯´åˆ°ç¼–è¯‘æœŸä¸ºæ­¢ï¼Œ<code>num</code> å¯¹è±¡æ˜¯ä¸èƒ½è¢«æ”¹å˜çš„ï¼Œå¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼Œå°±ä¸èƒ½è¢«ç¼–è¯‘é€šè¿‡ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> stringConverter <span class="token operator">=</span>        <span class="token punctuation">(</span>from<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>from <span class="token operator">+</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>num <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ lambda è¡¨è¾¾å¼å†…éƒ¨æ”¹å˜ <code>num</code> å€¼åŒæ ·ç¼–è¯‘ä¸é€šè¿‡ï¼Œéœ€è¦æ³¨æ„, æ¯”å¦‚ä¸‹é¢çš„ç¤ºä¾‹ä»£ç ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> converter <span class="token operator">=</span> <span class="token punctuation">(</span>from<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span><span class="token class-name">String</span> value <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>from <span class="token operator">+</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>num <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span><span class="token keyword">return</span> value<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è®¿é—®æˆå‘˜å˜é‡å’Œé™æ€å˜é‡"><a href="#è®¿é—®æˆå‘˜å˜é‡å’Œé™æ€å˜é‡" class="headerlink" title="è®¿é—®æˆå‘˜å˜é‡å’Œé™æ€å˜é‡"></a>è®¿é—®æˆå‘˜å˜é‡å’Œé™æ€å˜é‡</h3><p>ä¸Šä¸€ç« èŠ‚ä¸­ï¼Œäº†è§£äº†å¦‚ä½•åœ¨ Lambda è¡¨è¾¾å¼ä¸­è®¿é—®å±€éƒ¨å˜é‡ã€‚ä¸å±€éƒ¨å˜é‡ç›¸æ¯”ï¼Œåœ¨ Lambda è¡¨è¾¾å¼ä¸­å¯¹æˆå‘˜å˜é‡å’Œé™æ€å˜é‡æ‹¥æœ‰è¯»å†™æƒé™ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@FunctionalInterface</span><span class="token keyword">interface</span> <span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">F</span><span class="token punctuation">,</span> <span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>    <span class="token class-name">T</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token class-name">F</span> from<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Lambda4</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// é™æ€å˜é‡</span>        <span class="token keyword">static</span> <span class="token keyword">int</span> outerStaticNum<span class="token punctuation">;</span>        <span class="token comment">// æˆå‘˜å˜é‡</span>        <span class="token keyword">int</span> outerNum<span class="token punctuation">;</span>        <span class="token keyword">void</span> <span class="token function">testScopes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> stringConverter1 <span class="token operator">=</span> <span class="token punctuation">(</span>from<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>                <span class="token comment">// å¯¹æˆå‘˜å˜é‡èµ‹å€¼</span>                outerNum <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>            <span class="token class-name">Converter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> stringConverter2 <span class="token operator">=</span> <span class="token punctuation">(</span>from<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>                <span class="token comment">// å¯¹é™æ€å˜é‡èµ‹å€¼</span>                outerStaticNum <span class="token operator">=</span> <span class="token number">72</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è®¿é—®æ¥å£çš„é»˜è®¤æ–¹æ³•"><a href="#è®¿é—®æ¥å£çš„é»˜è®¤æ–¹æ³•" class="headerlink" title="è®¿é—®æ¥å£çš„é»˜è®¤æ–¹æ³•"></a>è®¿é—®æ¥å£çš„é»˜è®¤æ–¹æ³•</h3><p>è¿˜è®°å¾—ç¬¬ä¸€ç« èŠ‚ä¸­å®šä¹‰çš„é‚£ä¸ª <code>Formula</code> (å…¬å¼) æ¥å£å—ï¼Ÿ</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@FunctionalInterface</span><span class="token keyword">interface</span> <span class="token class-name">Formula</span> <span class="token punctuation">&#123;</span><span class="token comment">// è®¡ç®—</span><span class="token keyword">double</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æ±‚å¹³æ–¹æ ¹</span><span class="token keyword">default</span> <span class="token keyword">double</span> <span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“æ—¶ï¼Œæˆ‘ä»¬åœ¨æ¥å£ä¸­å®šä¹‰äº†ä¸€ä¸ªå¸¦æœ‰é»˜è®¤å®ç°çš„ <code>sqrt</code> æ±‚å¹³æ–¹æ ¹æ–¹æ³•ï¼Œåœ¨åŒ¿åå†…éƒ¨ç±»ä¸­æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„è®¿é—®æ­¤æ–¹æ³•ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Formula</span> formula <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Formula</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token function">sqrt</span><span class="token punctuation">(</span>a <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯åœ¨ lambda è¡¨è¾¾å¼ä¸­å¯ä¸è¡Œï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Formula</span> formula <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token function">sqrt</span><span class="token punctuation">(</span>a <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¸¦æœ‰é»˜è®¤å®ç°çš„æ¥å£æ–¹æ³•ï¼Œæ˜¯<strong>ä¸èƒ½</strong>åœ¨ lambda è¡¨è¾¾å¼ä¸­è®¿é—®çš„ï¼Œä¸Šé¢è¿™æ®µä»£ç å°†æ— æ³•è¢«ç¼–è¯‘é€šè¿‡ã€‚</p><h2 id="å†…ç½®çš„å‡½æ•°å¼æ¥å£"><a href="#å†…ç½®çš„å‡½æ•°å¼æ¥å£" class="headerlink" title="å†…ç½®çš„å‡½æ•°å¼æ¥å£"></a>å†…ç½®çš„å‡½æ•°å¼æ¥å£</h2><p>JDK 1.8 API åŒ…å«äº†å¾ˆå¤šå†…ç½®çš„å‡½æ•°å¼æ¥å£ã€‚å…¶ä¸­å°±åŒ…æ‹¬æˆ‘ä»¬åœ¨è€ç‰ˆæœ¬ä¸­ç»å¸¸è§åˆ°çš„ Comparator å’Œ Runnableï¼ŒJava 8 ä¸ºä»–ä»¬éƒ½æ·»åŠ äº† @FunctionalInterface æ³¨è§£ï¼Œä»¥ç”¨æ¥æ”¯æŒ Lambda è¡¨è¾¾å¼ã€‚</p><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œé™¤äº† Comparator å’Œ Runnable å¤–ï¼Œè¿˜æœ‰ä¸€äº›æ–°çš„å‡½æ•°å¼æ¥å£ï¼Œå®ƒä»¬å¾ˆå¤šéƒ½å€Ÿé‰´äºçŸ¥åçš„ <a href="https://github.com/google/guava">Google Guava</a> åº“ã€‚</p><p>å¯¹äºå®ƒä»¬ï¼Œå³ä½¿ä½ å·²ç»éå¸¸ç†Ÿæ‚‰äº†ï¼Œè¿˜æ˜¯æœ€å¥½äº†è§£ä¸€ä¸‹çš„ï¼š</p><h3 id="Predicate-æ–­è¨€"><a href="#Predicate-æ–­è¨€" class="headerlink" title="Predicate æ–­è¨€"></a>Predicate æ–­è¨€</h3><p><code>Predicate</code> æ˜¯ä¸€ä¸ªå¯ä»¥æŒ‡å®šå…¥å‚ç±»å‹ï¼Œå¹¶è¿”å› boolean å€¼çš„å‡½æ•°å¼æ¥å£ã€‚å®ƒå†…éƒ¨æä¾›äº†ä¸€äº›å¸¦æœ‰é»˜è®¤å®ç°çš„æ–¹æ³•ï¼Œå¯ä»¥<br>è¢«ç”¨æ¥ç»„åˆä¸€ä¸ªå¤æ‚çš„é€»è¾‘åˆ¤æ–­ï¼ˆ<code>and</code>, <code>or</code>, <code>negate</code>ï¼‰ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> predicate <span class="token operator">=</span> <span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-></span> s<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span>predicate<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">"foo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">// true</span>predicate<span class="token punctuation">.</span><span class="token function">negate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token string">"foo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// false</span><span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Boolean</span><span class="token punctuation">></span></span> nonNull <span class="token operator">=</span> <span class="token class-name">Objects</span><span class="token operator">::</span><span class="token function">nonNull</span><span class="token punctuation">;</span><span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Boolean</span><span class="token punctuation">></span></span> isNull <span class="token operator">=</span> <span class="token class-name">Objects</span><span class="token operator">::</span><span class="token function">isNull</span><span class="token punctuation">;</span><span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> isEmpty <span class="token operator">=</span> <span class="token class-name">String</span><span class="token operator">::</span><span class="token function">isEmpty</span><span class="token punctuation">;</span><span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> isNotEmpty <span class="token operator">=</span> isEmpty<span class="token punctuation">.</span><span class="token function">negate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Function"><a href="#Function" class="headerlink" title="Function"></a>Function</h3><p><code>Function</code> å‡½æ•°å¼æ¥å£çš„ä½œç”¨æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºå…¶æä¾›ä¸€ä¸ªåŸæ–™ï¼Œä»–ç»™ç”Ÿäº§ä¸€ä¸ªæœ€ç»ˆçš„äº§å“ã€‚é€šè¿‡å®ƒæä¾›çš„é»˜è®¤æ–¹æ³•ï¼Œç»„åˆ,é“¾è¡Œå¤„ç†(<code>compose</code>, <code>andThen</code>)ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">></span></span> toInteger <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token operator">::</span><span class="token function">valueOf</span><span class="token punctuation">;</span><span class="token class-name">Function</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> backToString <span class="token operator">=</span> toInteger<span class="token punctuation">.</span><span class="token function">andThen</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token operator">::</span><span class="token function">valueOf</span><span class="token punctuation">)</span><span class="token punctuation">;</span>backToString<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// "123"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Supplier-ç”Ÿäº§è€…"><a href="#Supplier-ç”Ÿäº§è€…" class="headerlink" title="Supplier ç”Ÿäº§è€…"></a>Supplier ç”Ÿäº§è€…</h3><p><code>Supplier</code> ä¸ <code>Function</code> ä¸åŒï¼Œå®ƒä¸æ¥å—å…¥å‚ï¼Œç›´æ¥ä¸ºæˆ‘ä»¬ç”Ÿäº§ä¸€ä¸ªæŒ‡å®šçš„ç»“æœï¼Œæœ‰ç‚¹åƒç”Ÿäº§è€…æ¨¡å¼ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> firstName<span class="token punctuation">;</span>    <span class="token class-name">String</span> lastName<span class="token punctuation">;</span>    <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> firstName<span class="token punctuation">,</span> <span class="token class-name">String</span> lastName<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">=</span> firstName<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>lastName <span class="token operator">=</span> lastName<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">></span></span> personSupplier <span class="token operator">=</span> <span class="token class-name">Person</span><span class="token operator">::</span><span class="token keyword">new</span><span class="token punctuation">;</span>personSupplier<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// new Person</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="Consumer-æ¶ˆè´¹è€…"><a href="#Consumer-æ¶ˆè´¹è€…" class="headerlink" title="Consumer æ¶ˆè´¹è€…"></a>Consumer æ¶ˆè´¹è€…</h3><p>å¯¹äº <code>Consumer</code>ï¼Œæˆ‘ä»¬éœ€è¦æä¾›å…¥å‚ï¼Œç”¨æ¥è¢«æ¶ˆè´¹ï¼Œå¦‚ä¸‹é¢è¿™æ®µç¤ºä¾‹ä»£ç ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> firstName<span class="token punctuation">;</span>    <span class="token class-name">String</span> lastName<span class="token punctuation">;</span>    <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> firstName<span class="token punctuation">,</span> <span class="token class-name">String</span> lastName<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">=</span> firstName<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>lastName <span class="token operator">=</span> lastName<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">></span></span> greeter <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Hello, "</span> <span class="token operator">+</span> p<span class="token punctuation">.</span>firstName<span class="token punctuation">)</span><span class="token punctuation">;</span>greeter<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Luke"</span><span class="token punctuation">,</span> <span class="token string">"Skywalker"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="Comparator"><a href="#Comparator" class="headerlink" title="Comparator"></a>Comparator</h3><p><code>Comparator</code> åœ¨ Java 8 ä¹‹å‰æ˜¯ä½¿ç”¨æ¯”è¾ƒæ™®éçš„ã€‚Java 8 ä¸­é™¤äº†å°†å…¶å‡çº§æˆäº†å‡½æ•°å¼æ¥å£ï¼Œè¿˜ä¸ºå®ƒæ‹“å±•äº†ä¸€äº›é»˜è®¤æ–¹æ³•ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Comparator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">></span></span> comparator <span class="token operator">=</span> <span class="token punctuation">(</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">)</span> <span class="token operator">-></span> p1<span class="token punctuation">.</span>firstName<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>firstName<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Person</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"John"</span><span class="token punctuation">,</span> <span class="token string">"Doe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Person</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Alice"</span><span class="token punctuation">,</span> <span class="token string">"Wonderland"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>comparator<span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">// > 0</span>comparator<span class="token punctuation">.</span><span class="token function">reversed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// &lt; 0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Optional"><a href="#Optional" class="headerlink" title="Optional"></a>Optional</h2><p>é¦–å…ˆï¼Œ<code>Optional</code> å®ƒä¸æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œè®¾è®¡å®ƒçš„ç›®çš„æ˜¯ä¸ºäº†é˜²æ­¢ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼ˆ<code>NullPointerException</code>ï¼‰ï¼Œè¦çŸ¥é“åœ¨ Java ç¼–ç¨‹ä¸­ï¼Œ<br>ç©ºæŒ‡é’ˆå¼‚å¸¸å¯æ˜¯è‡­åæ˜­è‘—çš„ã€‚</p><p>è®©æˆ‘ä»¬æ¥å¿«é€Ÿäº†è§£ä¸€ä¸‹ <code>Optional</code> è¦å¦‚ä½•ä½¿ç”¨ï¼ä½ å¯ä»¥å°† <code>Optional</code> çœ‹åšæ˜¯åŒ…è£…å¯¹è±¡ï¼ˆå¯èƒ½æ˜¯ <code>null</code>, ä¹Ÿæœ‰å¯èƒ½é <code>null</code>ï¼‰çš„å®¹å™¨ã€‚å½“ä½ å®šä¹‰äº†<br>ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›çš„å¯¹è±¡å¯èƒ½æ˜¯ç©ºï¼Œä¹Ÿæœ‰å¯èƒ½éç©ºçš„æ—¶å€™ï¼Œä½ å°±å¯ä»¥è€ƒè™‘ç”¨ <code>Optional</code> æ¥åŒ…è£…å®ƒï¼Œè¿™ä¹Ÿæ˜¯åœ¨ Java 8 è¢«æ¨èä½¿ç”¨çš„åšæ³•ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> optional <span class="token operator">=</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">"bam"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>optional<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token comment">// true</span>optional<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">// "bam"</span>optional<span class="token punctuation">.</span><span class="token function">orElse</span><span class="token punctuation">(</span><span class="token string">"fallback"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// "bam"</span>optional<span class="token punctuation">.</span><span class="token function">ifPresent</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// "b"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Stream-æµ"><a href="#Stream-æµ" class="headerlink" title="Stream æµ"></a>Stream æµ</h2><p>è¿™ä¸€ç« èŠ‚ï¼Œæˆ‘ä»¬å¼€å§‹æ­¥å…¥å­¦ä¹  <code>Stream</code> æµã€‚</p><p><em>ä»€ä¹ˆæ˜¯ <code>Stream</code> æµï¼Ÿ</em></p><p>ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>java.util.Stream</code> å¯¹ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ çš„é›†åˆåšå„ç§æ“ä½œã€‚è¿™äº›æ“ä½œå¯èƒ½æ˜¯ <em>ä¸­é—´æ“ä½œ</em> äº¦æˆ–æ˜¯ _ç»ˆç«¯æ“ä½œ_ã€‚<br>ç»ˆç«¯æ“ä½œä¼šè¿”å›ä¸€ä¸ªç»“æœï¼Œè€Œä¸­é—´æ“ä½œä¼šè¿”å›ä¸€ä¸ª <code>Stream</code> æµã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½ åªèƒ½å¯¹å®ç°äº† <code>java.util.Collection</code> æ¥å£çš„ç±»åšæµçš„æ“ä½œã€‚</p><blockquote><p><code>Map</code> ä¸æ”¯æŒ <code>Stream</code> æµã€‚</p></blockquote><p><code>Stream</code> æµæ”¯æŒåŒæ­¥æ‰§è¡Œï¼Œä¹Ÿæ”¯æŒå¹¶å‘æ‰§è¡Œã€‚ </p><p>è®©æˆ‘ä»¬å¼€å§‹æ­¥å…¥å­¦ä¹ çš„æ—…ç¨‹å§ï¼Go !</p><h3 id="Filter-è¿‡æ»¤"><a href="#Filter-è¿‡æ»¤" class="headerlink" title="Filter è¿‡æ»¤"></a>Filter è¿‡æ»¤</h3><p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª <code>List</code> é›†åˆï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> stringCollection <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"ddd2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"aaa2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"bbb1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"aaa1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"bbb3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"ccc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"bbb2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>stringCollection<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"ddd1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>Filter</code> çš„å…¥å‚æ˜¯ä¸€ä¸ª <code>Predicate</code>, ä¸Šé¢å·²ç»è¯´åˆ°ï¼Œ<code>Predicate</code> æ˜¯ä¸€ä¸ªæ–­è¨€çš„ä¸­é—´æ“ä½œï¼Œå®ƒèƒ½å¤Ÿå¸®æˆ‘ä»¬ç­›é€‰å‡ºæˆ‘ä»¬éœ€è¦çš„é›†åˆå…ƒç´ ã€‚å®ƒçš„è¿”å‚åŒæ ·<br>æ˜¯ä¸€ä¸ª <code>Stream</code> æµï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>foreach</code> ç»ˆç«¯æ“ä½œï¼Œæ¥æ‰“å°è¢«ç­›é€‰çš„å…ƒç´ ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">stringCollection    <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-></span> s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// "aaa2", "aaa1"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ³¨æ„ï¼š<code>foreach</code> æ˜¯ä¸€ä¸ªç»ˆç«¯æ“ä½œï¼Œå®ƒçš„è¿”å‚æ˜¯ <code>void</code>, æˆ‘ä»¬æ— æ³•å¯¹å…¶å†æ¬¡è¿›è¡Œæµæ“ä½œã€‚</p></blockquote><h3 id="Sorted-æ’åº"><a href="#Sorted-æ’åº" class="headerlink" title="Sorted æ’åº"></a>Sorted æ’åº</h3><p><code>Sorted</code> åŒæ ·æ˜¯ä¸€ä¸ªä¸­é—´æ“ä½œï¼Œå®ƒçš„è¿”å‚æ˜¯ä¸€ä¸ª <code>Stream</code> æµã€‚å¦å¤–ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥ä¸€ä¸ª <code>Comparator</code> ç”¨æ¥è‡ªå®šä¹‰æ’åºï¼Œå¦‚æœä¸ä¼ ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„æ’åºè§„åˆ™ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">stringCollection    <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-></span> s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// "aaa1", "aaa2"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>éœ€è¦æ³¨æ„ï¼Œ<code>sorted</code> ä¸ä¼šå¯¹ <code>stringCollection</code> åšå‡ºä»»ä½•æ”¹å˜ï¼Œ<code>stringCollection</code> è¿˜æ˜¯åŸæœ‰çš„é‚£äº›ä¸ªå…ƒç´ ï¼Œä¸”é¡ºåºä¸å˜ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>stringCollection<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ddd2, aaa2, bbb1, aaa1, bbb3, ccc, bbb2, ddd1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="Map-è½¬æ¢"><a href="#Map-è½¬æ¢" class="headerlink" title="Map è½¬æ¢"></a>Map è½¬æ¢</h3><p>ä¸­é—´æ“ä½œ <code>Map</code> èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å°† <code>List</code> ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ åšåŠŸèƒ½å¤„ç†ã€‚ä¾‹å¦‚ä¸‹é¢çš„ç¤ºä¾‹ï¼Œé€šè¿‡ <code>map</code> æˆ‘ä»¬å°†æ¯ä¸€ä¸ª <code>string</code> è½¬æˆå¤§å†™ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">stringCollection    <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token operator">::</span><span class="token function">toUpperCase</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">-></span> b<span class="token punctuation">.</span><span class="token function">compareTo</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// "DDD2", "DDD1", "CCC", "BBB3", "BBB2", "AAA2", "AAA1"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åšå¯¹è±¡ä¹‹é—´çš„è½¬æ¢ï¼Œä¸šåŠ¡ä¸­æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯å°† <code>DO</code>ï¼ˆæ•°æ®åº“å¯¹è±¡ï¼‰ è½¬æ¢æˆ <code>BO</code>ï¼ˆä¸šåŠ¡å¯¹è±¡ï¼‰ ã€‚</p><h3 id="Match-åŒ¹é…"><a href="#Match-åŒ¹é…" class="headerlink" title="Match åŒ¹é…"></a>Match åŒ¹é…</h3><p>é¡¾åæ€ä¹‰ï¼Œ<code>match</code> ç”¨æ¥åšåŒ¹é…æ“ä½œï¼Œå®ƒçš„è¿”å›å€¼æ˜¯ä¸€ä¸ª <code>boolean</code> ç±»å‹ã€‚é€šè¿‡ <code>match</code>, æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿çš„éªŒè¯ä¸€ä¸ª <code>list</code> ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªç±»å‹çš„å…ƒç´ ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// éªŒè¯ list ä¸­ string æ˜¯å¦æœ‰ä»¥ a å¼€å¤´çš„, åŒ¹é…åˆ°ç¬¬ä¸€ä¸ªï¼Œå³è¿”å› true</span><span class="token keyword">boolean</span> anyStartsWithA <span class="token operator">=</span>    stringCollection        <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">anyMatch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-></span> s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>anyStartsWithA<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// true</span><span class="token comment">// éªŒè¯ list ä¸­ string æ˜¯å¦éƒ½æ˜¯ä»¥ a å¼€å¤´çš„</span><span class="token keyword">boolean</span> allStartsWithA <span class="token operator">=</span>    stringCollection        <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">allMatch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-></span> s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>allStartsWithA<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// false</span><span class="token comment">// éªŒè¯ list ä¸­ string æ˜¯å¦éƒ½ä¸æ˜¯ä»¥ z å¼€å¤´çš„,</span><span class="token keyword">boolean</span> noneStartsWithZ <span class="token operator">=</span>    stringCollection        <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">noneMatch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-></span> s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"z"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>noneStartsWithZ<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Count-è®¡æ•°"><a href="#Count-è®¡æ•°" class="headerlink" title="Count è®¡æ•°"></a>Count è®¡æ•°</h3><p><code>count</code> æ˜¯ä¸€ä¸ªç»ˆç«¯æ“ä½œï¼Œå®ƒèƒ½å¤Ÿç»Ÿè®¡ <code>stream</code> æµä¸­çš„å…ƒç´ æ€»æ•°ï¼Œè¿”å›å€¼æ˜¯ <code>long</code> ç±»å‹ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// å…ˆå¯¹ list ä¸­å­—ç¬¦ä¸²å¼€å¤´ä¸º b è¿›è¡Œè¿‡æ»¤ï¼Œè®©åç»Ÿè®¡æ•°é‡</span><span class="token keyword">long</span> startsWithB <span class="token operator">=</span>    stringCollection        <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">-></span> s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">"b"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>startsWithB<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Reduce"><a href="#Reduce" class="headerlink" title="Reduce"></a>Reduce</h3><p><code>Reduce</code> ä¸­æ–‡ç¿»è¯‘ä¸ºï¼š_å‡å°‘ã€ç¼©å°_ã€‚é€šè¿‡å…¥å‚çš„ <code>Function</code>ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå°† <code>list</code> å½’çº¦æˆä¸€ä¸ªå€¼ã€‚å®ƒçš„è¿”å›ç±»å‹æ˜¯ <code>Optional</code> ç±»å‹ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> reduced <span class="token operator">=</span>    stringCollection        <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span> <span class="token operator">-></span> s1 <span class="token operator">+</span> <span class="token string">"#"</span> <span class="token operator">+</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span>reduced<span class="token punctuation">.</span><span class="token function">ifPresent</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// "aaa1#aaa2#bbb1#bbb2#bbb3#ccc#ddd1#ddd2"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Parallel-Streams-å¹¶è¡Œæµ"><a href="#Parallel-Streams-å¹¶è¡Œæµ" class="headerlink" title="Parallel-Streams å¹¶è¡Œæµ"></a>Parallel-Streams å¹¶è¡Œæµ</h2><p>å‰é¢ç« èŠ‚æˆ‘ä»¬è¯´è¿‡ï¼Œ<code>stream</code> æµæ˜¯æ”¯æŒ<strong>é¡ºåº</strong>å’Œ<strong>å¹¶è¡Œ</strong>çš„ã€‚é¡ºåºæµæ“ä½œæ˜¯å•çº¿ç¨‹æ“ä½œï¼Œè€Œå¹¶è¡Œæµæ˜¯é€šè¿‡å¤šçº¿ç¨‹æ¥å¤„ç†çš„ï¼Œèƒ½å¤Ÿå……åˆ†åˆ©ç”¨ç‰©ç†æœº<br>å¤šæ ¸ CPU çš„ä¼˜åŠ¿ï¼ŒåŒæ—¶å¤„ç†é€Ÿåº¦æ›´å¿«ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåŒ…å« 1000000 UUID list é›†åˆã€‚ </p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> max <span class="token operator">=</span> <span class="token number">1000000</span><span class="token punctuation">;</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> values <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>max<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> max<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">UUID</span> uuid <span class="token operator">=</span> UUID<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    values<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>uuid<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ†åˆ«é€šè¿‡é¡ºåºæµå’Œå¹¶è¡Œæµï¼Œå¯¹è¿™ä¸ª list è¿›è¡Œæ’åºï¼Œæµ‹ç®—è€—æ—¶:</p><h3 id="é¡ºåºæµæ’åº"><a href="#é¡ºåºæµæ’åº" class="headerlink" title="é¡ºåºæµæ’åº"></a>é¡ºåºæµæ’åº</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// çº³ç§’</span><span class="token keyword">long</span> t0 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">long</span> count <span class="token operator">=</span> values<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">long</span> t1 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// çº³ç§’è½¬å¾®ç§’</span><span class="token keyword">long</span> millis <span class="token operator">=</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>NANOSECONDS<span class="token punctuation">.</span><span class="token function">toMillis</span><span class="token punctuation">(</span>t1 <span class="token operator">-</span> t0<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"é¡ºåºæµæ’åºè€—æ—¶: %d ms"</span><span class="token punctuation">,</span> millis<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// é¡ºåºæµæ’åºè€—æ—¶: 899 ms</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å¹¶è¡Œæµæ’åº"><a href="#å¹¶è¡Œæµæ’åº" class="headerlink" title="å¹¶è¡Œæµæ’åº"></a>å¹¶è¡Œæµæ’åº</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// çº³ç§’</span><span class="token keyword">long</span> t0 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">long</span> count <span class="token operator">=</span> values<span class="token punctuation">.</span><span class="token function">parallelStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sorted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">long</span> t1 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// çº³ç§’è½¬å¾®ç§’</span><span class="token keyword">long</span> millis <span class="token operator">=</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>NANOSECONDS<span class="token punctuation">.</span><span class="token function">toMillis</span><span class="token punctuation">(</span>t1 <span class="token operator">-</span> t0<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"å¹¶è¡Œæµæ’åºè€—æ—¶: %d ms"</span><span class="token punctuation">,</span> millis<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// å¹¶è¡Œæµæ’åºè€—æ—¶: 472 ms</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­£å¦‚ä½ æ‰€è§ï¼ŒåŒæ ·çš„é€»è¾‘å¤„ç†ï¼Œé€šè¿‡å¹¶è¡Œæµï¼Œæˆ‘ä»¬çš„æ€§èƒ½æå‡äº†è¿‘ **50%**ã€‚å®Œæˆè¿™ä¸€åˆ‡ï¼Œæˆ‘ä»¬éœ€è¦åšçš„ä»…ä»…æ˜¯å°† <code>stream</code> æ”¹æˆäº† <code>parallelStream</code>ã€‚</p><h2 id="Map-é›†åˆ"><a href="#Map-é›†åˆ" class="headerlink" title="Map é›†åˆ"></a>Map é›†åˆ</h2><p>å‰é¢å·²ç»æåˆ°è¿‡ <code>Map</code> æ˜¯ä¸æ”¯æŒ <code>Stream</code> æµçš„ï¼Œå› ä¸º <code>Map</code> æ¥å£å¹¶æ²¡æœ‰åƒ <code>Collection</code> æ¥å£é‚£æ ·ï¼Œå®šä¹‰äº† <code>stream()</code> æ–¹æ³•ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å…¶ <code>key</code>, <code>values</code>, <code>entry</code> ä½¿ç”¨<br>æµæ“ä½œï¼Œå¦‚ <code>map.keySet().stream()</code>, <code>map.values().stream()</code> å’Œ <code>map.entrySet().stream()</code>.</p><p>å¦å¤–, JDK 8 ä¸­å¯¹ <code>map</code> æä¾›äº†ä¸€äº›å…¶ä»–æ–°ç‰¹æ€§:</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token comment">// ä¸è€ç‰ˆä¸åŒçš„æ˜¯ï¼ŒputIfAbent() æ–¹æ³•åœ¨ put ä¹‹å‰ï¼Œ</span>    <span class="token comment">// ä¼šåˆ¤æ–­ key æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œå­˜åœ¨åˆ™ç›´æ¥è¿”å› value, å¦åˆ™ put, å†è¿”å› value</span>    map<span class="token punctuation">.</span><span class="token function">putIfAbsent</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token string">"val"</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// forEach å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å¯¹ map è¿›è¡Œéå†æ“ä½œ</span>map<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é™¤äº†ä¸Šé¢çš„ <code>putIfAbsent()</code> å’Œ <code>forEach()</code> å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å¯¹æŸä¸ª <code>key</code> çš„å€¼åšç›¸å…³æ“ä½œï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// computeIfPresent(), å½“ key å­˜åœ¨æ—¶ï¼Œæ‰ä¼šåšç›¸å…³å¤„ç†</span><span class="token comment">// å¦‚ä¸‹ï¼šå¯¹ key ä¸º 3 çš„å€¼ï¼Œå†…éƒ¨ä¼šå…ˆåˆ¤æ–­å€¼æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨ï¼Œåˆ™åš value + key çš„æ‹¼æ¥æ“ä½œ</span>map<span class="token punctuation">.</span><span class="token function">computeIfPresent</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>num<span class="token punctuation">,</span> val<span class="token punctuation">)</span> <span class="token operator">-></span> val <span class="token operator">+</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">// val33</span><span class="token comment">// å…ˆåˆ¤æ–­ key ä¸º 9 çš„å…ƒç´ æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨ï¼Œåˆ™åšåˆ é™¤æ“ä½œ</span>map<span class="token punctuation">.</span><span class="token function">computeIfPresent</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>num<span class="token punctuation">,</span> val<span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>map<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// false</span><span class="token comment">// computeIfAbsent(), å½“ key ä¸å­˜åœ¨æ—¶ï¼Œæ‰ä¼šåšç›¸å…³å¤„ç†</span><span class="token comment">// å¦‚ä¸‹ï¼šå…ˆåˆ¤æ–­ key ä¸º 23 çš„å…ƒç´ æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨ï¼Œåˆ™æ·»åŠ </span>map<span class="token punctuation">.</span><span class="token function">computeIfAbsent</span><span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span> num <span class="token operator">-></span> <span class="token string">"val"</span> <span class="token operator">+</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>map<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// true</span><span class="token comment">// å…ˆåˆ¤æ–­ key ä¸º 3 çš„å…ƒç´ æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨ï¼Œåˆ™ä¸åšä»»ä½•å¤„ç†</span>map<span class="token punctuation">.</span><span class="token function">computeIfAbsent</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> num <span class="token operator">-></span> <span class="token string">"bam"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">// val33</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…³äºåˆ é™¤æ“ä½œï¼ŒJDK 8 ä¸­æä¾›äº†èƒ½å¤Ÿæ–°çš„ <code>remove()</code> API:</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">map<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">"val3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">// val33</span>map<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">"val33"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">// null</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚ä¸Šä»£ç ï¼Œåªæœ‰å½“ç»™å®šçš„ <code>key</code> å’Œ <code>value</code> å®Œå…¨åŒ¹é…æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œåˆ é™¤æ“ä½œã€‚</p><p>å…³äºæ·»åŠ æ–¹æ³•ï¼ŒJDK 8 ä¸­æä¾›äº†å¸¦æœ‰é»˜è®¤å€¼çš„ <code>getOrDefault()</code> æ–¹æ³•ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// è‹¥ key 42 ä¸å­˜åœ¨ï¼Œåˆ™è¿”å› not found</span>map<span class="token punctuation">.</span><span class="token function">getOrDefault</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">,</span> <span class="token string">"not found"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// not found</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¯¹äº <code>value</code> çš„åˆå¹¶æ“ä½œä¹Ÿå˜å¾—æ›´åŠ ç®€å•ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// merge æ–¹æ³•ï¼Œä¼šå…ˆåˆ¤æ–­è¿›è¡Œåˆå¹¶çš„ key æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨ï¼Œåˆ™ä¼šæ·»åŠ å…ƒç´ </span>map<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">"val9"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>value<span class="token punctuation">,</span> newValue<span class="token punctuation">)</span> <span class="token operator">-></span> value<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">// val9</span><span class="token comment">// è‹¥ key çš„å…ƒç´ å­˜åœ¨ï¼Œåˆ™å¯¹ value æ‰§è¡Œæ‹¼æ¥æ“ä½œ</span>map<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">"concat"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>value<span class="token punctuation">,</span> newValue<span class="token punctuation">)</span> <span class="token operator">-></span> value<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">// val9concat</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ–°çš„æ—¥æœŸ-API"><a href="#æ–°çš„æ—¥æœŸ-API" class="headerlink" title="æ–°çš„æ—¥æœŸ API"></a>æ–°çš„æ—¥æœŸ API</h2><p>Java 8 ä¸­åœ¨åŒ… <code>java.time</code> ä¸‹æ·»åŠ äº†æ–°çš„æ—¥æœŸ API. å®ƒå’Œ <a href="http://www.joda.org/joda-time/">Joda-Time</a> åº“ç›¸ä¼¼ï¼Œä½†åˆä¸å®Œå…¨ç›¸åŒã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä¼šé€šè¿‡ä¸€äº›ç¤ºä¾‹ä»£ç ä»‹ç»ä¸€ä¸‹æ–° API ä¸­<br>æœ€å…³é”®çš„ç‰¹æ€§ï¼š</p><h3 id="Clock"><a href="#Clock" class="headerlink" title="Clock"></a>Clock</h3><p><code>Clock</code> æä¾›å¯¹å½“å‰æ—¥æœŸå’Œæ—¶é—´çš„è®¿é—®ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒæ¥æ›¿ä»£ <code>System.currentTimeMillis()</code> æ–¹æ³•ã€‚å¦å¤–ï¼Œé€šè¿‡ <code>clock.instant()</code> èƒ½å¤Ÿè·å–ä¸€ä¸ª <code>instant</code> å®ä¾‹ï¼Œ<br>æ­¤å®ä¾‹èƒ½å¤Ÿæ–¹ä¾¿åœ°è½¬æ¢æˆè€ç‰ˆæœ¬ä¸­çš„ <code>java.util.Date</code> å¯¹è±¡ã€‚ </p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Clock</span> clock <span class="token operator">=</span> <span class="token class-name">Clock</span><span class="token punctuation">.</span><span class="token function">systemDefaultZone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">long</span> millis <span class="token operator">=</span> clock<span class="token punctuation">.</span><span class="token function">millis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Instant</span> instant <span class="token operator">=</span> clock<span class="token punctuation">.</span><span class="token function">instant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Date</span> legacyDate <span class="token operator">=</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>instant<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// è€ç‰ˆæœ¬ java.util.Date</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Timezones-æ—¶åŒº"><a href="#Timezones-æ—¶åŒº" class="headerlink" title="Timezones æ—¶åŒº"></a>Timezones æ—¶åŒº</h3><p><code>ZoneId</code> ä»£è¡¨æ—¶åŒºç±»ã€‚é€šè¿‡é™æ€å·¥å‚æ–¹æ³•æ–¹ä¾¿åœ°è·å–å®ƒï¼Œå…¥å‚æˆ‘ä»¬å¯ä»¥ä¼ å…¥æŸä¸ªæ—¶åŒºç¼–ç ã€‚å¦å¤–ï¼Œæ—¶åŒºç±»è¿˜å®šä¹‰äº†ä¸€ä¸ªåç§»é‡ï¼Œç”¨æ¥åœ¨å½“å‰æ—¶åˆ»æˆ–æŸæ—¶é—´<br>ä¸ç›®æ ‡æ—¶åŒºæ—¶é—´ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">getAvailableZoneIds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// prints all available timezone ids</span><span class="token class-name">ZoneId</span> zone1 <span class="token operator">=</span> <span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">"Europe/Berlin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">ZoneId</span> zone2 <span class="token operator">=</span> <span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">"Brazil/East"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>zone1<span class="token punctuation">.</span><span class="token function">getRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>zone2<span class="token punctuation">.</span><span class="token function">getRules</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ZoneRules[currentStandardOffset=+01:00]</span><span class="token comment">// ZoneRules[currentStandardOffset=-03:00]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="LocalTime"><a href="#LocalTime" class="headerlink" title="LocalTime"></a>LocalTime</h3><p><code>LocalTime</code> è¡¨ç¤ºä¸€ä¸ªæ²¡æœ‰æŒ‡å®šæ—¶åŒºçš„æ—¶é—´ç±»ï¼Œä¾‹å¦‚ï¼Œ<code>10 p.m</code>.æˆ–è€… <code>17ï¼š30:15</code>ï¼Œä¸‹é¢ç¤ºä¾‹ä»£ç ä¸­ï¼Œå°†ä¼šä½¿ç”¨ä¸Šé¢åˆ›å»ºçš„<br>æ—¶åŒºå¯¹è±¡åˆ›å»ºä¸¤ä¸ª <code>LocalTime</code>ã€‚ç„¶åæˆ‘ä»¬ä¼šæ¯”è¾ƒä¸¤ä¸ªæ—¶é—´ï¼Œå¹¶è®¡ç®—å®ƒä»¬ä¹‹é—´çš„å°æ—¶å’Œåˆ†é’Ÿçš„ä¸åŒã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">LocalTime</span> now1 <span class="token operator">=</span> <span class="token class-name">LocalTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span>zone1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">LocalTime</span> now2 <span class="token operator">=</span> <span class="token class-name">LocalTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span>zone2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>now1<span class="token punctuation">.</span><span class="token function">isBefore</span><span class="token punctuation">(</span>now2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// false</span><span class="token keyword">long</span> hoursBetween <span class="token operator">=</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span>HOURS<span class="token punctuation">.</span><span class="token function">between</span><span class="token punctuation">(</span>now1<span class="token punctuation">,</span> now2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">long</span> minutesBetween <span class="token operator">=</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span>MINUTES<span class="token punctuation">.</span><span class="token function">between</span><span class="token punctuation">(</span>now1<span class="token punctuation">,</span> now2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hoursBetween<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// -3</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>minutesBetween<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// -239</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>LocalTime</code> æä¾›å¤šä¸ªé™æ€å·¥å‚æ–¹æ³•ï¼Œç›®çš„æ˜¯ä¸ºäº†ç®€åŒ–å¯¹æ—¶é—´å¯¹è±¡å®ä¾‹çš„åˆ›å»ºå’Œæ“ä½œï¼ŒåŒ…æ‹¬å¯¹æ—¶é—´å­—ç¬¦ä¸²è¿›è¡Œè§£æçš„æ“ä½œç­‰ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">LocalTime</span> late <span class="token operator">=</span> <span class="token class-name">LocalTime</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>late<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// 23:59:59</span><span class="token class-name">DateTimeFormatter</span> germanFormatter <span class="token operator">=</span>    <span class="token class-name">DateTimeFormatter</span>        <span class="token punctuation">.</span><span class="token function">ofLocalizedTime</span><span class="token punctuation">(</span><span class="token class-name">FormatStyle</span><span class="token punctuation">.</span>SHORT<span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">withLocale</span><span class="token punctuation">(</span><span class="token class-name">Locale</span><span class="token punctuation">.</span>GERMAN<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">LocalTime</span> leetTime <span class="token operator">=</span> <span class="token class-name">LocalTime</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">"13:37"</span><span class="token punctuation">,</span> germanFormatter<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>leetTime<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 13:37</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="LocalDate"><a href="#LocalDate" class="headerlink" title="LocalDate"></a>LocalDate</h2><p><code>LocalDate</code> æ˜¯ä¸€ä¸ªæ—¥æœŸå¯¹è±¡ï¼Œä¾‹å¦‚ï¼š<code>2014-03-11</code>ã€‚å®ƒå’Œ <code>LocalTime</code> ä¸€æ ·æ˜¯ä¸ª <code>final</code> ç±»å‹å¯¹è±¡ã€‚ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡åŠ å‡æ—¥ï¼Œæœˆï¼Œå¹´ç­‰æ¥è®¡ç®—ä¸€ä¸ªæ–°çš„æ—¥æœŸã€‚</p><blockquote><p><code>LocalDate</code>, <code>LocalTime</code>, å› ä¸ºæ˜¯ <code>final</code> ç±»å‹çš„å¯¹è±¡ï¼Œæ¯ä¸€æ¬¡æ“ä½œéƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„æ—¶é—´å¯¹è±¡ã€‚</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">LocalDate</span> today <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ä»Šå¤©åŠ ä¸€å¤©</span><span class="token class-name">LocalDate</span> tomorrow <span class="token operator">=</span> today<span class="token punctuation">.</span><span class="token function">plus</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">ChronoUnit</span><span class="token punctuation">.</span>DAYS<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æ˜å¤©å‡ä¸¤å¤©</span><span class="token class-name">LocalDate</span> yesterday <span class="token operator">=</span> tomorrow<span class="token punctuation">.</span><span class="token function">minusDays</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 2014 å¹´ä¸ƒæœˆçš„ç¬¬å››å¤©</span><span class="token class-name">LocalDate</span> independenceDay <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">2014</span><span class="token punctuation">,</span> <span class="token class-name">Month</span><span class="token punctuation">.</span>JULY<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">DayOfWeek</span> dayOfWeek <span class="token operator">=</span> independenceDay<span class="token punctuation">.</span><span class="token function">getDayOfWeek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>dayOfWeek<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// æ˜ŸæœŸäº”</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¹Ÿå¯ä»¥ç›´æ¥è§£ææ—¥æœŸå­—ç¬¦ä¸²ï¼Œç”Ÿæˆ <code>LocalDate</code> å®ä¾‹ã€‚ï¼ˆå’Œ <code>LocalTime</code> æ“ä½œä¸€æ ·ç®€å•ï¼‰</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">DateTimeFormatter</span> germanFormatter <span class="token operator">=</span>    <span class="token class-name">DateTimeFormatter</span>        <span class="token punctuation">.</span><span class="token function">ofLocalizedDate</span><span class="token punctuation">(</span><span class="token class-name">FormatStyle</span><span class="token punctuation">.</span>MEDIUM<span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">withLocale</span><span class="token punctuation">(</span><span class="token class-name">Locale</span><span class="token punctuation">.</span>GERMAN<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">LocalDate</span> xmas <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">"24.12.2014"</span><span class="token punctuation">,</span> germanFormatter<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>xmas<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 2014-12-24</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="LocalDateTime"><a href="#LocalDateTime" class="headerlink" title="LocalDateTime"></a>LocalDateTime</h3><p><code>LocalDateTime</code> æ˜¯ä¸€ä¸ª<strong>æ—¥æœŸ-æ—¶é—´</strong>å¯¹è±¡ã€‚ä½ ä¹Ÿå¯ä»¥å°†å…¶çœ‹æˆæ˜¯ <code>LocalDate</code> å’Œ <code>LocalTime</code> çš„ç»“åˆä½“ã€‚æ“ä½œä¸Šï¼Œä¹Ÿå¤§è‡´ç›¸åŒã€‚</p><blockquote><p><code>LocalDateTime</code> åŒæ ·æ˜¯ä¸€ä¸ª <code>final</code> ç±»å‹å¯¹è±¡ã€‚</p></blockquote><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">LocalDateTime</span> sylvester <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">2014</span><span class="token punctuation">,</span> <span class="token class-name">Month</span><span class="token punctuation">.</span>DECEMBER<span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">DayOfWeek</span> dayOfWeek <span class="token operator">=</span> sylvester<span class="token punctuation">.</span><span class="token function">getDayOfWeek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>dayOfWeek<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// æ˜ŸæœŸä¸‰</span><span class="token class-name">Month</span> month <span class="token operator">=</span> sylvester<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// åäºŒæœˆ</span><span class="token comment">// è·å–æ”¹æ—¶é—´æ˜¯è¯¥å¤©ä¸­çš„ç¬¬å‡ åˆ†é’Ÿ</span><span class="token keyword">long</span> minuteOfDay <span class="token operator">=</span> sylvester<span class="token punctuation">.</span><span class="token function">getLong</span><span class="token punctuation">(</span><span class="token class-name">ChronoField</span><span class="token punctuation">.</span>MINUTE_OF_DAY<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>minuteOfDay<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 1439</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœå†åŠ ä¸Šçš„æ—¶åŒºä¿¡æ¯ï¼Œ<code>LocalDateTime</code> è¿˜èƒ½å¤Ÿè¢«è½¬æ¢æˆ <code>Instance</code> å®ä¾‹ã€‚<code>Instance</code> èƒ½å¤Ÿè¢«è½¬æ¢æˆè€ç‰ˆæœ¬ä¸­ <code>java.util.Date</code> å¯¹è±¡ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Instant</span> instant <span class="token operator">=</span> sylvester        <span class="token punctuation">.</span><span class="token function">atZone</span><span class="token punctuation">(</span><span class="token class-name">ZoneId</span><span class="token punctuation">.</span><span class="token function">systemDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Date</span> legacyDate <span class="token operator">=</span> <span class="token class-name">Date</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>instant<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>legacyDate<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// Wed Dec 31 23:59:59 CET 2014</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ ¼å¼åŒ– <code>LocalDateTime</code> å¯¹è±¡å°±å’Œæ ¼å¼åŒ– LocalDate æˆ–è€… LocalTime ä¸€æ ·ã€‚é™¤äº†ä½¿ç”¨é¢„å®šä¹‰çš„æ ¼å¼ä»¥å¤–ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ ¼å¼åŒ–è¾“å‡ºã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">DateTimeFormatter</span> formatter <span class="token operator">=</span>    <span class="token class-name">DateTimeFormatter</span>        <span class="token punctuation">.</span><span class="token function">ofPattern</span><span class="token punctuation">(</span><span class="token string">"MMM dd, yyyy - HH:mm"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">LocalDateTime</span> parsed <span class="token operator">=</span> <span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">"Nov 03, 2014 - 07:13"</span><span class="token punctuation">,</span> formatter<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> string <span class="token operator">=</span> formatter<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>parsed<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// Nov 03, 2014 - 07:13</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ³¨æ„ï¼šå’Œ <code>java.text.NumberFormat</code> ä¸åŒï¼Œæ–°çš„ <code>DateTimeFormatter</code> ç±»æ˜¯ <code>final</code> ç±»å‹çš„ï¼ŒåŒæ—¶ä¹Ÿæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚æ›´å¤šç»†èŠ‚è¯·æŸ¥çœ‹<a href="http://download.java.net/jdk8/docs/api/java/time/format/DateTimeFormatter.html">è¿™é‡Œ</a></p></blockquote><h2 id="Annotations-æ³¨è§£"><a href="#Annotations-æ³¨è§£" class="headerlink" title="Annotations æ³¨è§£"></a>Annotations æ³¨è§£</h2><p>åœ¨ Java 8 ä¸­ï¼Œæ³¨è§£æ˜¯å¯ä»¥é‡å¤çš„ã€‚è®©æˆ‘é€šè¿‡ä¸‹é¢çš„ç¤ºä¾‹ä»£ç ï¼Œæ¥çœ‹çœ‹åˆ°åº•æ˜¯å’‹å›äº‹ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåŒ…è£…æ³¨è§£ï¼Œé‡Œé¢åŒ…å«äº†ä¸€ä¸ªæœ‰ç€å®é™…æ³¨è§£çš„æ•°ç»„ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@interface</span> <span class="token class-name">Hints</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">Hint</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token annotation punctuation">@Repeatable</span><span class="token punctuation">(</span><span class="token class-name">Hints</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token annotation punctuation">@interface</span> <span class="token class-name">Hint</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Java 8 ä¸­ï¼Œé€šè¿‡ <code>@Repeatable</code>ï¼Œå…è®¸æˆ‘ä»¬å¯¹åŒä¸€ä¸ªç±»ä½¿ç”¨å¤šé‡æ³¨è§£ï¼š</p><p>ç¬¬ä¸€ç§å½¢æ€ï¼šä½¿ç”¨æ³¨è§£å®¹å™¨ï¼ˆè€æ–¹æ³•ï¼‰</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Hints</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token annotation punctuation">@Hint</span><span class="token punctuation">(</span><span class="token string">"hint1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token annotation punctuation">@Hint</span><span class="token punctuation">(</span><span class="token string">"hint2"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç¬¬äºŒç§å½¢æ€ï¼šä½¿ç”¨å¯é‡å¤æ³¨è§£ï¼ˆæ–°æ–¹æ³•ï¼‰</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Hint</span><span class="token punctuation">(</span><span class="token string">"hint1"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Hint</span><span class="token punctuation">(</span><span class="token string">"hint2"</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨ç¬¬äºŒç§å½¢æ€ï¼ŒJava ç¼–è¯‘å™¨èƒ½å¤Ÿåœ¨å†…éƒ¨è‡ªåŠ¨å¯¹ <code>@Hint</code> è¿›è¡Œè®¾ç½®ã€‚è¿™å¯¹äºéœ€è¦é€šè¿‡åå°„æ¥è¯»å–æ³¨è§£ä¿¡æ¯æ—¶ï¼Œæ˜¯éå¸¸é‡è¦çš„ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Hint</span> hint <span class="token operator">=</span> <span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getAnnotation</span><span class="token punctuation">(</span><span class="token class-name">Hint</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hint<span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token comment">// null</span><span class="token class-name">Hints</span> hints1 <span class="token operator">=</span> <span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getAnnotation</span><span class="token punctuation">(</span><span class="token class-name">Hints</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hints1<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 2</span><span class="token class-name">Hint</span><span class="token punctuation">[</span><span class="token punctuation">]</span> hints2 <span class="token operator">=</span> <span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getAnnotationsByType</span><span class="token punctuation">(</span><span class="token class-name">Hint</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>hints2<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// 2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°½ç®¡æˆ‘ä»¬ç»å¯¹ä¸ä¼šåœ¨ <code>Person</code> ç±»ä¸Šå£°æ˜ <code>@Hints</code> æ³¨è§£ï¼Œä½†æ˜¯å®ƒçš„ä¿¡æ¯ä»ç„¶æ˜¯å¯ä»¥é€šè¿‡ <code>getAnnotation(Hints.class)</code> æ¥è¯»å–çš„ã€‚<br>å¹¶ä¸”ï¼Œ<code>getAnnotationsByType</code> æ–¹æ³•ä¼šæ›´æ–¹ä¾¿ï¼Œå› ä¸ºå®ƒèµ‹äºˆäº†æ‰€æœ‰ <code>@Hints</code> æ³¨è§£æ ‡æ³¨çš„æ–¹æ³•ç›´æ¥çš„è®¿é—®æƒé™ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span>TYPE_PARAMETER<span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span>TYPE_USE<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token annotation punctuation">@interface</span> <span class="token class-name">MyAnnotation</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>Java 8 æ–°ç‰¹æ€§çš„ç¼–ç¨‹æŒ‡å—åˆ°æ­¤å°±å‘Šä¸€æ®µè½äº†ã€‚å½“ç„¶ï¼Œè¿˜æœ‰å¾ˆå¤šå†…å®¹éœ€è¦è¿›ä¸€æ­¥ç ”ç©¶å’Œè¯´æ˜ã€‚è¿™å°±éœ€è¦é è¯»è€…æ‚¨æ¥å¯¹ JDK 8 è¿›ä¸€æ­¥æ¢ç©¶äº†ï¼Œ<br>ä¾‹å¦‚ï¼š<code>Arrays.parallelSort</code>, <code>StampedLock</code> å’Œ <code>CompletableFuture</code> ç­‰ç­‰ï¼Œæˆ‘è¿™é‡Œä¹Ÿä»…æ˜¯èµ·åˆ°æŠ›ç –å¼•ç‰çš„ä½œç”¨è€Œå·²ã€‚</p><p>æœ€åï¼Œæˆ‘å¸Œæœ›è¿™ä¸ªæ•™ç¨‹èƒ½å¤Ÿå¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œä¹Ÿå¸Œæœ›æ‚¨é˜…è¯»æ„‰å¿«ã€‚</p><p>â€‹        </p>]]></content>
      
      
      <categories>
          
          <category> jdk8 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> jdk8 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Java8 æ–°ç‰¹æ€§å¹¶å‘ç¯‡(ä¸€) çº¿ç¨‹ä¸æ‰§è¡Œå™¨</title>
      <link href="/platform.github.io/2022/09/19/Java8%20%E5%B9%B6%E5%8F%91%E7%AF%87(%E4%B8%80)%20%E7%BA%BF%E7%A8%8B%E4%B8%8E%E6%89%A7%E8%A1%8C%E5%99%A8/"/>
      <url>/platform.github.io/2022/09/19/Java8%20%E5%B9%B6%E5%8F%91%E7%AF%87(%E4%B8%80)%20%E7%BA%BF%E7%A8%8B%E4%B8%8E%E6%89%A7%E8%A1%8C%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æœ¬æ–‡ç¿»è¯‘æ•´ç†è‡ª <a href="https://winterbe.com/posts/2015/04/07/java8-concurrency-tutorial-thread-executor-examples/">https://winterbe.com/posts/2015/04/07/java8-concurrency-tutorial-thread-executor-examples/</a></p></blockquote><p>æ¬¢è¿è¿›å…¥ Java8 å¹¶å‘ç¯‡ç³»åˆ—ã€‚æ­¤ç³»åˆ—å¤§æ¦‚åŒ…æ‹¬ä¸‰ç¯‡æ•™ç¨‹ï¼š</p><ul><li><a href="#1">çº¿ç¨‹ä¸æ‰§è¡Œå™¨ Threads ä¸ Executors</a></li><li><a href="#1">åŒæ­¥ä¸é” Synchronization and Locks</a></li><li><a href="#1">åŸå­å˜é‡ä¸ ConcurrentMap</a></li></ul><p>æœ¬ç¯‡åšæ–‡æ˜¯æ­¤ç³»åˆ—çš„ç¬¬ä¸€ç¯‡ï¼Œæ¥ä¸‹æ¥çš„ 15 åˆ†é’Ÿé‡Œï¼Œæˆ‘å°†ä¼šé€šè¿‡ä¸€äº›ç®€å•æ˜“æ‡‚çš„ç¤ºä¾‹ä»£ç æ¥æ•™ä¼šä½ ï¼Œå¦‚ä½•åœ¨ Java8 ä¸­è¿›è¡Œå¹¶å‘ç¼–ç¨‹ï¼Œå­¦ä¼šå¦‚ä½•é€šè¿‡ <code>Thread</code>,  <code>Runable</code> å’Œ <code>Executor</code> æ¥å¹¶è¡Œæ‰§è¡Œä»£ç ã€‚</p><p>å…³äº JDK ä¸­ <a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/package-summary.html">å¹¶å‘ API</a> æ˜¯åœ¨ JDK1.5 ä¸­è¢«é¦–æ¬¡å¼•å…¥çš„ï¼Œå¹¶ä¸”åœ¨åç»­çš„ç‰ˆæœ¬ä¸­å¾—åˆ°ä¸æ–­åœ°å¢å¼ºã€‚è¿™ç¯‡æ–‡ç« ä¸­ä»‹ç»çš„å¤§éƒ¨åˆ†åè¯æ¦‚å¿µåŒæ ·é€‚ç”¨äºè€ç‰ˆæœ¬ï¼Œè¿™ä¸€ç‚¹ä½ ä¸ç”¨æ‹…å¿ƒã€‚æœ¬æ–‡çš„ç€é‡ç‚¹åœ¨ä»£ç æ¼”ç¤ºï¼Œå¦‚ä½•ä½¿ç”¨ <code>lambda</code> è¡¨è¾¾å¼ä»¥åŠæ–°ç‰¹æ€§ç›¸å…³ã€‚</p><p>å¦‚æœä½ å¯¹ <code>lambda</code> è¡¨è¾¾å¼ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œæˆ‘æ¨èä½ å…ˆé˜…è¯»æˆ‘ä¹‹å‰çš„æ–‡ç« ï¼š<a href="https://github.com/weiwosuoai/java8_guide">Java8 æ–°ç‰¹æ€§æŒ‡å¯¼æ‰‹å†Œ</a></p><h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ul><li><p><a href="#1">ä¸€ã€Threads ä¸ Runnables</a></p></li><li><p><a href="#1">äºŒã€æ‰§è¡Œå™¨ Executor</a></p></li><li><p><a href="#1">ä¸‰ã€Callable å’Œ Future</a></p></li><li><p><a href="#1">å››ã€è¶…æ—¶è®¾ç½®</a></p></li><li><p><a href="#1">äº”ã€invokeAll</a></p></li><li><p><a href="#1">å…­ã€invokeAny</a></p></li><li><p><a href="#1">ä¸ƒã€ä»»åŠ¡è°ƒåº¦ ScheduledExecutor</a></p><p><img src="/platform.github.io/medias/pic/20190121141956.png"></p></li></ul><h2 id="Threads-ä¸-Runnables"><a href="#Threads-ä¸-Runnables" class="headerlink" title="Threads ä¸ Runnables"></a>Threads ä¸ Runnables</h2><p>å¯ä»¥è‚¯å®šçš„æ˜¯ï¼Œæ‰€æœ‰çš„ç°ä»£æ“ä½œç³»ç»Ÿæ”¯æŒå¹¶å‘çš„æ‰‹æ®µæ— å¤–ä¹<strong>è¿›ç¨‹</strong>å’Œ<strong>çº¿ç¨‹</strong>ã€‚è¿›ç¨‹é€šå¸¸å¯ä»¥ç†è§£ä¸ºç‹¬ç«‹è¿è¡Œçš„ç¨‹åºå®ä¾‹ï¼Œæ‰“ä¸ªæ¯”æ–¹ï¼Œä½ å¯åŠ¨ä¸€ä¸ª Java ç¨‹åºï¼Œè¿™ä¸ªæ—¶å€™æ“ä½œç³»ç»Ÿå°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹ï¼Œå®ƒå¯ä»¥ä¸å…¶ä»–ç¨‹åºå¹¶è¡Œè¿è¡Œã€‚è€Œåœ¨è¿™äº›è¿›ç¨‹çš„å†…éƒ¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡çº¿ç¨‹æ¥å¹¶å‘æ‰§è¡Œä¸€æ®µä»£ç ï¼Œä¸€æ®µä¸šåŠ¡é€»è¾‘ã€‚è¿™æ ·åšæœ‰å•¥å¥½å¤„ï¼Ÿå¥½å¤„å°±æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æœ€å¤§ç¨‹åº¦çš„å‘æŒ¥æœºå™¨å¤šæ ¸ CPU çš„ä¼˜åŠ¿ã€‚</p><p>Java ä» 1.0 ç‰ˆæœ¬å°±å¼€å§‹æ”¯æŒçº¿ç¨‹äº†ã€‚å¯ä»¥è¯´æ˜¯æœ€åŸºæœ¬çš„åŠŸèƒ½äº†ï¼Œåœ¨è€ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå®ç° <code>Runnable</code> æ¥å£ï¼Œé‡å†™ <code>run()</code> æ–¹æ³•, åœ¨æ–¹æ³•å†…ç¼–å†™ä¸€æ®µä¸šåŠ¡ä»£ç ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Runnable</span> task <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> threadName <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Hello "</span> <span class="token operator">+</span> threadName<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>task<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Done!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸º Runnable æ¥å£æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œæˆ‘ä»¬ç›´æ¥é‡‡ç”¨ lambda è¡¨è¾¾å¼æ¥ä¹¦å†™å®ƒï¼Œå†…éƒ¨çš„ä¸šåŠ¡é€»è¾‘æ˜¯æ‰“å°å½“å‰çš„çº¿ç¨‹åï¼Œæ§åˆ¶å°çš„è¾“å‡ºå¯èƒ½å­˜åœ¨ä¸¤ç§æƒ…å†µï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Hello</span> main<span class="token class-name">Hello</span> <span class="token class-name">Thread</span><span class="token operator">-</span><span class="token number">0</span><span class="token class-name">Done</span><span class="token operator">!</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æˆ–è€…ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Hello</span> main<span class="token class-name">Done</span><span class="token operator">!</span><span class="token class-name">Hello</span> <span class="token class-name">Thread</span><span class="token operator">-</span><span class="token number">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬æ— æ³•é¢„æµ‹ <code>runnable</code> æ˜¯åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œå®Œæˆåæ‰§è¡Œè¿˜æ˜¯ä¹‹å‰æ‰§è¡Œï¼Œå› ä¸ºè¿™ç§é¡ºåºçš„ä¸ç¡®å®šæ€§ï¼Œä½¿å¾—åœ¨ä¸€ä¸ªä½“é‡åºå¤§çš„åº”ç”¨ä¸­ï¼Œå¹¶å‘ç¼–ç¨‹å˜å¾—å¼‚å¸¸å¤æ‚ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åœ¨çº¿ç¨‹å†…éƒ¨è®¾ç½®ä¼‘çœ æ—¶é—´ï¼Œæ¥æ¨¡æ‹Ÿä¸€ä¸ªé•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Runnable</span> runnable <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Foo "</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// ä¼‘çœ ä¸€ç§’</span>        <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Bar "</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token class-name">Thread</span> thread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span>runnable<span class="token punctuation">)</span><span class="token punctuation">;</span>thread<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œä½ ä¼šå‘ç°ä¸¤æ¡æ‰“å°è¯­å¥ä¹‹é—´ä¼šé—´éš”ä¸€ç§’ã€‚<code>TimeUnit</code> åœ¨å¤„ç†å•ä½æ—¶é—´çš„æ—¶å€™ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå®ç”¨çš„æšä¸¾ç±»ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨ <code>Thread.sleep(1000)</code> æ¥è¾¾åˆ°åŒæ ·çš„ç›®çš„ã€‚</p><p>æˆ‘ä»¬ä¸å¾—ä¸æ‰¿è®¤ï¼Œä½¿ç”¨ <code>Thread</code> ç±»æ˜¯å¾ˆä¹å‘³çš„ä¸”å®¹æ˜“å‡ºé”™çš„ã€‚ç”±äº Java å¹¶å‘ç›¸å…³çš„ API æ˜¯åœ¨ 2004 å¹´ Java5 å‘å¸ƒçš„æ—¶å€™æ‰è¢«æ­£å¼å¼•å…¥çš„ã€‚å®ƒä»¬è¢«æ”¾ç½®åœ¨ <code>java.util.concurrent</code> åŒ…ä¸‹ï¼Œé‡Œé¢åŒ…å«äº†å¾ˆå¤šå¤„ç†å¹¶å‘ç¼–ç¨‹æœ‰ç”¨çš„ç±»ã€‚</p><p>è¿™äº›å¹¶å‘ API è¢«å¼•å…¥åï¼Œåœ¨åç»­çš„ Java ç‰ˆæœ¬ä¸­ï¼Œåˆå¾—åˆ°ä¸æ–­çš„å¢å¼ºï¼ŒJava8 ç”šè‡³æä¾›äº†æ–°çš„å¹¶å‘ç±»å’Œæ–¹æ³•æ¥å¤„ç†å¹¶å‘ã€‚</p><p>åºŸè¯ä¸å¤šè¯´ï¼Œæ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬è¿›å…¥å¹¶å‘ API ä¸­æœ€é‡è¦çš„æ‰§è¡Œå™¨ï¼š <code>Executor</code>.</p><h2 id="æ‰§è¡Œå™¨-Executor"><a href="#æ‰§è¡Œå™¨-Executor" class="headerlink" title="æ‰§è¡Œå™¨ Executor"></a>æ‰§è¡Œå™¨ Executor</h2><p>è®¾è®¡ <code>ExecutorService</code> çš„ç›®çš„æ˜¯ç”¨æ¥æ›¿ä»£æˆ‘ä»¬ç›´æ¥æ‰‹åŠ¨åˆ›å»º <code>Thread</code>ã€‚<code>Executors</code> æ”¯æŒè¿è¡Œå¼‚æ­¥ä»»åŠ¡ï¼Œé€šå¸¸ç®¡ç†ç€ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ± å†…éƒ¨çº¿ç¨‹ä¼šå¾—åˆ°å¤ç”¨ï¼Œé¿å…äº†é¢‘ç¹åˆ›å»ºçº¿ç¨‹ï¼Œé”€æ¯çº¿ç¨‹è€Œå¸¦æ¥çš„é¢å¤–çš„ç³»ç»Ÿå¼€é”€ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">// åˆ›å»ºä¸€ä¸ªåªåŒ…å«ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± </span><span class="token class-name">ExecutorService</span> executor <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newSingleThreadExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>executor<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span><span class="token class-name">String</span> threadName <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Hello "</span> <span class="token operator">+</span> threadName<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// => Hello pool-1-thread-1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>Executors</code> ç±»æä¾›äº†ä¾¿åˆ©çš„å·¥å‚æ–¹æ³•ç”¨æ¥ä¸åŒç±»å‹çš„çº¿ç¨‹æ± ã€‚ä¸Šé¢çš„ç¤ºä¾‹ä¸­æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåªåŒ…å«å•çº¿ç¨‹çš„çº¿ç¨‹æ±  <code>executor</code>ã€‚</p><p>ä»£ç çš„è¾“å‡ºç»“æœä¸ä¸Šé¢æ‰‹åŠ¨ new Runnable() è¾“å‡ºä¸€è‡´ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œ<strong>Java è¿›ç¨‹æ²¡æœ‰ç»ˆæ­¢</strong>ï¼</p><p><img src="/platform.github.io/medias/pic/20190121141052.jpg"></p><blockquote><p>æ³¨æ„ï¼š<code>Executors</code> å¿…é¡»æ˜¾ç¤ºçš„ç»ˆæ­¢å®ƒï¼Œå¦åˆ™å®ƒä»¬å°†æŒç»­ç›‘å¬æ˜¯å¦æœ‰æ–°çš„ä»»åŠ¡éœ€è¦æ‰§è¡Œã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘åœ¨ç ”å‘ç»„ä¸­æ¨èå°ç»„äººå‘˜åˆ›å»ºçº¿ç¨‹æ± åŠ¡å¿…è¦äº¤ç»™ Spring Ioc å®¹å™¨ç®¡ç†çš„åŸå› ã€‚</p></blockquote><p>é‚£ä¹ˆï¼Œå¦‚ä½•ä¼˜é›…çš„å…³é—­ <code>ExecutorService</code> å‘¢ï¼Ÿ</p><p><code>ExecutorService</code> æä¾›äº†ä¸¤ä¸ªæ–¹æ³•ï¼š</p><ul><li>1.<code>shutdwon()</code> : å®ƒä¼šç­‰å¾…æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œå†é”€æ¯çº¿ç¨‹æ± ï¼›</li><li>2.<code>shutdownNow()</code>ï¼š å®ƒä¼šç«‹åˆ»ç»ˆæ­¢æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¹¶é”€æ¯çº¿ç¨‹æ± ï¼›</li></ul><p>å…³é—­ <code>ExecutorService</code> æœ€ä½³å®è·µï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">try</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"attempt to shutdown executor"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    executor<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// æŒ‡å®šå…³é—­ä¹‹å‰çš„ç­‰å¾…æ—¶é—´ 5sï¼Œè¾¾åˆ°â€œæ¸©æŸ”æ»´â€å…³é—­</span>    executor<span class="token punctuation">.</span><span class="token function">awaitTermination</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"tasks interrupted"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>executor<span class="token punctuation">.</span><span class="token function">isTerminated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"cancel non-finished tasks"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    executor<span class="token punctuation">.</span><span class="token function">shutdownNow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"shutdown finished"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Callable-å’Œ-Future"><a href="#Callable-å’Œ-Future" class="headerlink" title="Callable å’Œ Future"></a>Callable å’Œ Future</h2><p>é™¤äº† <code>Runnable</code>, <code>executor</code> è¿˜æ”¯æŒå¦å¤–ä¸€ç§ä»»åŠ¡ç±»å‹ â€”â€” <code>Callable</code>ã€‚<code>Callable</code> å’Œ <code>Runnable</code> ç±»ä¼¼ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œ<code>Callable</code> æœ‰è¿”å›å€¼ã€‚</p><p>ä¸‹é¢çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ lambda è¡¨è¾¾å¼å®šä¹‰äº†ä¸€ä¸ª <code>Callable</code>ï¼šä¼‘çœ  1s é’Ÿåï¼Œè¿”å›ä¸€ä¸ªæ•´æ•°ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> task <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">123</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">"task interrupted"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>Callable</code> ä¹Ÿå¯ä»¥åƒ <code>Runnable</code> ä¸€æ ·ï¼Œä½œä¸ºå…¥å‚ï¼Œæäº¤ç»™ <code>executor</code>ã€‚è¿™æ ·çš„è¯ï¼Œé—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬æ€ä¹ˆå–åˆ°è¿”å›å€¼å‘¢ï¼Ÿå› ä¸º <code>submit()</code> æ–¹æ³•ä¸ä¼šé˜»å¡ç­‰å¾…ä»»åŠ¡å®Œæˆçš„ã€‚</p><p>è™½ç„¶ <code>executor</code> ä¸èƒ½ç›´æ¥è¿”å› <code>Callable</code> ç»“æœï¼Œä¸è¿‡ï¼Œ<code>executor</code> å¯ä»¥è¿”å›ä¸€ä¸ª <code>Future</code> ç±»å‹çš„ç»“æœï¼Œä»–å¯ä»¥åœ¨ç¨åçš„æŸä¸ªæ—¶æœºå–å‡ºå®é™…çš„è¿”å›å€¼ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ExecutorService</span> executor <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> future <span class="token operator">=</span> executor<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"future done? "</span> <span class="token operator">+</span> future<span class="token punctuation">.</span><span class="token function">isDone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è¿™é‡Œä¼šé˜»å¡ç­‰å¾…è¿”å›ç»“æœ</span><span class="token class-name">Integer</span> result <span class="token operator">=</span> future<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"future done? "</span> <span class="token operator">+</span> future<span class="token punctuation">.</span><span class="token function">isDone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"result: "</span> <span class="token operator">+</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šé¢çš„è¿™æ®µä»£ç ï¼Œ<code>Callable</code> æäº¤ç»™ <code>executor</code> åï¼Œæˆ‘ä»¬å…ˆé€šè¿‡è°ƒç”¨ <code>isDone()</code> æ£€æŸ¥ <code>future</code> æ˜¯å¦æ‰§è¡Œå®Œæˆï¼Œç»“æœå½“ç„¶æ˜¯ <code>false</code>, å› ä¸º <code>future</code> åœ¨è¿”å›é‚£ä¸ªæ•´æ•°ä¹‹å‰ï¼Œä¼šä¼‘çœ  1sã€‚</p><p>åé¢åˆ°æ‰§è¡Œ <code>get()</code> æ–¹æ³•ï¼Œçº¿ç¨‹ä¼šé˜»å¡ç­‰å¾…è¿”å›ç»“æœã€‚æ•´ä¸ªæµç¨‹èµ°å®Œï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸‹æ§åˆ¶å°çš„è¾“å‡ºï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">future done<span class="token operator">?</span> <span class="token boolean">false</span>future done<span class="token operator">?</span> <span class="token boolean">true</span>result<span class="token operator">:</span> <span class="token number">123</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä½ éœ€è¦æ³¨æ„ï¼Œå¦‚æœä½ å…³é—­ <code>executor</code>, æ‰€æœ‰ä¸ºå…³é—­çš„ <code>future</code> éƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><pre class="line-numbers language-java" data-language="java"><code class="language-java">executor<span class="token punctuation">.</span><span class="token function">shutdownNow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>future<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¿˜æœ‰ä¸€ç‚¹ï¼Œä½ å¯èƒ½ä¹Ÿæ³¨æ„åˆ°äº†ï¼Œè¿™æ¬¡æˆ‘ä»¬åˆ›å»ºçº¿ç¨‹æ± å¹¶éä½¿ç”¨ <code>newSingleThreadExecutor()</code>ã€‚è€Œæ˜¯é€šè¿‡<code>newFixedThreadPool(1)</code>æ¥åˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹çº¿ç¨‹æ± çš„ <code>executor</code>ã€‚ å®ƒç­‰åŒäºä½¿ç”¨<code>newSingleThreadExecutor</code>ï¼Œä¸è¿‡ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼æˆ‘ä»¬åŠ¨æ€çš„è°ƒæ•´å…¥å‚ï¼Œæ¯”å¦‚ä¼ å…¥ä¸€ä¸ªæ¯” 1 å¤§çš„å€¼æ¥å¢åŠ çº¿ç¨‹æ± çš„å¤§å°ã€‚</p><h2 id="è¶…æ—¶-Timeouts"><a href="#è¶…æ—¶-Timeouts" class="headerlink" title="è¶…æ—¶ Timeouts"></a>è¶…æ—¶ Timeouts</h2><p>ä¸Šé¢æåˆ°äº†ï¼Œ<code>future.get()</code> é‚£é‡Œä¼šé˜»å¡ç­‰å¾…ï¼Œç›´åˆ° <code>callable</code> è¿”å›å€¼ã€‚æˆ‘ä»¬è¯•æƒ³ä¸€ä¸ªæœ€ç³Ÿç³•çš„æƒ…å†µï¼Œ<code>callable</code> æŒç»­è¿è¡Œå¯¼è‡´ä½ çš„ç¨‹åºæ²¡æœ‰å“åº”ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸èƒ½å¿å—çš„ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼ å…¥ä¸€ä¸ªè¶…æ—¶æ—¶é—´æ¥é¿å…å‘ç”Ÿè¿™ç§æƒ…å†µï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ExecutorService</span> executor <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> future <span class="token operator">=</span> executor<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token number">123</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">"task interrupted"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è®¾ç½®è¶…æ—¶æ—¶é—´ä¸º 1s</span>future<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰§è¡Œä¸Šé¢è¿™æ®µä»£ç ï¼Œä¼šæŠ›å‡ºä¸€ä¸ª TimeoutExceptionï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Exception</span> in thread <span class="token string">"main"</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span>TimeoutException</span>    at <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span>FutureTask</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">FutureTask</span><span class="token punctuation">.</span>java<span class="token operator">:</span><span class="token number">205</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä¸ºä»€ä¹ˆæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ï¼ŒåŸå› å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬æŒ‡å®šçš„è¶…æ—¶æ—¶é—´æ˜¯ 1s, è€Œä»»åŠ¡ä¸­å…‰ä¼‘çœ å°±æ˜¯ 2s äº†ã€‚</p><h2 id="invokeAll"><a href="#invokeAll" class="headerlink" title="invokeAll"></a>invokeAll</h2><p><code>Executors</code> æ”¯æŒé€šè¿‡ <code>invokeAll</code> æ–¹æ³•ä¸€æ¬¡æ€§æ‰¹é‡æäº¤å¤šä¸ª <code>callable</code>ã€‚è¿™ä¸ªæ–¹æ³•çš„è¿”å›ç»“æœæ˜¯ä¸€ä¸ª <code>future</code> é›†åˆï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ExecutorService</span> executor <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newWorkStealingPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Callable</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span><span class="token punctuation">></span></span> callables <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>        <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token string">"task1"</span><span class="token punctuation">,</span>        <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token string">"task2"</span><span class="token punctuation">,</span>        <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token string">"task3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>executor<span class="token punctuation">.</span><span class="token function">invokeAll</span><span class="token punctuation">(</span>callables<span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>future <span class="token operator">-></span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// æ‹¿åˆ°æ¯ä¸ª future çš„è¿”å›å€¼</span>            <span class="token keyword">return</span> future<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token operator">::</span><span class="token function">println</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// for å¾ªç¯è¾“å‡ºç»“æœ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šé¢è¿™æ®µç¤ºä¾‹ä»£ç ï¼Œæˆ‘ä»¬å…ˆåˆ©ç”¨ Java8 çš„ Stream æµæ¥å¤„ç† <code>invokeAll()</code> æ–¹æ³•è¿”å›çš„ <code>future</code> é›†åˆï¼Œå–å‡ºæ¯ä¸ª <code>future</code> çš„è¿”å›å€¼å°†å…¶æ˜ å°„åˆ°ä¸€ä¸ª <code>List&lt;String&gt;</code> é›†åˆä¸­ï¼Œæœ€åå¾ªç¯è¾“å‡ºç»“æœã€‚</p><h2 id="invokeAny"><a href="#invokeAny" class="headerlink" title="invokeAny"></a>invokeAny</h2><p>æ‰¹é‡æäº¤çš„å¦å¤–ä¸€ç§æ–¹å¼æ˜¯ <code>invokeAny()</code> , åŒæ ·æ˜¯æ‰¹é‡æäº¤ï¼Œå®ƒä¸ <code>invokeAll()</code> ä¸åŒç‚¹åœ¨äºï¼šå®ƒä¼šé˜»å¡ç­‰å¾…ï¼Œå½“æŸä¸ª <code>callable</code> ç¬¬ä¸€ä¸ªæ‰§è¡Œå®Œæˆï¼Œå®ƒä¼šç«‹åˆ»è¿”å›æ‰§è¡Œç»“æœï¼Œè€Œä¸å†ç­‰å¾…é‚£äº›æ­£åœ¨æ‰§è¡Œä¸­çš„ <code>callable</code> äº†ã€‚</p><p>ä¸ºäº†æµ‹è¯•ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨æ¥æ¨¡æ‹Ÿåˆ›å»ºæ‹¥æœ‰ä¸åŒæ‰§è¡Œæ—¶é—´çš„ <code>callable</code>ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token function">callable</span><span class="token punctuation">(</span><span class="token class-name">String</span> result<span class="token punctuation">,</span> <span class="token keyword">long</span> sleepSeconds<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>        <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>sleepSeconds<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> result<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ç»„ <code>callable</code>, ä»–ä»¬æ‹¥æœ‰ä¸åŒçš„æ‰§è¡Œæ—¶é—´ï¼Œ1s åˆ° 3s çš„ï¼Œé€šè¿‡<code>invokeAny()</code>å°†è¿™äº› callable æäº¤ç»™<code>executor</code>ï¼Œçœ‹çœ‹è¿”å›æœ€å¿«çš„ <code>callable</code> çš„å­—ç¬¦ä¸²ç»“æœæ˜¯å“ªä¸ªï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ExecutorService</span> executor <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newWorkStealingPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Callable</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span><span class="token punctuation">></span></span> callables <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token function">callable</span><span class="token punctuation">(</span><span class="token string">"task1"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">callable</span><span class="token punctuation">(</span><span class="token string">"task2"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">callable</span><span class="token punctuation">(</span><span class="token string">"task3"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> result <span class="token operator">=</span> executor<span class="token punctuation">.</span><span class="token function">invokeAny</span><span class="token punctuation">(</span>callables<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// => task2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€å¿«çš„æ˜¯ task2, å®ƒçš„æ‰§è¡Œæ—¶é—´æœ€çŸ­ï¼Œæ‰€ä»¥è¾“å‡ºæ˜¯å®ƒã€‚</p><p>ä¸Šé¢è¿™æ®µç¤ºä¾‹ä»£ç ä¸­ï¼Œåˆ›å»º <code>ExecutorService</code> çš„æ–¹å¼åˆå˜äº†ï¼Œé€šè¿‡ <code>Executors.newWorkStealingPool()</code>ã€‚è¿™ä¸ªå·¥å‚æ–¹æ³•æ˜¯ Java8 æ‰å¼•å…¥çš„ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ª <code>ForkJoinPool</code>ç±»å‹çš„ <code>executor</code>ï¼Œå®ƒå’ŒæŒ‡å®šå›ºå®šå¤§å°çš„çº¿ç¨‹æ± ä¸åŒï¼Œ<code>ForkJoinPools</code> å…è®¸æŒ‡å®šä¸€ä¸ªå¹¶è¡Œå› å­æ¥åˆ›å»ºï¼Œé»˜è®¤çš„å€¼ä¸ºç‰©ç†æœºå¯ç”¨çš„ CPU æ ¸å¿ƒæ•°ã€‚</p><p><code>ForkJoinPools</code> æ˜¯åœ¨ Java7 ä¸­æ‰è¢«å¼•å…¥çš„ï¼Œè¿™å°†ä¼šåœ¨åé¢ç³»åˆ—çš„æ•™ç¨‹ä¸­åšè¯¦ç»†ä»‹ç»ã€‚æ•¬è¯·æœŸå¾…ã€‚</p><h2 id="ä»»åŠ¡è°ƒåº¦-ScheduledExecutor"><a href="#ä»»åŠ¡è°ƒåº¦-ScheduledExecutor" class="headerlink" title="ä»»åŠ¡è°ƒåº¦ ScheduledExecutor"></a>ä»»åŠ¡è°ƒåº¦ ScheduledExecutor</h2><p>ä¸Šé¢æˆ‘ä»¬å·²ç»å­¦ä¹ äº†å¦‚ä½•åœ¨ä¸€ä¸ª <code>executor</code> ä¸­æäº¤å’Œè¿è¡Œä¸€æ¬¡ä»»åŠ¡ã€‚è¿˜æœ‰ä¸­åœºæ™¯æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦å¤šæ¬¡è¿è¡Œä¸€ä¸ªå¸¸è§çš„ä»»åŠ¡ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è°ƒåº¦çº¿ç¨‹æ± ã€‚</p><p><code>ScheduledExecutorService</code>æ”¯æŒä»»åŠ¡è°ƒåº¦ï¼ŒæŒç»­æ‰§è¡Œæˆ–è€…å»¶è¿Ÿä¸€æ®µæ—¶é—´åå†æ‰§è¡Œã€‚</p><p>ä¸‹é¢çš„ä»£ç ç¤ºä¾‹ï¼ŒæŒ‡å®šä¸€ä¸ªä»»åŠ¡å»¶è¿Ÿ 3 åˆ†é’Ÿå†æ‰§è¡Œï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ScheduledExecutorService</span> executor <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newScheduledThreadPool</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Runnable</span> task <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Scheduling: "</span> <span class="token operator">+</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">ScheduledFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> future <span class="token operator">=</span> executor<span class="token punctuation">.</span><span class="token function">schedule</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1337</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">long</span> remainingDelay <span class="token operator">=</span> future<span class="token punctuation">.</span><span class="token function">getDelay</span><span class="token punctuation">(</span><span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Remaining Delay: %sms"</span><span class="token punctuation">,</span> remainingDelay<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>ScheduledExecutorService</code> ä¼šè¿”å›ä¸€ä¸ªå¢å¼ºç±»å‹çš„ <code>future</code> ç±»å‹ â€”â€” <code>ScheduleFuture</code>ï¼Œå®ƒé™¤äº†ä¿æœ‰åŸæœ‰ <code>Future</code> æä¾›çš„æ‰€æœ‰æ–¹æ³•å¤–ï¼Œè¿˜æä¾›äº† <code>getDelay()</code> æ–¹æ³•, ç”¨æ¥è·å–è·ç¦»ç›®æ ‡æ—¶é—´çš„æ—¶é—´å·®ï¼Œä¹Ÿå°±æ˜¯å‰©ä½™çš„å»¶è¿Ÿæ—¶é—´ã€‚</p><p>ä¸ºäº†ä¿è¯è°ƒåº¦ä»»åŠ¡çš„æŒç»­æ‰§è¡Œï¼Œ<code>executors</code> æä¾›äº†ä¸¤ä¸ª API:</p><ul><li>1.<code>scheduleAtFixedRate()</code> ï¼š<strong>å›ºå®šå‘¨æœŸæ‰§è¡Œä¸€ä¸ªä»»åŠ¡, ä¸è€ƒè™‘ä»»åŠ¡çš„è€—æ—¶ï¼Œå³ä½¿ä¸Šä¸ªä»»åŠ¡è¿˜æ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œåˆ°äº†æ—¶é—´ï¼Œä¸‹ä¸ªä»»åŠ¡ä¾ç„¶ä¼šå»æ‰§è¡Œ</strong>;</li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ScheduledExecutorService</span> executor <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newScheduledThreadPool</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Runnable</span> task <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Scheduling: "</span> <span class="token operator">+</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ç¬¬ä¸€æ¬¡æ‰§è¡Œçš„å»¶è¿Ÿæ—¶é—´</span><span class="token keyword">int</span> initialDelay <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token comment">// å‘¨æœŸé¢‘ç‡</span><span class="token keyword">int</span> period <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment">// æŒ‡å®šä»»åŠ¡ç«‹åˆ»æ‰§è¡Œï¼Œä¸”æ¯æ¬¡ä¹‹é—´é—´éš”ä¸º 1s</span>executor<span class="token punctuation">.</span><span class="token function">scheduleAtFixedRate</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> initialDelay<span class="token punctuation">,</span> period<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ³¨æ„ï¼š<code>initialDelay</code> è¡¨ç¤ºç¬¬ä¸€æ¬¡æ‰§è¡Œçš„å»¶è¿Ÿæ—¶é—´ï¼Œ0 è¡¨ç¤ºç«‹å³æ‰§è¡Œ</p></blockquote><ul><li>2.<code>scheduleWithFixedDelay()</code> ï¼š<strong>å›ºå®šå»¶è¿Ÿæ‰§è¡Œä»»åŠ¡ï¼Œå°±æ˜¯è¯´ï¼Œå¿…é¡»è¦ç­‰åˆ°ä¸Šä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆåæ‰å¼€å§‹è®¡æ—¶ï¼Œè¾¾åˆ°è®¾å®šçš„å»¶è¿Ÿæ—¶é—´åï¼Œä¸‹ä¸ªä»»åŠ¡æ‰ä¼šè¢«è§¦å‘</strong>ï¼›</li></ul><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">ScheduledExecutorService</span> executor <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newScheduledThreadPool</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Runnable</span> task <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token punctuation">&#123;</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Scheduling: "</span> <span class="token operator">+</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"task interrupted"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>executor<span class="token punctuation">.</span><span class="token function">scheduleWithFixedDelay</span><span class="token punctuation">(</span>task<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ€»ç»“ä¸€ä¸‹ï¼š<code>scheduleWithFixedDelay()</code> å’Œ <code>scheduleAtFixedRate()</code> æœ€å¤§çš„åŒºåˆ«å°±æ˜¯ï¼Œ<code>scheduleWithFixedDelay()</code>éœ€è¦ç­‰åˆ°å‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆåæ‰å¼€å§‹è®¡å»¶æ—¶ï¼Œå†è§¦å‘ä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚</p></blockquote><p>å¦‚ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ä¸­è¿™ä¸ªè°ƒåº¦ä»»åŠ¡ï¼Œè®¾ç½®äº† 1s çš„å»¶æ—¶ï¼Œåˆå§‹åŒ–å»¶æ—¶ä¸º 0ï¼Œå‡è®¾ç†æƒ³æƒ…å†µä¸‹ä»»åŠ¡çš„è€—æ—¶å°±æ˜¯ 2s, åˆ™ä»»åŠ¡çš„è°ƒåº¦å‘¨æœŸä¸ºï¼š <code>0s -&gt; 3s -&gt; 6s -&gt; 9s ....</code>, å®ƒæ›´é€‚ç”¨äºå½“ä½ æ— æ³•é¢„æµ‹ä»»åŠ¡çš„æ‰§è¡Œæ—¶é•¿çš„åœºæ™¯ä¸­ä½¿ç”¨ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ç¯‡æ–‡ç« ä¸»è¦æ¢è®¨äº†å¦‚ä½•åœ¨ç”¨ <code>lambda</code> è¡¨è¾¾å¼ï¼Œåœ¨ Java8 ä¸­ä½¿ç”¨çº¿ç¨‹å’Œæ‰§è¡Œå™¨ï¼Œå¹¶æ¼”ç¤ºäº†ç›¸å…³ç¤ºä¾‹ä»£ç ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å­¦ä¹ äº† <code>Callable</code> å’Œ <code>Future</code>, è¶…æ—¶è®¾ç½®ï¼Œä»»åŠ¡çš„æ‰¹é‡æäº¤ <code>invokeAll()</code> å’Œ <code>invokeAny()</code> APIã€‚æœ€å, äº†è§£äº†å¦‚ä½•åœ¨ Java8 ä¸­ä½¿ç”¨ä»»åŠ¡è°ƒåº¦ <code>ScheduledExecutor</code>ï¼Œå¸Œæœ›ä½ èƒ½æœ‰æ‰€æ”¶è·ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> jdk8 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> jdk8 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç„å‰‘ä¸­å°</title>
      <link href="/platform.github.io/2022/09/19/index/"/>
      <url>/platform.github.io/2022/09/19/index/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¶æ„å›¾"><a href="#æ¶æ„å›¾" class="headerlink" title="æ¶æ„å›¾"></a>æ¶æ„å›¾</h2><p><img src="/platform.github.io/medias/pic/jgt.JPG" alt="æ¶æ„å›¾"></p><h2 id="éƒ¨ç½²å›¾"><a href="#éƒ¨ç½²å›¾" class="headerlink" title="éƒ¨ç½²å›¾"></a>éƒ¨ç½²å›¾</h2><p><img src="/platform.github.io/medias/pic/%E9%83%A8%E7%BD%B2%E5%9B%BE.png" alt="éƒ¨ç½²å›¾"></p>]]></content>
      
      
      <categories>
          
          <category> ä¸­å° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¸­å° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥ä½œæµ</title>
      <link href="/platform.github.io/2022/09/19/engine/"/>
      <url>/platform.github.io/2022/09/19/engine/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>å·¥ä½œæµåŸºäºactivityå¼€æºæ¡†æ¶åšäºŒæ¬¡å°è£…åŠŸèƒ½ï¼Œæ”¯æŒä¸­å›½ç‰¹è‰²å·¥ä½œæµï¼šæœ‰æ’¤å›ã€é©³å›ã€é©³å›å‘èµ·äººã€é©³å›ä¸Šä¸€æ­¥ã€ä»»æ„èŠ‚ç‚¹é©³å›ã€é©³å›åç›´è¾¾é©³å›èŠ‚ç‚¹ã€ä»»æ„èŠ‚ç‚¹è·³è½¬ã€ä¼šç­¾åæ ¹æ®ä¼šç­¾ç»“æœèµ°ä¸åŒå‡ºå£ã€ä¼šç­¾åŠ ç­¾ã€å‡ç­¾ç­‰ç­‰ã€‚</p><p><img src="/platform.github.io/medias/pic/%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%9B%BE.png" alt="æµç¨‹è®¾è®¡"></p>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œæµ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥ä½œæµ </tag>
            
            <tag> activity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»§æ‰¿BaseServiceé€šç”¨serviceçœç•¥ç¼–ç </title>
      <link href="/platform.github.io/2022/09/19/BaseService/"/>
      <url>/platform.github.io/2022/09/19/BaseService/</url>
      
        <content type="html"><![CDATA[<h3 id="åŸºç¡€BaseServiceä½œç”¨"><a href="#åŸºç¡€BaseServiceä½œç”¨" class="headerlink" title="åŸºç¡€BaseServiceä½œç”¨"></a>åŸºç¡€BaseServiceä½œç”¨</h3><p>Serviceæ¥å£ç±»ç»§æ‰¿BaseServiceæ¥å£ï¼Œå¯é»˜è®¤å®ç°åˆ†é¡µåˆ—è¡¨ã€ä¿å­˜ã€æ›´æ–°ã€åˆ é™¤ã€è¯¦æƒ…ç­‰æ¥å£ï¼Œæ”¯æŒè‡ªå®šä¹‰é‡å†™ï¼›controllerç›´æ¥è°ƒç”¨å³å¯</p><h3 id="ä»£ç ç¤ºä¾‹"><a href="#ä»£ç ç¤ºä¾‹" class="headerlink" title="ä»£ç ç¤ºä¾‹"></a>ä»£ç ç¤ºä¾‹</h3><h4 id="entityç±»éœ€è¦ç»§æ‰¿BaseEntityï¼š"><a href="#entityç±»éœ€è¦ç»§æ‰¿BaseEntityï¼š" class="headerlink" title="entityç±»éœ€è¦ç»§æ‰¿BaseEntityï¼š"></a>entityç±»éœ€è¦ç»§æ‰¿BaseEntityï¼š</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span>keepGlobalPrefix <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> value <span class="token operator">=</span> <span class="token string">"sys_report_data_source"</span><span class="token punctuation">)</span><span class="token annotation punctuation">@Data</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataSource</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="serviceæ¥å£ç±»ç»§æ‰¿BaseService"><a href="#serviceæ¥å£ç±»ç»§æ‰¿BaseService" class="headerlink" title="serviceæ¥å£ç±»ç»§æ‰¿BaseService"></a>serviceæ¥å£ç±»ç»§æ‰¿BaseService<T></h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DataSourceService</span> <span class="token keyword">extends</span> <span class="token class-name">BaseService</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DataSource</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>    <span class="token annotation punctuation">@Autowired</span>    <span class="token keyword">private</span> <span class="token class-name">DataSourceMapper</span> dataSourceMapper<span class="token punctuation">;</span>        <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">BaseMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DataSource</span><span class="token punctuation">></span></span> <span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> dataSourceMapper<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="BaseServiceç±»æ¥å£å†…å®¹ï¼š"><a href="#BaseServiceç±»æ¥å£å†…å®¹ï¼š" class="headerlink" title="BaseServiceç±»æ¥å£å†…å®¹ï¼š"></a>BaseServiceç±»æ¥å£å†…å®¹ï¼š</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BaseService</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>    <span class="token comment">/**     * éœ€è¦å®ç°ï¼Œå®šä¹‰Mapper     *     * @return     */</span>    <span class="token class-name">BaseMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">/**     * åˆ†é¡µæŸ¥è¯¢     *     * @param pagination åˆ†é¡µå¯¹è±¡     * @param wrapper    æ¡ä»¶,æ’åºè‡ªå®šä¹‰     * @return     */</span>    <span class="token keyword">default</span> <span class="token class-name">Pagination</span> <span class="token function">pageList</span><span class="token punctuation">(</span><span class="token class-name">Pagination</span> pagination<span class="token punctuation">,</span> <span class="token class-name">Wrapper</span> wrapper<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Page</span> prepare <span class="token operator">=</span> pagination<span class="token punctuation">.</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">List</span> list <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>        pagination<span class="token punctuation">.</span><span class="token function">setList</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> prepare<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> pagination<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * æŸ¥è¯¢åˆ—è¡¨æ•°æ®ä¸åˆ†é¡µ     *     * @param wrapper æ¡ä»¶,æ’åºè‡ªå®šä¹‰     * @return     */</span>    <span class="token keyword">default</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token class-name">List</span><span class="token punctuation">(</span><span class="token class-name">Wrapper</span> wrapper<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">List</span> list <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">selectList</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> list<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * ä¿å­˜     *     * @param entity     * @return     */</span>    <span class="token annotation punctuation">@Transactional</span>    <span class="token keyword">default</span> <span class="token keyword">int</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">T</span> entity<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>entity<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * æ›´æ–°     *     * @param entity     * @return     */</span>    <span class="token annotation punctuation">@Transactional</span>    <span class="token keyword">default</span> <span class="token keyword">int</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">T</span> entity<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>entity<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * è¯¦æƒ… é€šè¿‡ä¸»é”®æŸ¥è¯¢ä¸€æ¡è®°å½•     *     * @param id     * @return     */</span>    <span class="token keyword">default</span> <span class="token class-name">T</span> <span class="token function">detail</span><span class="token punctuation">(</span><span class="token class-name">Serializable</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">selectById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * é€šè¿‡æ¡ä»¶æŸ¥è¯¢ä¸€æ¡è®°å½•     *     * @param wrapper     * @return     */</span>    <span class="token keyword">default</span> <span class="token class-name">T</span> <span class="token function">selectOne</span><span class="token punctuation">(</span><span class="token class-name">Wrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> wrapper<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">selectOne</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * åˆ é™¤     *     * @param id ä¸»é”®     * @return     */</span>    <span class="token annotation punctuation">@Transactional</span>    <span class="token keyword">default</span> <span class="token keyword">int</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">Serializable</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">deleteById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token comment">/**     * æ‰¹é‡åˆ é™¤     *     * @param ids éœ€è¦åˆ é™¤çš„ç¼–å·é›†åˆ     * @return     */</span>    <span class="token annotation punctuation">@Transactional</span>    <span class="token keyword">default</span> <span class="token keyword">int</span> <span class="token function">deleteBatch</span><span class="token punctuation">(</span><span class="token class-name">List</span> ids<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">deleteBatchIds</span><span class="token punctuation">(</span>ids<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://pic.rmb.bdstatic.com/c51a5f2f5c1adfaabe43cdf4a4ef68e8.png" alt="ä½›ç¥–ä¿ä½‘  æ°¸æ— BUG"></p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç  </category>
          
          <category> å‡å°‘incode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¼–ç  </tag>
            
            <tag> è§„èŒƒ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
